{
    "pattern": "CREATE TABLE NATION ( N_NATIONKEY INTEGER <constraint_type_parameter>, N_NAME CHAR(25) <constraint_type_parameter>, N_REGIONKEY INTEGER <constraint_type_parameter>, N_COMMENT VARCHAR(152), <constraint_enforce_replace> (N_NATIONKEY)); CREATE TABLE REGION ( R_REGIONKEY INTEGER <constraint_type_parameter>, R_NAME CHAR(25) <constraint_type_parameter>, R_COMMENT VARCHAR(152), <constraint_enforce_replace> (R_REGIONKEY)); CREATE TABLE PART ( P_PARTKEY INTEGER <constraint_type_parameter>, P_NAME VARCHAR(55) <constraint_type_parameter>, P_MFGR CHAR(25) <constraint_type_parameter>, P_BRAND CHAR(10) <constraint_type_parameter>, P_TYPE VARCHAR(25) <constraint_type_parameter>, P_SIZE INTEGER <constraint_type_parameter>, P_CONTAINER CHAR(10) <constraint_type_parameter>, P_RETAILPRICE DECIMAL(15,2) <constraint_type_parameter>, P_COMMENT VARCHAR(23) <constraint_type_parameter>, <constraint_enforce_replace> (P_PARTKEY)); CREATE TABLE SUPPLIER ( S_SUPPKEY INTEGER <constraint_type_parameter>, S_NAME CHAR(25) <constraint_type_parameter>, S_ADDRESS VARCHAR(40) <constraint_type_parameter>, S_NATIONKEY INTEGER <constraint_type_parameter>, S_PHONE CHAR(15) <constraint_type_parameter>, S_ACCTBAL DECIMAL(15,2) <constraint_type_parameter>, S_COMMENT VARCHAR(101) <constraint_type_parameter>, <constraint_enforce_replace> (S_SUPPKEY)); CREATE TABLE PARTSUPP ( PS_PARTKEY INTEGER <constraint_type_parameter>, PS_SUPPKEY INTEGER <constraint_type_parameter>, PS_AVAILQTY INTEGER <constraint_type_parameter>, PS_SUPPLYCOST DECIMAL(15,2) <constraint_type_parameter>, PS_COMMENT VARCHAR(199) <constraint_type_parameter>, <constraint_enforce_replace> (PS_PARTKEY, PS_SUPPKEY)); CREATE TABLE CUSTOMER ( C_CUSTKEY INTEGER <constraint_type_parameter>, C_NAME VARCHAR(25) <constraint_type_parameter>, C_ADDRESS VARCHAR(40) <constraint_type_parameter>, C_NATIONKEY INTEGER <constraint_type_parameter>, C_PHONE CHAR(15) <constraint_type_parameter>, C_ACCTBAL DECIMAL(15,2) <constraint_type_parameter>, C_MKTSEGMENT CHAR(10) <constraint_type_parameter>, C_COMMENT VARCHAR(117) <constraint_type_parameter>, <constraint_enforce_replace> (C_CUSTKEY)); CREATE TABLE ORDERS ( O_ORDERKEY INTEGER <constraint_type_parameter>, O_CUSTKEY INTEGER <constraint_type_parameter>, O_ORDERSTATUS CHAR(1) <constraint_type_parameter>, O_TOTALPRICE DECIMAL(15,2) <constraint_type_parameter>, O_ORDERDATE DATE <constraint_type_parameter>, O_ORDERPRIORITY CHAR(15) <constraint_type_parameter>, O_CLERK CHAR(15) <constraint_type_parameter>, O_SHIPPRIORITY INTEGER <constraint_type_parameter>, O_COMMENT VARCHAR(79) <constraint_type_parameter>, <constraint_enforce_replace> (O_ORDERKEY)); CREATE TABLE LINEITEM ( L_ORDERKEY INTEGER <constraint_type_parameter>, L_PARTKEY INTEGER <constraint_type_parameter>, L_SUPPKEY INTEGER <constraint_type_parameter>, L_LINENUMBER INTEGER <constraint_type_parameter>, L_QUANTITY DECIMAL(15,2) <constraint_type_parameter>, L_EXTENDEDPRICE DECIMAL(15,2) <constraint_type_parameter>, L_DISCOUNT DECIMAL(15,2) <constraint_type_parameter>, L_TAX DECIMAL(15,2) <constraint_type_parameter>, L_RETURNFLAG CHAR(1) <constraint_type_parameter>, L_LINESTATUS CHAR(1) <constraint_type_parameter>, L_SHIPDATE DATE <constraint_type_parameter>, L_COMMITDATE DATE <constraint_type_parameter>, L_RECEIPTDATE DATE <constraint_type_parameter>, L_SHIPINSTRUCT CHAR(25) <constraint_type_parameter>, L_SHIPMODE CHAR(10) <constraint_type_parameter>, L_COMMENT VARCHAR(44) <constraint_type_parameter>, <constraint_enforce_replace> (L_ORDERKEY, L_LINENUMBER)); EXPLAIN FORMAT=tree SELECT o_year, SUM(CASE <case_parameter> WHEN nation = 'BRAZIL' THEN volume ELSE 0 END) / SUM(volume) AS mkt_share FROM ( SELECT /*+ join_prefix(part, lineitem, orders, supplier, customer, n1, region, n2) */ EXTRACT(YEAR FROM o_orderdate) AS o_year, l_extendedprice * (1 - l_discount) AS volume, n2.n_name AS nation FROM part, supplier, lineitem, orders, customer, nation n1, nation n2, region WHERE p_partkey = l_partkey AND s_suppkey = l_suppkey AND l_orderkey = o_orderkey AND o_custkey = c_custkey AND c_nationkey = n1.n_nationkey AND n1.n_regionkey = r_regionkey AND r_name = 'AMERICA' AND s_nationkey = n2.n_nationkey AND o_orderdate <between_parameter> AND p_type = 'ECONOMY ANODIZED STEEL' ) all_nations GROUP BY o_year ORDER BY o_year;",
    "applied_rules": [
        "<constraint_type_parameter>",
        "<constraint_enforce_replace>",
        "<case_parameter>",
        "<between_parameter>"
    ],
    "Affected Elements": "JOIN hints, JOIN order specification",
    "Root Cause Analysis": "The optimizer does not respect the specified join order hints due to a limitation or bug in the optimizer's implementation."
}