{
    "pattern": "CREATE TABLE t0 (vkey UInt32 <constraint_type_parameter>) ENGINE = MergeTree; CREATE VIEW t3 AS SELECT DISTINCT ref_0.vkey AS c_2_c16_0 FROM t0 AS ref_0; INSERT INTO t0 VALUES (<dml_values_parameter>); WITH cte_4 AS (SELECT RANK() OVER w0 AS c_2_c2398_0 FROM t3 AS ref_15 WINDOW w0 AS (PARTITION BY ref_15.c_2_c16_0 ORDER BY ref_15.c_2_c16_0 <arithmetic_operator_replace>)) SELECT DISTINCT ref_39.c_2_c2398_0 AS c_9_c2479_0 FROM cte_4 AS ref_39;",
    "applied_rules": [
        "<constraint_type_parameter>",
        "<dml_values_parameter>",
        "<arithmetic_operator_replace>"
    ],
    "Affected Elements": "rank() OVER, window clause",
    "Root Cause Analysis": "The query fails because the column generated by the rank() function is not recognized in the ActionsDAG due to changes in the SQL engine's handling of window functions in version 23."
}