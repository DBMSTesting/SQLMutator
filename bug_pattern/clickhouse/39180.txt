{
    "pattern": "CREATE TABLE alps_test_local_v1 (cid <numeric_type_parameter>, useragent <string_type_parameter>, useragent_hash <numeric_type_parameter> DEFAULT <function_parameter>(lower(useragent)), ua_group_id <numeric_type_parameter>, url <string_type_parameter>, urlhash <numeric_type_parameter> DEFAULT <function_parameter>(lower(url)), ip_address <string_type_parameter>, date <date_type_parameter>, timestamp <datetime_type_parameter>, response_code <numeric_type_parameter>, versioning <numeric_type_parameter> DEFAULT <cast_parameter>, url_murmur_hash <numeric_type_parameter> DEFAULT <function_parameter>(url), INDEX urlhash_bloomfilter urlhash TYPE <index_type_parameter> GRANULARITY <numeric_type_parameter>, PROJECTION pro_agg_1 (SELECT <function_parameter>(any(url)) AS decodeUrl, <aggregation_function_parameter>(date) AS lastCrawlDate, <aggregation_function_parameter>(urlhash) AS total_urls, <aggregation_function_parameter>(uniqHLL12(urlhash)) AS unique_urls, <aggregation_function_parameter>(uniqHLL12(date)) AS total_days, <aggregation_function_parameter>(uniqHLL12(useragent_hash)) AS agentUniqCount, <aggregation_function_parameter>(uniqHLL12(cityHash64(ip_address))) AS ipUniqCount, <aggregation_function_parameter>(sum(multiIf((response_code <comparison_operator_parameter> 0) <logical_operator_replace> (response_code <comparison_operator_parameter> 100), 1, 0)) AS count0xx, <aggregation_function_parameter>(sum(multiIf((response_code <comparison_operator_parameter> 200) <logical_operator_replace> (response_code <comparison_operator_parameter> 300), 1, 0)) AS count2xx, <aggregation_function_parameter>(sum(multiIf((response_code <comparison_operator_parameter> 300) <logical_operator_replace> (response_code <comparison_operator_parameter> 400), 1, 0)) AS count3xx, <aggregation_function_parameter>(sum(multiIf((response_code <comparison_operator_parameter> 400) <logical_operator_replace> (response_code <comparison_operator_parameter> 500), 1, 0)) AS count4xx, <aggregation_function_parameter>(sum(multiIf((response_code <comparison_operator_parameter> 500) <logical_operator_replace> (response_code <comparison_operator_parameter> 600), 1, 0)) AS count5xx, any(useragent) AS useragentName, useragent_hash, ua_group_id, response_code, urlhash GROUP BY date, cid, versioning, ua_group_id, useragent_hash, response_code, urlhash)) ENGINE = <engine_type_parameter> PARTITION BY <function_parameter>(date) ORDER BY (cid, ua_group_id, date, versioning) SETTINGS index_granularity = <numeric_type_parameter>; INSERT INTO alps_test_local_v1(urlhash, date, cid, timestamp) VALUES (<numeric_value_parameter>, <date_value_parameter>, <numeric_value_parameter>, <datetime_value_parameter>), (<numeric_value_parameter>, <date_value_parameter>, <numeric_value_parameter>, <datetime_value_parameter>); SELECT urlhash, <aggregation_function_parameter>(date) FROM alps_test_local_v1 WHERE (cid <comparison_operator_parameter> <numeric_value_parameter>) <logical_operator_replace> (urlhash <comparison_operator_parameter> <numeric_value_parameter>) <logical_operator_replace> (versioning <comparison_operator_parameter> <numeric_value_parameter>) <logical_operator_replace> (date <comparison_operator_parameter> <date_value_parameter>) GROUP BY urlhash;",
    "applied_rules": [
        "<numeric_type_parameter>",
        "<string_type_parameter>",
        "<function_parameter>",
        "<date_type_parameter>",
        "<datetime_type_parameter>",
        "<cast_parameter>",
        "<index_type_parameter>",
        "<aggregation_function_parameter>",
        "<comparison_operator_parameter>",
        "<logical_operator_replace>",
        "<engine_type_parameter>",
        "<numeric_value_parameter>",
        "<date_value_parameter>"
    ],
    "Affected Elements": "MAX(date) function",
    "Root Cause Analysis": "The MAX function is returning incorrect maximum dates due to potential issues with data storage or query execution within the projection."
}