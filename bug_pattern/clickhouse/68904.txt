{
    "pattern": "CREATE TABLE mydb.rawtable (Id UInt64 <constraint_type_parameter>, Attributes Map(LowCardinality(String), String) <constraint_type_parameter>, MetricName LowCardinality(String) <constraint_type_parameter>, TimeUnix DateTime <constraint_type_parameter>) ENGINE = MergeTree PARTITION BY toYYYYMMDD(TimeUnix) ORDER BY (MetricName, Attributes, toUnixTimestamp(TimeUnix)); CREATE MATERIALIZED VIEW mydb.raw_to_attributes_mv TO mydb.attributes (Id UInt64 <constraint_type_parameter>, MetricName LowCardinality(String), TimeUnix DateTime, AttributeKeys Array(LowCardinality(String)), AttributeValues Array(String)) AS SELECT Id, MetricName, toStartOfDay(TimeUnix) AS TimeUnix, mapKeys(Attributes) AS AttributeKeys, mapValues(Attributes) AS AttributeValues FROM mydb.rawtable; CREATE TABLE mydb.attributes (Id UInt64 <constraint_type_parameter>, MetricName LowCardinality(String) <constraint_type_parameter>, TimeUnix DateTime <constraint_type_parameter>, AttributeKeys Array(LowCardinality(String)) <constraint_type_parameter>, AttributeValues Array(String) <constraint_type_parameter>) ENGINE = ReplacingMergeTree PARTITION BY toYYYYMMDD(TimeUnix) ORDER BY (MetricName, Id, TimeUnix); INSERT INTO mydb.rawtable <dml_values_parameter>",
    "applied_rules": [
        "<constraint_type_parameter>",
        "<dml_values_parameter>"
    ],
    "Affected Elements": "mapKeys(Attributes), mapValues(Attributes)",
    "Root Cause Analysis": "The error is triggered due to the materialized view not being able to find the computed keys from the Attributes map column during the insert operation, indicating a compatibility issue with the latest ClickHouse version."
}