{
    "pattern": "SELECT <numeric_function_parameter> AS area_code, <numeric_function_parameter> AS area_category_id, <string_function_parameter> AS area_name, <numeric_function_parameter> AS class_code, <numeric_function_parameter> AS class_category_id, <string_function_parameter> AS class_name, sum(IF(class_line_id <comparison_operator_parameter> 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = <numeric_parameter> AND c_t <= <numeric_parameter> AND order_status <comparison_operator_parameter> 0 AND promotion_type NOT IN (<numeric_parameter>, <numeric_parameter>, <numeric_parameter>) AND IF(sale_type IS NULL, <numeric_parameter>, sale_type) = <numeric_parameter> AND city_flag = <numeric_parameter>) oi JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id <join_operator_replace> (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = <numeric_parameter>) cus ON sku.class2_id = cus.class_l2_id UNION ALL SELECT sa.big_area_id AS area_code, <numeric_function_parameter> AS area_category_id, sa.big_area_name AS area_name, <numeric_function_parameter> AS class_code, <numeric_function_parameter> AS class_category_id, <string_function_parameter> AS class_name, sum(IF(class_line_id <comparison_operator_parameter> 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = <numeric_parameter> AND c_t <= <numeric_parameter> AND order_status <comparison_operator_parameter> 0 AND promotion_type NOT IN (<numeric_parameter>, <numeric_parameter>, <numeric_parameter>) AND IF(sale_type IS NULL, <numeric_parameter>, sale_type) = <numeric_parameter> AND city_flag = <numeric_parameter>) oi JOIN (SELECT sale_area_id, big_area_id, big_area_name FROM etl_membi_dim_city_manage_type final) sa ON sa.sale_area_id = oi.sale_area_id JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id <join_operator_replace> (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = <numeric_parameter>) cus ON sku.class2_id = cus.class_l2_id GROUP BY area_code, area_name UNION ALL SELECT sa.zhucheng_id AS area_code, <numeric_function_parameter> AS area_category_id, sa.zhucheng_name AS area_name, <numeric_function_parameter> AS class_code, <numeric_function_parameter> AS class_category_id, <string_function_parameter> AS class_name, sum(IF(class_line_id <comparison_operator_parameter> 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = <numeric_parameter> AND c_t <= <numeric_parameter> AND order_status <comparison_operator_parameter> 0 AND promotion_type NOT IN (<numeric_parameter>, <numeric_parameter>, <numeric_parameter>) AND IF(sale_type IS NULL, <numeric_parameter>, sale_type) = <numeric_parameter> AND city_flag = <numeric_parameter>) oi JOIN (SELECT sale_area_id, zhucheng_id, zhucheng_name FROM etl_membi_dim_city_manage_type final) sa ON sa.sale_area_id = oi.sale_area_id JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id <join_operator_replace> (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = <numeric_parameter>) cus ON sku.class2_id = cus.class_l2_id GROUP BY area_code, area_name FORMAT TabSeparatedWithNamesAndTypes;",
    "applied_rules": [
        "<numeric_function_parameter>",
        "<string_function_parameter>",
        "<comparison_operator_parameter>",
        "<numeric_parameter>",
        "<join_operator_replace>"
    ],
    "Affected Elements": "UNION ALL, GROUP BY, JOIN",
    "Root Cause Analysis": "The crash is likely due to memory issues triggered by executing complex UNION ALL queries, possibly exacerbated by parallel execution."
}