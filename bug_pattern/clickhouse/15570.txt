{
    "pattern": "SELECT <aggregation_function_parameter> AS step_0, <aggregation_function_parameter> AS step_1, <aggregation_function_parameter> AS step_2, <aggregation_function_parameter> AS avgTimeToStep1, <aggregation_function_parameter> AS medianTimeToStep1, <aggregation_function_parameter> AS avgTimeToStep2, <aggregation_function_parameter> AS medianTimeToStep2, <aggregation_function_parameter> AS medianRepetitionOnStep0, <aggregation_function_parameter> AS avgRepetitionOnStep0, <aggregation_function_parameter> AS medianRepetitionOnStep1, <aggregation_function_parameter> AS avgRepetitionOnStep1, <aggregation_function_parameter> AS medianRepetitionOnStep2, <aggregation_function_parameter> AS avgRepetitionOnStep2, <aggregation_function_parameter> AS totalTimeAvg, <aggregation_function_parameter> AS quantileCountStep0, <aggregation_function_parameter> AS quantileCountStep1, <aggregation_function_parameter> AS quantileCountStep2, <aggregation_function_parameter> AS quantileTimeStep1, <aggregation_function_parameter> AS quantileTimeStep2, <aggregation_function_parameter> AS quantileTotalTime, <aggregation_function_parameter> AS medianTotalTime FROM ( SELECT deviceId, <function_category_parameter> AS step0_time_arr, step0_time_arr[1] AS step0_time, <function_category_parameter> AS step1_time_arr, step1_time_arr[1] AS step1_time, <function_category_parameter> AS step2_time_arr, step2_time_arr[1] AS step2_time, step2_time - step0_time AS totalTimeDifference, <function_category_parameter> AS timeToStep1, <function_category_parameter> AS timeToStep2, length(step0_time_arr) AS count_on_step0, length(step1_time_arr) AS count_on_step1, length(step2_time_arr) AS count_on_step2 FROM ( SELECT deviceId, eventTime, eventName FROM db.tbl WHERE ((eventName = 'event1') <logical_operator_replace> (eventName = 'event2') <logical_operator_replace> (eventName = 'event3')) AND ((eventTime <comparison_operator_replace> 1599091200) <logical_operator_replace> (eventTime <comparison_operator_replace> 1601701473)) ORDER BY eventTime ASC ) GROUP BY deviceId )",
    "applied_rules": [
        "<aggregation_function_parameter>",
        "<function_category_parameter>",
        "<logical_operator_replace>",
        "<comparison_operator_replace>"
    ],
    "Affected Elements": "arrayFilter, countIf, avg, median, groupArrayIf, if",
    "Root Cause Analysis": "The logic used in arrayFilter may not correctly account for the ordering and conditions required to ensure that step2_time >= step1_time >= step0_time, resulting in negative totalTimeDifference calculations."
}