{
    "pattern": "USE <database_parameter>; DROP TABLE IF EXISTS <table_parameter>, <table_parameter>, <table_parameter>, <table_parameter>, <table_parameter>; CREATE TABLE <table_parameter> (<column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, KEY <index_parameter> (<column_parameter>), KEY <index_parameter> (<column_parameter>,<column_parameter>)) ENGINE=<engine_parameter> DEFAULT CHARSET=<charset_parameter> COLLATE=<collation_parameter>; CREATE TABLE <table_parameter> (<column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, KEY <index_parameter> (<column_parameter>,<column_parameter>)) ENGINE=<engine_parameter> DEFAULT CHARSET=<charset_parameter> COLLATE=<collation_parameter>; CREATE TABLE <table_parameter> (<column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, KEY <index_parameter> (<column_parameter>,<column_parameter>)) ENGINE=<engine_parameter> DEFAULT CHARSET=<charset_parameter> COLLATE=<collation_parameter>; CREATE TABLE <table_parameter> (<column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>) ENGINE=<engine_parameter> DEFAULT CHARSET=<charset_parameter> COLLATE=<collation_parameter>; CREATE TABLE <table_parameter> (<column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>, <column_definition_parameter>) ENGINE=<engine_parameter> DEFAULT CHARSET=<charset_parameter> COLLATE=<collation_parameter>; INSERT INTO <table_parameter> (<column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>) VALUES (<value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>); INSERT INTO <table_parameter> (<column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>) VALUES (<value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>); INSERT INTO <table_parameter> (<column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>) VALUES (<value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>); INSERT INTO <table_parameter> (<column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>) VALUES (<value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>); INSERT INTO <table_parameter> (<column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>, <column_parameter>) VALUES (<value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>); WITH <cte_parameter> AS ( SELECT d.<column_parameter> AS <column_parameter>, (SELECT MAX(<column_parameter>) FROM <table_parameter> a WHERE <column_parameter> <= CONCAT(YEAR(DATE_SUB(d.<column_parameter>, INTERVAL <number_parameter> YEAR), <number_parameter>) AND EXISTS (SELECT 1 FROM <table_parameter> d WHERE a.<column_parameter> = d.<column_parameter> AND d.<column_parameter> = <value_parameter>)) AS <column_parameter>, (SELECT MAX(<column_parameter>) FROM <table_parameter> a WHERE <column_parameter> <= CONCAT(YEAR(DATE_SUB(d.<column_parameter>, INTERVAL <number_parameter> YEAR), <number_parameter>) AND EXISTS (SELECT 1 FROM <table_parameter> d WHERE a.<column_parameter> = d.<column_parameter> AND d.<column_parameter> = <value_parameter>)) AS <column_parameter>, (SELECT MAX(<column_parameter>) FROM <table_parameter> WHERE <column_parameter> <= d.<column_parameter>) AS <column_parameter>, (SELECT MAX(<column_parameter>) FROM <table_parameter> WHERE <column_parameter> <= d.<column_parameter>) AS <column_parameter> FROM <table_parameter> d WHERE d.<column_parameter> = <value_parameter>), <cte_parameter> AS ( SELECT b.<column_parameter> FROM <table_parameter> b LEFT JOIN <table_parameter> rb ON rb.<column_parameter> = b.<column_parameter> AND b.<column_parameter> = rb.<column_parameter> WHERE b.<column_parameter> = (SELECT <column_parameter> FROM <cte_parameter>) ), <cte_parameter> AS ( SELECT b.<column_parameter> FROM <table_parameter> b LEFT JOIN <table_parameter> rb ON rb.<column_parameter> = b.<column_parameter> AND b.<column_parameter> = rb.<column_parameter> ), <cte_parameter> AS ( SELECT DISTINCT t.<column_parameter>, <column_parameter>, 'ML' AS <column_parameter> FROM <table_parameter> t ), <cte_parameter> AS ( SELECT t.<column_parameter>, '3集合' AS <column_parameter> FROM <cte_parameter> t LEFT JOIN <cte_parameter> dt ON 1 = 1 LEFT JOIN <table_parameter> a ON t.<column_parameter> = a.<column_parameter> AND a.<column_parameter> = dt.<column_parameter> ) SELECT <column_parameter> FROM ( SELECT <column_parameter> FROM <cte_parameter> UNION ALL SELECT <column_parameter> FROM <cte_parameter> ) a;",
    "applied_rules": [
        "<database_parameter>",
        "<table_parameter>",
        "<column_definition_parameter>",
        "<engine_parameter>",
        "<charset_parameter>",
        "<collation_parameter>",
        "<index_parameter>",
        "<column_parameter>",
        "<value_parameter>",
        "<cte_parameter>",
        "<number_parameter>"
    ],
    "Affected Elements": "CTE, EXISTS, UNION ALL",
    "Root Cause Analysis": "The query hangs due to the complexity of nested subqueries and CTEs, likely leading to performance issues or deadlocks in execution."
}