{
    "pattern": "CREATE TABLE `cxo_competition_compare_stat_weekly` ( `week_flag` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `week_date_flag` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `week_start_date` <date_parameter> DEFAULT <default_value_parameter>, `is_company` <int_parameter> DEFAULT <default_value_parameter>, `is_product` <int_parameter> DEFAULT <default_value_parameter>, `brand` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `city_code` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `city_name` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `city_level` <int_parameter> DEFAULT <default_value_parameter>, `level_desc` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `province_code` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `province_name` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `region_code` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `region_name` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `stat_type` <varchar_parameter> COLLATE <collation_parameter> DEFAULT <default_value_parameter>, `week_insur_cnt` <bigint_parameter> DEFAULT <default_value_parameter>, `baidu_index` <bigint_parameter> DEFAULT <default_value_parameter>, `store_cnt` <bigint_parameter> DEFAULT <default_value_parameter>, `cumu_store_cnt` <bigint_parameter> DEFAULT <default_value_parameter>, `energy_cnt` <bigint_parameter> DEFAULT <default_value_parameter>, `cumu_energy_cnt` <bigint_parameter> DEFAULT <default_value_parameter>, `max_date` <date_parameter> DEFAULT <default_value_parameter>, KEY `week_flag` (`week_flag`), KEY `brand` (`brand`) ); ALTER TABLE `cxo_competition_compare_stat_weekly` SET TIFLASH REPLICA <replica_parameter>; INSERT INTO `cxo_competition_compare_stat_weekly` VALUES (<value_parameter>, <value_parameter>, <date_value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <value_parameter>, <date_value_parameter>); SET sql_mode=<sql_mode_parameter>; SELECT `week_date_flag` AS `date_code`, SUM(SUM(`store_cnt`)) OVER (PARTITION BY CASE WHEN <string_value_parameter> = <string_value_parameter> THEN IF(<string_value_parameter> = <string_value_parameter>, `region_name`, `city_name`) WHEN <string_value_parameter> = <string_value_parameter> THEN IF(<string_value_parameter> = <string_value_parameter>, `level_desc`, `city_name`) END, IF(`brand` IN (<string_value_parameter>, <string_value_parameter>), <string_value_parameter>, `brand`) ORDER BY `week_date_flag`) AS `store_cnt` FROM `cxo_competition_compare_stat_weekly` GROUP BY `week_date_flag`;",
    "applied_rules": [
        "<varchar_parameter>",
        "<collation_parameter>",
        "<default_value_parameter>",
        "<date_parameter>",
        "<int_parameter>",
        "<bigint_parameter>",
        "<replica_parameter>",
        "<value_parameter>",
        "<date_value_parameter>",
        "<sql_mode_parameter>",
        "<string_value_parameter>"
    ],
    "Affected Elements": "SUM, OVER, PARTITION BY, CASE, IF",
    "Root Cause Analysis": "The error indicates a mismatch in expected and actual data types during MPP query execution, likely due to inconsistencies in the schema of blocks being exchanged."
}