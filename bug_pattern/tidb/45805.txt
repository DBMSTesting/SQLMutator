{
    "pattern": "CREATE TABLE `signed_estimate_volume` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '', `estimate_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `dealer_id` varchar(40) NOT NULL DEFAULT '' COMMENT '', `broker_id` varchar(40) NOT NULL DEFAULT '' COMMENT '', `real_t0_volume` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `real_t1_volume` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `manager_yid` varchar(32) NOT NULL DEFAULT '' COMMENT '', `estimate_volume` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `estimate_year_month` varchar(8) NOT NULL DEFAULT '' COMMENT '', `is_dropped` tinyint(1) NOT NULL DEFAULT '0' COMMENT '', PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */, UNIQUE KEY `UNIQ_ESTIMATE_ID` (`estimate_id`), UNIQUE KEY `UNIQ_MONTH_YID_BROKER_DEALER_DROPPED` (`estimate_year_month`,`manager_yid`,`broker_id`,`dealer_id`,`is_dropped`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin AUTO_INCREMENT=630002 COMMENT=''; CREATE TABLE `unsigned_estimate_volume` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '', `estimate_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `estimate_year_month` varchar(8) NOT NULL DEFAULT '' COMMENT '', `business_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `broker_id` varchar(40) NOT NULL DEFAULT '' COMMENT '', `estimate_volume` bigint(20) NOT NULL DEFAULT '0' COMMENT '', `manager_yid` varchar(32) NOT NULL DEFAULT '' COMMENT '', PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */, UNIQUE KEY `UNIQ_SIGNED_ESTIMATE_ID` (`estimate_id`), UNIQUE KEY `UNIQ_BUSINESS_DEALER_MONTH_YID` (`estimate_year_month`,`manager_yid`,`broker_id`,`business_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin AUTO_INCREMENT=390525 COMMENT='待签约关系预估体量表'; INSERT INTO signed_estimate_volume (id, estimate_volume, real_t1_volume) VALUES (<dml_values_parameter>); SELECT `estimate_year_month`, `a_manager_yid` AS `manager_yid`, `real_t1_volume`, `real_t0_volume`, `a_estimate_volume` + IFNULL(`b_estimate_volume`, 0) AS `estimate_volume`, IFNULL(`a`.`increase_sum`, 0) + IFNULL(`b`.`increase_sum`, 0) AS `increase_sum`, IFNULL(`a`.`decrease_sum`, 0) + IFNULL(`b`.`decrease_sum`, 0) AS `decrease_sum` FROM ( SELECT `estimate_year_month`, `manager_yid` AS `a_manager_yid`, SUM(`real_t1_volume`) AS `real_t1_volume`, SUM(`real_t0_volume`) AS `real_t0_volume`, SUM(`estimate_volume`) AS `a_estimate_volume`, SUM(IF(`estimate_volume` > `real_t1_volume`, `estimate_volume` - `real_t1_volume`, 0)) AS `increase_sum`, SUM(IF(`estimate_volume` < `real_t1_volume`, `estimate_volume` - `real_t1_volume`, 0)) AS `decrease_sum` FROM `signed_estimate_volume` GROUP BY `manager_yid` ) AS `a` <join_operator_replace> ( SELECT `manager_yid` AS `b_manager_yid`, SUM(`estimate_volume`) AS `b_estimate_volume`, SUM(`estimate_volume`) AS `increase_sum`, 0 AS `decrease_sum` FROM `unsigned_estimate_volume` GROUP BY `manager_yid` ) AS `b` ON a.`a_manager_yid` = b.`b_manager_yid`;",
    "applied_rules": [
        "<dml_values_parameter>",
        "<join_operator_replace>"
    ],
    "Affected Elements": "LEFT JOIN, SUM, IFNULL, GROUP BY",
    "Root Cause Analysis": "The error 'index out of range [0] with length 0' indicates an issue with the join operation where no matching rows are found, leading to accessing an empty result set."
}