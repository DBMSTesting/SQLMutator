ID: 49753
Title: flaky test TestIssue24210
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
 [2023/12/25 03:46:07.786 +00:00] [WARN] [session.go:2240] ["run statement failed"] [schemaVersion=50] [error="mock ProjectionExec.baseExecutor.Open returned error"] [errorVerbose="mock ProjectionExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor.(*ProjectionExec).Open\n\tpkg/executor/projection.go:93\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:364\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec\n\tpkg/testkit/testkit.go:337\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecToErr\n\tpkg/testkit/testkit.go:410\npkg/executor/test/issuetest/issuetest_test_test.TestIssue24210\n\tpkg/executor/test/issuetest/executor_issue_test.go:47\ntesting.tRunner\n\tGOROOT/src/testing/testing.go:1595\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"] [session="{\n  \"currDBName\": \"test\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2023/12/25 03:46:07.786 +00:00] [WARN] [session.go:2240] ["run statement failed"] [schemaVersion=50] [error="mock ProjectionExec.baseExecutor.Open returned error"] [errorVerbose="mock ProjectionExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor.(*ProjectionExec).Open\n\tpkg/executor/projection.go:93\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*InsertExec).Open\n\tpkg/executor/insert.go:344\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal\n\tpkg/session/session.go:1600\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.ExecSQL\n\tpkg/disttask/framework/storage/task_table.go:119\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).executeSQLWithNewSession.func1\n\tpkg/disttask/framework/storage/task_table.go:214\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).WithNewSession\n\tpkg/disttask/framework/storage/task_table.go:179\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).executeSQLWithNewSession\n\tpkg/disttask/framework/storage/task_table.go:213\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).StartManager\n\tpkg/disttask/framework/storage/task_table.go:702\ngithub.com/pingcap/tidb/pkg/disttask/framework/taskexecutor.(*Manager).initMeta\n\tpkg/disttask/framework/taskexecutor/manager.go:111\ngithub.com/pingcap/tidb/pkg/disttask/framework/taskexecutor.(*Manager).Start\n\tpkg/disttask/framework/taskexecutor/manager.go:129\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop\n\tpkg/domain/domain.go:1497\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).InitDistTaskLoop.func1\n\tpkg/domain/domain.go:1491\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1\n\tpkg/util/wait_group_wrapper.go:99\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"] [session="{\n  \"currDBName\": \"\",\n  \"id\": 0,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2023/12/25 03:46:07.786 +00:00] [WARN] [manager.go:116] ["start manager failed"] [scope=] ["retry times"=0] [error="mock ProjectionExec.baseExecutor.Open returned error"] [errorVerbose="mock ProjectionExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor.(*ProjectionExec).Open\n\tpkg/executor/projection.go:93\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*InsertExec).Open\n\tpkg/executor/insert.go:344\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal\n\tpkg/session/session.go:1600\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.ExecSQL\n\tpkg/disttask/framework/storage/task_table.go:119\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).executeSQLWithNewSession.func1\n\tpkg/disttask/framework/storage/task_table.go:214\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).WithNewSession\n\tpkg/disttask/framework/storage/task_table.go:179\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).executeSQLWithNewSession\n\tpkg/disttask/framework/storage/task_table.go:213\ngithub.com/pingcap/tidb/pkg/disttask/framework/storage.(*TaskManager).StartManager\n\tpkg/disttask/framework/storage/task_table.go:702\ngithub.com/pingcap/tidb/pkg/disttask/framework/taskexecutor.(*Manager).initMeta\n\tpkg/disttask/framework/taskexecutor/manager.go:111\ngithub.com/pingcap/tidb/pkg/disttask/framework/taskexecutor.(*Manager).Start\n\tpkg/disttask/framework/taskexecutor/manager.go:129\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop\n\tpkg/domain/domain.go:1497\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).InitDistTaskLoop.func1\n\tpkg/domain/domain.go:1491\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1\n\tpkg/util/wait_group_wrapper.go:99\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"]
[2023/12/25 03:46:07.787 +00:00] [INFO] [tidb.go:286] ["rollbackTxn called due to ddl/autocommit failure"]
[2023/12/25 03:46:07.787 +00:00] [WARN] [session.go:2240] ["run statement failed"] [schemaVersion=50] [error="mock HashAggExec.baseExecutor.Open returned error"] [errorVerbose="mock HashAggExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor/aggregate.(*HashAggExec).Open\n\tpkg/executor/aggregate/agg_hash_executor.go:204\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:364\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec\n\tpkg/testkit/testkit.go:337\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecToErr\n\tpkg/testkit/testkit.go:410\npkg/executor/test/issuetest/issuetest_test_test.TestIssue24210\n\tpkg/executor/test/issuetest/executor_issue_test.go:53\ntesting.tRunner\n\tGOROOT/src/testing/testing.go:1595\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"] [session="{\n  \"currDBName\": \"test\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2023/12/25 03:46:07.787 +00:00] [INFO] [tidb.go:286] ["rollbackTxn called due to ddl/autocommit failure"]
[2023/12/25 03:46:07.787 +00:00] [WARN] [session.go:2240] ["run statement failed"] [schemaVersion=50] [error="mock StreamAggExec.baseExecutor.Open returned error"] [errorVerbose="mock StreamAggExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor/aggregate.(*StreamAggExec).Open\n\tpkg/executor/aggregate/agg_stream_executor.go:58\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:364\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec\n\tpkg/testkit/testkit.go:337\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecToErr\n\tpkg/testkit/testkit.go:410\npkg/executor/test/issuetest/issuetest_test_test.TestIssue24210\n\tpkg/executor/test/issuetest/executor_issue_test.go:59\ntesting.tRunner\n\tGOROOT/src/testing/testing.go:1595\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"] [session="{\n  \"currDBName\": \"test\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"]
[2023/12/25 03:46:07.788 +00:00] [INFO] [tidb.go:286] ["rollbackTxn called due to ddl/autocommit failure"]
[2023/12/25 03:46:07.788 +00:00] [WARN] [session.go:2240] ["run statement failed"] [schemaVersion=50] [error="mock SelectionExec.baseExecutor.Open returned error"] [errorVerbose="mock SelectionExec.baseExecutor.Open returned error\ngithub.com/pingcap/tidb/pkg/executor.(*SelectionExec).Open\n\tpkg/executor/executor.go:1550\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Open\n\tpkg/executor/internal/exec/executor.go:291\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).openExecutor\n\tpkg/executor/adapter.go:1238\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:566\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2386\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2228\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:364\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec\n\tpkg/testkit/testkit.go:337\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecToErr\n\tpkg/testkit/testkit.go:410\npkg/executor/test/issuetest/issuetest_test_test.TestIssue24210\n\tpkg/executor/test/issuetest/executor_issue_test.go:65\ntesting.tRunner\n\tGOROOT/src/testing/testing.go:1595\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650"] [session="{\n  \"currDBName\": \"test\",\n  \"id\": 1,\n  \"status\": 2,\n  \"strictMode\": true,\n  \"user\": null\n}"] 
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

