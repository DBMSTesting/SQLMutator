ID: 42971
Title: The result is wrong when tidb_opt_enable_late_materialization is on
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
ch workload
```sql
-- correct plan , result is 0
explain analyze SELECT     count(*) FROM     (         SELECT             c.c_id,             c.c_d_id,             c.c_w_id,             c.c_balance c1,             (                 SELECT                     sum(ol_amount)                 FROM                     orders STRAIGHT_JOIN order_line                 WHERE                     OL_W_ID = O_W_ID                     AND OL_D_ID = O_D_ID                     AND OL_O_ID = O_ID                     AND OL_DELIVERY_D IS NOT NULL                     AND O_W_ID = 1                     AND O_D_ID = c.C_D_ID                     AND O_C_ID = c.C_ID             ) sm,             (                 SELECT                     sum(h_amount)                 from                     history                 WHERE                     H_C_W_ID = 1                     AND H_C_D_ID = c.C_D_ID                     AND H_C_ID = c.C_ID             ) smh         FROM             customer c         WHERE             c.c_w_id = 1     ) t WHERE     c1 <> sm - smh;
+----------------------------------------------------------+-------------------+---------+--------------+------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                                                       | estRows           | actRows | task         | access object    | execution info                                                                                                                                                                                                                                                                                                                                                                               | operator info                                                                                                                                                                                                                                                                                     | memory  | disk |
+----------------------------------------------------------+-------------------+---------+--------------+------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| StreamAgg_35                                             | 1.00              | 1       | root         |                  | time:109.3ms, loops:2, RRU:0.000000, WRU:0.000000                                                                                                                                                                                                                                                                                                                                            | funcs:count(1)->Column#83                                                                                                                                                                                                                                                                         | 44.0 KB | N/A  |
| └─TableReader_152                                        | 2.99              | 0       | root         |                  | time:109.3ms, loops:1, cop_task: {num: 3, max: 0s, min: 0s, avg: 0s, p95: 0s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                                                                                                                                    | MppVersion: 1, data:ExchangeSender_151                                                                                                                                                                                                                                                            | 1.67 KB | N/A  |
|   └─ExchangeSender_151                                   | 2.99              | 0       | mpp[tiflash] |                  | tiflash_task:{proc max:107ms, min:106.2ms, avg: 106.7ms, p80:107ms, p95:107ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                | ExchangeType: PassThrough                                                                                                                                                                                                                                                                         | N/A     | N/A  |
|     └─HashJoin_148                                       | 2.99              | 0       | mpp[tiflash] |                  | tiflash_task:{proc max:107ms, min:106.2ms, avg: 106.7ms, p80:107ms, p95:107ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                | inner join, equal:[eq(tpcc.history.h_c_d_id, tpcc.customer.c_d_id) eq(tpcc.history.h_c_id, tpcc.customer.c_id)], other cond:ne(tpcc.customer.c_balance, minus(Column#72, Column#82))                                                                                                              | N/A     | N/A  |
|       ├─ExchangeReceiver_55(Build)                       | 2.99              | 90000   | mpp[tiflash] |                  | tiflash_task:{proc max:22ms, min:20.2ms, avg: 21.4ms, p80:22ms, p95:22ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|       │ └─ExchangeSender_54                              | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:20.9ms, min:0s, avg: 6.98ms, p80:20.9ms, p95:20.9ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | ExchangeType: Broadcast, Compression: FAST                                                                                                                                                                                                                                                        | N/A     | N/A  |
|       │   └─Projection_50                                | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.9ms, min:0s, avg: 6.64ms, p80:19.9ms, p95:19.9ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | Column#82, tpcc.history.h_c_d_id, tpcc.history.h_c_id                                                                                                                                                                                                                                             | N/A     | N/A  |
|       │     └─HashAgg_51                                 | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.9ms, min:0s, avg: 6.64ms, p80:19.9ms, p95:19.9ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | group by:tpcc.history.h_c_d_id, tpcc.history.h_c_id, funcs:sum(Column#84)->Column#82, funcs:firstrow(tpcc.history.h_c_d_id)->tpcc.history.h_c_d_id, funcs:firstrow(tpcc.history.h_c_id)->tpcc.history.h_c_id, stream_count: 8                                                                     | N/A     | N/A  |
|       │       └─ExchangeReceiver_53                      | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.9ms, min:0s, avg: 6.64ms, p80:19.9ms, p95:19.9ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|       │         └─ExchangeSender_52                      | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:16.8ms, min:0s, avg: 5.61ms, p80:16.8ms, p95:16.8ms, iters:1, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.history.h_c_d_id, collate: binary], [name: tpcc.history.h_c_id, collate: binary], stream_count: 8                                                                                                                          | N/A     | N/A  |
|       │           └─HashAgg_40                           | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:14.8ms, min:0s, avg: 4.94ms, p80:14.8ms, p95:14.8ms, iters:1, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    | group by:tpcc.history.h_c_d_id, tpcc.history.h_c_id, funcs:sum(tpcc.history.h_amount)->Column#84                                                                                                                                                                                                  | N/A     | N/A  |
|       │             └─Selection_49                       | 29896.42          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:8.82ms, min:0s, avg: 2.94ms, p80:8.82ms, p95:8.82ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    | eq(tpcc.history.h_c_w_id, 1)                                                                                                                                                                                                                                                                      | N/A     | N/A  |
|       │               └─TableFullScan_48                 | 30000000.00       | 66168   | mpp[tiflash] | table:history    | tiflash_task:{proc max:8.82ms, min:0s, avg: 2.94ms, p80:8.82ms, p95:8.82ms, iters:4, tasks:3, threads:24}, tiflash_scan:{dtfile:{total_scanned_packs:8, total_skipped_packs:3712, total_scanned_rows:65536, total_skipped_rows:30228277, total_rs_index_load_time: 0ms, total_read_time: 2ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}       | keep order:false                                                                                                                                                                                                                                                                                  | N/A     | N/A  |
|       └─Projection_76(Probe)                             | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:87ms, min:85.2ms, avg: 86.4ms, p80:87ms, p95:87ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | tpcc.customer.c_id, tpcc.customer.c_d_id, tpcc.customer.c_balance, Column#72                                                                                                                                                                                                                      | N/A     | N/A  |
|         └─HashAgg_77                                     | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:87ms, min:85.2ms, avg: 86.4ms, p80:87ms, p95:87ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | group by:tpcc.customer.c_d_id, tpcc.customer.c_id, tpcc.customer.c_w_id, funcs:firstrow(tpcc.customer.c_id)->tpcc.customer.c_id, funcs:firstrow(tpcc.customer.c_d_id)->tpcc.customer.c_d_id, funcs:firstrow(Column#89)->tpcc.customer.c_balance, funcs:sum(Column#90)->Column#72, stream_count: 8 | N/A     | N/A  |
|           └─ExchangeReceiver_79                          | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:87ms, min:84.2ms, avg: 85.7ms, p80:87ms, p95:87ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|             └─ExchangeSender_78                          | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:104.6ms, min:0s, avg: 34.9ms, p80:104.6ms, p95:104.6ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.customer.c_w_id, collate: binary], [name: tpcc.customer.c_d_id, collate: binary], [name: tpcc.customer.c_id, collate: binary], stream_count: 8                                                                             | N/A     | N/A  |
|               └─HashAgg_57                               | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:103.6ms, min:0s, avg: 34.5ms, p80:103.6ms, p95:103.6ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 | group by:tpcc.customer.c_d_id, tpcc.customer.c_id, tpcc.customer.c_w_id, funcs:firstrow(tpcc.customer.c_balance)->Column#89, funcs:sum(tpcc.order_line.ol_amount)->Column#90                                                                                                                      | N/A     | N/A  |
|                 └─HashJoin_75                            | 20943599305463.55 | 219574  | mpp[tiflash] |                  | tiflash_task:{proc max:99.6ms, min:0s, avg: 33.2ms, p80:99.6ms, p95:99.6ms, iters:45, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | left outer join, equal:[eq(tpcc.customer.c_d_id, tpcc.orders.o_d_id) eq(tpcc.customer.c_id, tpcc.orders.o_c_id)], stream_count: 8                                                                                                                                                                 | N/A     | N/A  |
|                   ├─ExchangeReceiver_62(Build)           | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:15.6ms, min:0s, avg: 5.19ms, p80:15.6ms, p95:15.6ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|                   │ └─ExchangeSender_61                  | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:12.4ms, min:0s, avg: 4.13ms, p80:12.4ms, p95:12.4ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.customer.c_d_id, collate: binary], [name: tpcc.customer.c_id, collate: binary], stream_count: 8                                                                                                                            | N/A     | N/A  |
|                   │   └─Selection_60                     | 29868.51          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:11.4ms, min:0s, avg: 3.8ms, p80:11.4ms, p95:11.4ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | eq(tpcc.customer.c_w_id, 1)                                                                                                                                                                                                                                                                       | N/A     | N/A  |
|                   │     └─TableFullScan_59               | 30000000.00       | 74021   | mpp[tiflash] | table:c          | tiflash_task:{proc max:10.4ms, min:0s, avg: 3.47ms, p80:10.4ms, p95:10.4ms, iters:15, tasks:3, threads:24}, tiflash_scan:{dtfile:{total_scanned_packs:9, total_skipped_packs:4652, total_scanned_rows:73728, total_skipped_rows:37617726, total_rs_index_load_time: 0ms, total_read_time: 4ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}      | keep order:false                                                                                                                                                                                                                                                                                  | N/A     | N/A  |
|                   └─ExchangeReceiver_71(Probe)           | 2094359930.55     | 210584  | mpp[tiflash] |                  | tiflash_task:{proc max:84.1ms, min:0s, avg: 28ms, p80:84.1ms, p95:84.1ms, iters:21, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|                     └─ExchangeSender_70                  | 2094359930.55     | 210584  | mpp[tiflash] |                  | tiflash_task:{proc max:91.1ms, min:0s, avg: 30.4ms, p80:91.1ms, p95:91.1ms, iters:11, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.orders.o_d_id, collate: binary], [name: tpcc.orders.o_c_id, collate: binary]                                                                                                                                               | N/A     | N/A  |
|                       └─HashJoin_63                      | 2094359930.55     | 210584  | mpp[tiflash] |                  | tiflash_task:{proc max:78.1ms, min:0s, avg: 26ms, p80:78.1ms, p95:78.1ms, iters:11, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | inner join, equal:[eq(tpcc.orders.o_d_id, tpcc.order_line.ol_d_id) eq(tpcc.orders.o_id, tpcc.order_line.ol_o_id)]                                                                                                                                                                                 | N/A     | N/A  |
|                         ├─ExchangeReceiver_67(Build)     | 29863.80          | 90000   | mpp[tiflash] |                  | tiflash_task:{proc max:16.1ms, min:0s, avg: 5.38ms, p80:16.1ms, p95:16.1ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                   | N/A     | N/A  |
|                         │ └─ExchangeSender_66            | 29863.80          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:13.5ms, min:0s, avg: 4.5ms, p80:13.5ms, p95:13.5ms, iters:1, tasks:3, threads:23}                                                                                                                                                                                                                                                                                     | ExchangeType: Broadcast, Compression: FAST                                                                                                                                                                                                                                                        | N/A     | N/A  |
|                         │   └─Selection_65               | 29863.80          | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:12.5ms, min:0s, avg: 4.17ms, p80:12.5ms, p95:12.5ms, iters:1, tasks:3, threads:23}                                                                                                                                                                                                                                                                                    | eq(tpcc.orders.o_w_id, 1), not(isnull(tpcc.orders.o_c_id))                                                                                                                                                                                                                                        | N/A     | N/A  |
|                         │     └─TableFullScan_64         | 30000000.00       | 65779   | mpp[tiflash] | table:orders     | tiflash_task:{proc max:11.5ms, min:0s, avg: 3.84ms, p80:11.5ms, p95:11.5ms, iters:20, tasks:3, threads:23}, tiflash_scan:{dtfile:{total_scanned_packs:8, total_skipped_packs:3798, total_scanned_rows:65536, total_skipped_rows:30942961, total_rs_index_load_time: 0ms, total_read_time: 4ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}      | keep order:false                                                                                                                                                                                                                                                                                  | N/A     | N/A  |
|                         └─Selection_69(Probe)            | 209435.99         | 210584  | mpp[tiflash] |                  | tiflash_task:{proc max:60.1ms, min:0s, avg: 20ms, p80:60.1ms, p95:60.1ms, iters:11, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | eq(tpcc.order_line.ol_w_id, 1), not(isnull(tpcc.order_line.ol_delivery_d))                                                                                                                                                                                                                        | N/A     | N/A  |
|                           └─TableFullScan_68             | 299979280.00      | 827032  | mpp[tiflash] | table:order_line | tiflash_task:{proc max:54.1ms, min:0s, avg: 18ms, p80:54.1ms, p95:54.1ms, iters:120, tasks:3, threads:24}, tiflash_scan:{dtfile:{total_scanned_packs:100, total_skipped_packs:37145, total_scanned_rows:817491, total_skipped_rows:302891021, total_rs_index_load_time: 1ms, total_read_time: 47ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0} | keep order:false                                                                                                                                                                                                                                                                                  | N/A     | N/A  |
+----------------------------------------------------------+-------------------+---------+--------------+------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+

-- wrong plan , result is not stable
explain analyze SELECT     count(*) FROM     (         SELECT             c.c_id,             c.c_d_id,             c.c_w_id,             c.c_balance c1,             (                 SELECT                     sum(ol_amount)                 FROM                     orders STRAIGHT_JOIN order_line                 WHERE                     OL_W_ID = O_W_ID                     AND OL_D_ID = O_D_ID                     AND OL_O_ID = O_ID                     AND OL_DELIVERY_D IS NOT NULL                     AND O_W_ID = 1                     AND O_D_ID = c.C_D_ID                     AND O_C_ID = c.C_ID             ) sm,             (                 SELECT                     sum(h_amount)                 from                     history                 WHERE                     H_C_W_ID = 1                     AND H_C_D_ID = c.C_D_ID                     AND H_C_ID = c.C_ID             ) smh         FROM             customer c         WHERE             c.c_w_id = 1     ) t WHERE     c1 <> sm - smh;
+----------------------------------------------------------+-------------------+---------+--------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+------+
| id                                                       | estRows           | actRows | task         | access object    | execution info                                                                                                                                                                                                                                                                                                                                                                                 | operator info                                                                                                                                                                                                                                                                                     | memory   | disk |
+----------------------------------------------------------+-------------------+---------+--------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+------+
| StreamAgg_35                                             | 1.00              | 1       | root         |                  | time:332.8ms, loops:2, RRU:0.000000, WRU:0.000000                                                                                                                                                                                                                                                                                                                                              | funcs:count(1)->Column#83                                                                                                                                                                                                                                                                         | 154.6 KB | N/A  |
| └─TableReader_152                                        | 2.99              | 57818   | root         |                  | time:329.3ms, loops:73, cop_task: {num: 27, max: 0s, min: 0s, avg: 0s, p95: 0s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                                                                                                                                    | MppVersion: 1, data:ExchangeSender_151                                                                                                                                                                                                                                                            | 364.4 KB | N/A  |
|   └─ExchangeSender_151                                   | 2.99              | 57818   | mpp[tiflash] |                  | tiflash_task:{proc max:237.4ms, min:235.6ms, avg: 236.5ms, p80:237.4ms, p95:237.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                            | ExchangeType: PassThrough                                                                                                                                                                                                                                                                         | N/A      | N/A  |
|     └─HashJoin_148                                       | 2.99              | 57818   | mpp[tiflash] |                  | tiflash_task:{proc max:235.4ms, min:233.6ms, avg: 234.5ms, p80:235.4ms, p95:235.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                            | inner join, equal:[eq(tpcc.history.h_c_d_id, tpcc.customer.c_d_id) eq(tpcc.history.h_c_id, tpcc.customer.c_id)], other cond:ne(tpcc.customer.c_balance, minus(Column#72, Column#82))                                                                                                              | N/A      | N/A  |
|       ├─ExchangeReceiver_55(Build)                       | 2.99              | 90000   | mpp[tiflash] |                  | tiflash_task:{proc max:22.4ms, min:20.6ms, avg: 21.5ms, p80:22.4ms, p95:22.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|       │ └─ExchangeSender_54                              | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.4ms, min:0s, avg: 6.48ms, p80:19.4ms, p95:19.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | ExchangeType: Broadcast, Compression: FAST                                                                                                                                                                                                                                                        | N/A      | N/A  |
|       │   └─Projection_50                                | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.4ms, min:0s, avg: 6.48ms, p80:19.4ms, p95:19.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | Column#82, tpcc.history.h_c_d_id, tpcc.history.h_c_id                                                                                                                                                                                                                                             | N/A      | N/A  |
|       │     └─HashAgg_51                                 | 2.99              | 30000   | mpp[tiflash] |                  | tiflash_task:{proc max:19.4ms, min:0s, avg: 6.48ms, p80:19.4ms, p95:19.4ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | group by:tpcc.history.h_c_d_id, tpcc.history.h_c_id, funcs:sum(Column#84)->Column#82, funcs:firstrow(tpcc.history.h_c_d_id)->tpcc.history.h_c_d_id, funcs:firstrow(tpcc.history.h_c_id)->tpcc.history.h_c_id, stream_count: 8                                                                     | N/A      | N/A  |
|       │       └─ExchangeReceiver_53                      | 2.99              | 30618   | mpp[tiflash] |                  | tiflash_task:{proc max:18.6ms, min:0s, avg: 6.21ms, p80:18.6ms, p95:18.6ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|       │         └─ExchangeSender_52                      | 2.99              | 30618   | mpp[tiflash] |                  | tiflash_task:{proc max:16ms, min:0s, avg: 5.32ms, p80:16ms, p95:16ms, iters:2, tasks:3, threads:23}                                                                                                                                                                                                                                                                                            | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.history.h_c_d_id, collate: binary], [name: tpcc.history.h_c_id, collate: binary], stream_count: 8                                                                                                                          | N/A      | N/A  |
|       │           └─HashAgg_40                           | 2.99              | 30618   | mpp[tiflash] |                  | tiflash_task:{proc max:13ms, min:0s, avg: 4.32ms, p80:13ms, p95:13ms, iters:2, tasks:3, threads:23}                                                                                                                                                                                                                                                                                            | group by:tpcc.history.h_c_d_id, tpcc.history.h_c_id, funcs:sum(tpcc.history.h_amount)->Column#84                                                                                                                                                                                                  | N/A      | N/A  |
|       │             └─TableFullScan_48                   | 29896.42          | 66168   | mpp[tiflash] | table:history    | tiflash_task:{proc max:8.12ms, min:0s, avg: 2.71ms, p80:8.12ms, p95:8.12ms, iters:4, tasks:3, threads:23}, tiflash_scan:{dtfile:{total_scanned_packs:8, total_skipped_packs:3713, total_scanned_rows:65536, total_skipped_rows:30228277, total_rs_index_load_time: 0ms, total_read_time: 1ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}         | pushed down filter:eq(tpcc.history.h_c_w_id, 1), keep order:false                                                                                                                                                                                                                                 | N/A      | N/A  |
|       └─Projection_76(Probe)                             | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:214.3ms, min:212.4ms, avg: 213.5ms, p80:214.3ms, p95:214.3ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                            | tpcc.customer.c_id, tpcc.customer.c_d_id, tpcc.customer.c_balance, Column#72                                                                                                                                                                                                                      | N/A      | N/A  |
|         └─HashAgg_77                                     | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:214.3ms, min:212.4ms, avg: 213.5ms, p80:214.3ms, p95:214.3ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                            | group by:tpcc.customer.c_d_id, tpcc.customer.c_id, tpcc.customer.c_w_id, funcs:firstrow(tpcc.customer.c_id)->tpcc.customer.c_id, funcs:firstrow(tpcc.customer.c_d_id)->tpcc.customer.c_d_id, funcs:firstrow(Column#89)->tpcc.customer.c_balance, funcs:sum(Column#90)->Column#72, stream_count: 8 | N/A      | N/A  |
|           └─ExchangeReceiver_79                          | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:212.3ms, min:210.4ms, avg: 211.5ms, p80:212.3ms, p95:212.3ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                            | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|             └─ExchangeSender_78                          | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:229.3ms, min:0s, avg: 76.4ms, p80:229.3ms, p95:229.3ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.customer.c_w_id, collate: binary], [name: tpcc.customer.c_d_id, collate: binary], [name: tpcc.customer.c_id, collate: binary], stream_count: 8                                                                             | N/A      | N/A  |
|               └─HashAgg_57                               | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:224.3ms, min:0s, avg: 74.8ms, p80:224.3ms, p95:224.3ms, iters:3, tasks:3, threads:24}                                                                                                                                                                                                                                                                                   | group by:tpcc.customer.c_d_id, tpcc.customer.c_id, tpcc.customer.c_w_id, funcs:firstrow(tpcc.customer.c_balance)->Column#89, funcs:sum(tpcc.order_line.ol_amount)->Column#90                                                                                                                      | N/A      | N/A  |
|                 └─HashJoin_75                            | 20943599305463.55 | 4652290 | mpp[tiflash] |                  | tiflash_task:{proc max:207.3ms, min:0s, avg: 69.1ms, p80:207.3ms, p95:207.3ms, iters:130, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 | left outer join, equal:[eq(tpcc.customer.c_d_id, tpcc.orders.o_d_id) eq(tpcc.customer.c_id, tpcc.orders.o_c_id)], stream_count: 8                                                                                                                                                                 | N/A      | N/A  |
|                   ├─ExchangeReceiver_62(Build)           | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:21.3ms, min:0s, avg: 7.09ms, p80:21.3ms, p95:21.3ms, iters:24, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | stream_count: 8                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|                   │ └─ExchangeSender_61                  | 29868.51          | 74024   | mpp[tiflash] |                  | tiflash_task:{proc max:17.4ms, min:0s, avg: 5.81ms, p80:17.4ms, p95:17.4ms, iters:15, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.customer.c_d_id, collate: binary], [name: tpcc.customer.c_id, collate: binary], stream_count: 8                                                                                                                            | N/A      | N/A  |
|                   │   └─TableFullScan_59                 | 29868.51          | 74024   | mpp[tiflash] | table:c          | tiflash_task:{proc max:12.4ms, min:0s, avg: 4.14ms, p80:12.4ms, p95:12.4ms, iters:15, tasks:3, threads:24}, tiflash_scan:{dtfile:{total_scanned_packs:9, total_skipped_packs:4412, total_scanned_rows:73728, total_skipped_rows:35678240, total_rs_index_load_time: 0ms, total_read_time: 5ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}        | pushed down filter:eq(tpcc.customer.c_w_id, 1), keep order:false                                                                                                                                                                                                                                  | N/A      | N/A  |
|                   └─ExchangeReceiver_71(Probe)           | 2094359930.55     | 1677888 | mpp[tiflash] |                  | tiflash_task:{proc max:162.7ms, min:0s, avg: 54.2ms, p80:162.7ms, p95:162.7ms, iters:84, tasks:3, threads:24}                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|                     └─ExchangeSender_70                  | 2094359930.55     | 1677888 | mpp[tiflash] |                  | tiflash_task:{proc max:198.5ms, min:0s, avg: 66.2ms, p80:198.5ms, p95:198.5ms, iters:123, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.orders.o_d_id, collate: binary], [name: tpcc.orders.o_c_id, collate: binary]                                                                                                                                               | N/A      | N/A  |
|                       └─HashJoin_63                      | 2094359930.55     | 1677888 | mpp[tiflash] |                  | tiflash_task:{proc max:131.1ms, min:0s, avg: 43.7ms, p80:131.1ms, p95:131.1ms, iters:123, tasks:3, threads:24}                                                                                                                                                                                                                                                                                 | inner join, equal:[eq(tpcc.orders.o_d_id, tpcc.order_line.ol_d_id) eq(tpcc.orders.o_id, tpcc.order_line.ol_o_id)]                                                                                                                                                                                 | N/A      | N/A  |
|                         ├─ExchangeReceiver_67(Build)     | 29863.80          | 197337  | mpp[tiflash] |                  | tiflash_task:{proc max:21.1ms, min:0s, avg: 7.04ms, p80:21.1ms, p95:21.1ms, iters:21, tasks:3, threads:24}                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|                         │ └─ExchangeSender_66            | 29863.80          | 65779   | mpp[tiflash] |                  | tiflash_task:{proc max:13.7ms, min:0s, avg: 4.56ms, p80:13.7ms, p95:13.7ms, iters:20, tasks:3, threads:23}                                                                                                                                                                                                                                                                                     | ExchangeType: Broadcast, Compression: FAST                                                                                                                                                                                                                                                        | N/A      | N/A  |
|                         │   └─Selection_65               | 29863.80          | 65779   | mpp[tiflash] |                  | tiflash_task:{proc max:11.7ms, min:0s, avg: 3.9ms, p80:11.7ms, p95:11.7ms, iters:20, tasks:3, threads:23}                                                                                                                                                                                                                                                                                      | not(isnull(tpcc.orders.o_c_id))                                                                                                                                                                                                                                                                   | N/A      | N/A  |
|                         │     └─TableFullScan_64         | 29863.80          | 65779   | mpp[tiflash] | table:orders     | tiflash_task:{proc max:11.7ms, min:0s, avg: 3.9ms, p80:11.7ms, p95:11.7ms, iters:20, tasks:3, threads:23}, tiflash_scan:{dtfile:{total_scanned_packs:8, total_skipped_packs:3798, total_scanned_rows:65536, total_skipped_rows:30942961, total_rs_index_load_time: 0ms, total_read_time: 4ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}         | pushed down filter:eq(tpcc.orders.o_w_id, 1), keep order:false                                                                                                                                                                                                                                    | N/A      | N/A  |
|                         └─Selection_69(Probe)            | 209435.99         | 641347  | mpp[tiflash] |                  | tiflash_task:{proc max:61.5ms, min:0s, avg: 20.5ms, p80:61.5ms, p95:61.5ms, iters:105, tasks:3, threads:24}                                                                                                                                                                                                                                                                                    | not(isnull(tpcc.order_line.ol_delivery_d))                                                                                                                                                                                                                                                        | N/A      | N/A  |
|                           └─TableFullScan_68             | 299210.86         | 826583  | mpp[tiflash] | table:order_line | tiflash_task:{proc max:57.5ms, min:0s, avg: 19.2ms, p80:57.5ms, p95:57.5ms, iters:105, tasks:3, threads:24}, tiflash_scan:{dtfile:{total_scanned_packs:100, total_skipped_packs:37302, total_scanned_rows:817491, total_skipped_rows:304200706, total_rs_index_load_time: 0ms, total_read_time: 51ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0} | pushed down filter:eq(tpcc.order_line.ol_w_id, 1), keep order:false                                                                                                                                                                                                                               | N/A      | N/A  |
+----------------------------------------------------------+-------------------+---------+--------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+------+
```
### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v7.1.0-alpha
Edition: Community
Git Commit Hash: a20e7fd3a462c4ae122f7b65d60e89e4c65a7b39
Git Branch: heads/refs/tags/v7.1.0-alpha
UTC Build Time: 2023-04-11 11:43:41
GoVersion: go1.20.3
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv
