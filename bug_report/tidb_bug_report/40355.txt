ID: 40355
Title: DATA RACE in the LockKeys
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
==================
WARNING: DATA RACE
Write at 0x00c0078310b0 by goroutine 305355:
  github.com/tikv/client-go/v2/internal/unionstore.(*MemDB).allocNode()
      external/com_github_tikv_client_go_v2/internal/unionstore/memdb.go:788 +0xb3
  github.com/tikv/client-go/v2/internal/unionstore.(*MemDB).traverse()
      external/com_github_tikv_client_go_v2/internal/unionstore/memdb.go:410 +0x369
  github.com/tikv/client-go/v2/internal/unionstore.(*MemDB).set()
      external/com_github_tikv_client_go_v2/internal/unionstore/memdb.go:335 +0x1ae
  github.com/tikv/client-go/v2/internal/unionstore.(*MemDB).UpdateFlags()
      external/com_github_tikv_client_go_v2/internal/unionstore/memdb.go:250 +0x213a
  github.com/tikv/client-go/v2/txnkv/transaction.(*KVTxn).LockKeys()
      external/com_github_tikv_client_go_v2/txnkv/transaction/txn.go:1110 +0x20a5
  github.com/pingcap/tidb/store/driver/txn.(*tikvTxn).LockKeys()
      store/driver/txn/txn_driver.go:75 +0x105
  github.com/pingcap/tidb/session.(*LazyTxn).LockKeys()
      session/txn.go:442 +0x22e
  github.com/pingcap/tidb/executor.doLockKeys()
      executor/executor.go:1300 +0x30d
  github.com/pingcap/tidb/executor.(*SelectLockExec).Next()
      executor/executor.go:1232 +0x78f
  github.com/pingcap/tidb/executor.Next()
      executor/executor.go:328 +0x5c3
  github.com/pingcap/tidb/executor.(*UnionExec).resultPuller()
      executor/executor.go:1878 +0x8e9
  github.com/pingcap/tidb/executor.(*UnionExec).initialize.func1()
      executor/executor.go:1831 +0x64
Previous read at 0x00c0078310b0 by goroutine 305356:
  github.com/tikv/client-go/v2/internal/unionstore.(*MemDB).Len()
      external/com_github_tikv_client_go_v2/internal/unionstore/memdb.go:301 +0x97
  github.com/tikv/client-go/v2/txnkv/transaction.(*KVTxn).Len()
      external/com_github_tikv_client_go_v2/txnkv/transaction/txn.go:1267 +0x52
  github.com/pingcap/tidb/store/driver/txn.(*tikvTxn).Len()
      <autogenerated>:1 +0x29
  github.com/pingcap/tidb/session.(*LazyTxn).LockKeys()
      session/txn.go:448 +0x2e1
  github.com/pingcap/tidb/executor.doLockKeys()
      executor/executor.go:1300 +0x30d
  github.com/pingcap/tidb/executor.(*SelectLockExec).Next()
      executor/executor.go:1232 +0x78f
  github.com/pingcap/tidb/executor.Next()
      executor/executor.go:328 +0x5c3
  github.com/pingcap/tidb/executor.(*UnionExec).resultPuller()
      executor/executor.go:1878 +0x8e9
  github.com/pingcap/tidb/executor.(*UnionExec).initialize.func1()
      executor/executor.go:1831 +0x64
Goroutine 305355 (running) created at:
  github.com/pingcap/tidb/executor.(*UnionExec).initialize()
      executor/executor.go:1831 +0x4d7
  github.com/pingcap/tidb/executor.(*UnionExec).Next()
      executor/executor.go:1904 +0xca
  github.com/pingcap/tidb/executor.Next()
      executor/executor.go:328 +0x5c3
  github.com/pingcap/tidb/executor.(*HashAggExec).fetchChildData()
      executor/aggregate.go:817 +0x325
  github.com/pingcap/tidb/executor.(*HashAggExec).prepare4ParallelExec.func3()
      executor/aggregate.go:854 +0x64
Goroutine 305356 (finished) created at:
  github.com/pingcap/tidb/executor.(*UnionExec).initialize()
      executor/executor.go:1831 +0x4d7
  github.com/pingcap/tidb/executor.(*UnionExec).Next()
      executor/executor.go:1904 +0xca
  github.com/pingcap/tidb/executor.Next()
      executor/executor.go:328 +0x5c3
  github.com/pingcap/tidb/executor.(*HashAggExec).fetchChildData()
      executor/aggregate.go:817 +0x325
  github.com/pingcap/tidb/executor.(*HashAggExec).prepare4ParallelExec.func3()
      executor/aggregate.go:854 +0x64
================== 
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

