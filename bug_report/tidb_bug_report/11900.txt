ID: 11900
Title: Window function generates uncertain results
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

1. What did you do?
If possible, provide a recipe for reproducing the error.

Tpch with scale factor 10.  

```
+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table    | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| lineitem | CREATE TABLE `lineitem` (
  `L_ORDERKEY` bigint(20) NOT NULL,
  `L_PARTKEY` bigint(20) NOT NULL,
  `L_SUPPKEY` bigint(20) NOT NULL,
  `L_LINENUMBER` bigint(20) NOT NULL,
  `L_QUANTITY` decimal(15,2) NOT NULL,
  `L_EXTENDEDPRICE` decimal(15,2) NOT NULL,
  `L_DISCOUNT` decimal(15,2) NOT NULL,
  `L_TAX` decimal(15,2) NOT NULL,
  `L_RETURNFLAG` char(1) NOT NULL,
  `L_LINESTATUS` char(1) NOT NULL,
  `L_SHIPDATE` date NOT NULL,
  `L_COMMITDATE` date NOT NULL,
  `L_RECEIPTDATE` date NOT NULL,
  `L_SHIPINSTRUCT` char(25) NOT NULL,
  `L_SHIPMODE` char(10) NOT NULL,
  `L_COMMENT` varchar(44) NOT NULL,
  PRIMARY KEY (`L_ORDERKEY`,`L_LINENUMBER`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

Query:
```sql
    select
        l_orderkey,
        l_linenumber,
        l_quantity,
        l_extendedprice,
        avg(l_quantity) over (partition by l_partkey) as avg_l_quantity
    from 
        lineitem,
        part
    where 
        p_partkey = l_partkey
        and p_brand = 'Brand#44'
        and p_container = 'WRAP PKG'
    order by l_orderkey, l_linenumber;
```

2. What did you expect to see?

The query should have a deterministic result when execute the query multiple times.

3. What did you see instead?

The query returns different results in the window function column.
```
$ diff r1.txt r2.txt
125c125
< |     111265 |            3 |      14.00 |        18498.48 |      31.454545 |
---
> |     111265 |            3 |      14.00 |        18498.48 |      31.181818 |
165c165
< |     141347 |            5 |      22.00 |        22352.88 |      29.043478 |
---
> |     141347 |            5 |      22.00 |        22352.88 |      30.304348 |
186c186
< |     161152 |            3 |      35.00 |        42948.50 |      26.161290 |
---
> |     161152 |            3 |      35.00 |        42948.50 |      26.000000 |
207c207
< |     187140 |            4 |      27.00 |        40594.77 |      23.384615 |
---
> |     187140 |            4 |      27.00 |        40594.77 |      24.866667 |

.........
```


4. What version of TiDB are you using (`tidb-server -V` or run `select tidb_version();` on TiDB)?
```
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tidb_version()                                                                                                                                                                                                                                                                                                             |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Release Version: v4.0.0-alpha-37-gfe03864
Git Commit Hash: fe038642e5c3f37730e9c55362a9651f6a16d1fd
Git Branch: master
UTC Build Time: 2019-08-13 03:12:42
GoVersion: go version go1.12.5 linux/amd64
Race Enabled: false
TiKV Min Version: v3.0.0-60965b006877ca7234adaced7890d7b029ed1306
Check Table Before Drop: false |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)
```
