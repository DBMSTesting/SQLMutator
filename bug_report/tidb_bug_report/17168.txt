ID: 17168
Title: join table got incorrect result
Description:
## Bug Report

### 1. What did you do?

Use the latest TiDB and import this database.

[a.sql.zip](https://github.com/pingcap/tidb/files/4620389/a.sql.zip)

Then run the following SQL

```sql
select * from view_4 AS tmp1 RIGHT JOIN view_7 AS tmp2 ON 1;
```

### 2. What did you expect to see?

In MySQL 8.0

```sql
mysql> select * from view_7;
+-------+-------+
| col_1 | col_2 |
+-------+-------+
|    14 | 65535 |
|    15 |     0 |
|    17 |    -1 |
+-------+-------+
3 rows in set (0.00 sec)

mysql> select * from view_4;
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
| col_1 | col_2 | col_3 | col_4 | col_5 | col_6 | col_7 | col_8 | col_9               |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
8 rows in set, 1 warning (0.01 sec)

mysql> select * from view_4 AS tmp1 RIGHT JOIN view_7 AS tmp2 ON 1;
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
| col_1 | col_2 | col_3 | col_4 | col_5 | col_6 | col_7 | col_8 | col_9               | col_1 | col_2 |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    14 | 65535 |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    15 |     0 |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    17 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    14 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    15 |     0 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    17 |    -1 |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
24 rows in set, 1 warning (0.01 sec)
```

### 3. What did you see instead?

In TiDB

```sql
mysql> select * from view_7;
+-------+-------+
| col_1 | col_2 |
+-------+-------+
|    14 | 65535 |
|    15 |     0 |
|    17 |    -1 |
+-------+-------+
3 rows in set (0.00 sec)

mysql> select * from view_4;
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
| col_1 | col_2 | col_3 | col_4 | col_5 | col_6 | col_7 | col_8 | col_9               |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+
8 rows in set, 3 warnings (0.01 sec)

mysql> select * from view_4 AS tmp1 RIGHT JOIN view_7 AS tmp2 ON 1;
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
| col_1 | col_2 | col_3 | col_4 | col_5 | col_6 | col_7 | col_8 | col_9               | col_1 | col_2 |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |     8 | 65535 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |     8 | 65535 |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |     9 |    -1 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |     9 |    -1 |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    10 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    10 |  NULL |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    11 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    11 |  NULL |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    12 |  NULL |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    12 |  NULL |
|     6 |    -1 |  NULL |     3 |  NULL |    31 |     1 |  NULL |                     |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    16 | 65535 |     0 | 0000-00-00 00:00:00 |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    17 |    -1 |   0.1 | 0000-00-00 00:00:00 |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    18 |    -1 |   0.5 | NULL                |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    20 | 65535 |     1 | NULL                |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    21 |     1 |  NULL | 0000-00-00 00:00:00 |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    23 |     1 |  NULL | NULL                |    13 |     1 |
|     6 |    -1 |  NULL |     4 |     0 |    25 |     1 |  NULL |                     |    13 |     1 |
+-------+-------+-------+-------+-------+-------+-------+-------+---------------------+-------+-------+
48 rows in set, 3 warnings (0.01 sec)
```

The row number and value of second col_1(from view_7) is incorrect.

### 4. What version of TiDB are you using? (`tidb-server -V` or run `select tidb_version();` on TiDB)

```
Release Version: v4.0.0-beta-895-g5a0787dfa
Git Commit Hash: 5a0787dfa91505430b47c4cf8c7c4245ac6b3783
Git Branch: master
UTC Build Time: 2020-05-13 06:59:09
GoVersion: go1.13.3
Race Enabled: false
TiKV Min Version: v3.0.0-60965b006877ca7234adaced7890d7b029ed1306
Check Table Before Drop: false
```
