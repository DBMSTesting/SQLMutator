ID: 42028
Title: Unstable test TestLoadDataAutoRandom
Description:
```

[2023/03/08 19:21:20.707 +08:00] [INFO] [load_data.go:1031] ["batch limit hit when inserting rows"] [conn=2199023255957] [maxBatchRows=1024] [totalRows=128]
[2023/03/08 19:21:20.708 +08:00] [INFO] [load_data.go:1031] ["batch limit hit when inserting rows"] [conn=2199023255957] [maxBatchRows=1024] [totalRows=256]
[2023/03/08 19:21:20.709 +08:00] [ERROR] [load_data.go:854] ["commitWork panicked"] [conn=2199023255957] [r={}] [stack="github.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork.func1\n\texecutor/load_data.go:856\nruntime.gopanic\n\tGOROOT/src/runtime/panic.go:884\nruntime.goPanicIndex\n\tGOROOT/src/runtime/panic.go:113\ngithub.com/pingcap/tidb/executor.getKeysNeedCheckOneRow\n\texecutor/batch_checker.go:122\ngithub.com/pingcap/tidb/executor.getKeysNeedCheck\n\texecutor/batch_checker.go:89\ngithub.com/pingcap/tidb/executor.(*InsertValues).batchCheckAndInsert\n\texecutor/insert_common.go:1153\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).CheckAndInsertOneBatch\n\texecutor/load_data.go:967\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitOneTask\n\texecutor/load_data.go:926\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork\n\texecutor/load_data.go:887\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).Load.func4\n\texecutor/load_data.go:770\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\texternal/org_golang_x_sync/errgroup/errgroup.go:75"] [stack="github.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork.func1\n\texecutor/load_data.go:854\nruntime.gopanic\n\tGOROOT/src/runtime/panic.go:884\nruntime.goPanicIndex\n\tGOROOT/src/runtime/panic.go:113\ngithub.com/pingcap/tidb/executor.getKeysNeedCheckOneRow\n\texecutor/batch_checker.go:122\ngithub.com/pingcap/tidb/executor.getKeysNeedCheck\n\texecutor/batch_checker.go:89\ngithub.com/pingcap/tidb/executor.(*InsertValues).batchCheckAndInsert\n\texecutor/insert_common.go:1153\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).CheckAndInsertOneBatch\n\texecutor/load_data.go:967\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitOneTask\n\texecutor/load_data.go:926\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork\n\texecutor/load_data.go:887\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).Load.func4\n\texecutor/load_data.go:770\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\texternal/org_golang_x_sync/errgroup/errgroup.go:75"]
[2023/03/08 19:21:20.710 +08:00] [INFO] [load_data.go:1031] ["batch limit hit when inserting rows"] [conn=2199023255957] [maxBatchRows=1024] [totalRows=384]
[2023/03/08 19:21:20.711 +08:00] [INFO] [load_data.go:1031] ["batch limit hit when inserting rows"] [conn=2199023255957] [maxBatchRows=1024] [totalRows=512]
[2023/03/08 19:21:20.713 +08:00] [ERROR] [conn.go:1622] ["write data meet error"] [conn=2199023255957] [error="io: read/write on closed pipe"] [stack="github.com/pingcap/tidb/server.(*clientConn).handleLoadData.func1\n\tserver/conn.go:1622"]
[2023/03/08 19:21:20.713 +08:00] [INFO] [conn.go:1635] ["not drained yet, try reading left data from client connection"] [conn=2199023255957]
[2023/03/08 19:21:20.713 +08:00] [INFO] [conn.go:1652] ["draining finished for error"] [conn=2199023255957] [error="runtime error: index out of range [0] with length 0"] [errorVerbose="runtime error: index out of range [0] with length 0\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork.func1\n\texecutor/load_data.go:857\nruntime.gopanic\n\tGOROOT/src/runtime/panic.go:884\nruntime.goPanicIndex\n\tGOROOT/src/runtime/panic.go:113\ngithub.com/pingcap/tidb/executor.getKeysNeedCheckOneRow\n\texecutor/batch_checker.go:122\ngithub.com/pingcap/tidb/executor.getKeysNeedCheck\n\texecutor/batch_checker.go:89\ngithub.com/pingcap/tidb/executor.(*InsertValues).batchCheckAndInsert\n\texecutor/insert_common.go:1153\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).CheckAndInsertOneBatch\n\texecutor/load_data.go:967\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitOneTask\n\texecutor/load_data.go:926\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork\n\texecutor/load_data.go:887\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).Load.func4\n\texecutor/load_data.go:770\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\texternal/org_golang_x_sync/errgroup/errgroup.go:75\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1598"]
[2023/03/08 19:21:20.714 +08:00] [INFO] [conn.go:1152] ["command dispatched failed"] [conn=2199023255957] [connInfo="id:2199023255957, addr:127.0.0.1:48744 status:10, collation:utf8mb4_general_ci, user:root"] [command=Query] [status="inTxn:0, autocommit:1"] [sql="load data local infile \"/tmp/load_data_txn_error.csv2635753952\" into table t (c2, c3)"] [txn_mode=PESSIMISTIC] [timestamp=439949585468882944] [err="runtime error: index out of range [0] with length 0\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork.func1\n\texecutor/load_data.go:857\nruntime.gopanic\n\tGOROOT/src/runtime/panic.go:884\nruntime.goPanicIndex\n\tGOROOT/src/runtime/panic.go:113\ngithub.com/pingcap/tidb/executor.getKeysNeedCheckOneRow\n\texecutor/batch_checker.go:122\ngithub.com/pingcap/tidb/executor.getKeysNeedCheck\n\texecutor/batch_checker.go:89\ngithub.com/pingcap/tidb/executor.(*InsertValues).batchCheckAndInsert\n\texecutor/insert_common.go:1153\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).CheckAndInsertOneBatch\n\texecutor/load_data.go:967\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitOneTask\n\texecutor/load_data.go:926\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).commitWork\n\texecutor/load_data.go:887\ngithub.com/pingcap/tidb/executor.(*LoadDataWorker).Load.func4\n\texecutor/load_data.go:770\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\texternal/org_golang_x_sync/errgroup/errgroup.go:75\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1598"]
    dbtestkit.go:71: 
        	Error Trace:	testkit/dbtestkit.go:71
        	            				server/server_test.go:524
        	            				server/server_test.go:151
        	            				server/server_test.go:516
        	            				server/tidb_serial_test.go:82
        	Error:      	Received unexpected error:
        	            	Error 1105 (HY000): runtime error: index out of range [0] with length 0
        	Test:       	TestLoadDataAutoRandom
        	Messages:   	sql:load data local infile "/tmp/load_data_txn_error.csv2635753952" into table t (c2, c3), args:[]
```