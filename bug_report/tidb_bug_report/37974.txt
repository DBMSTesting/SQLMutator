ID: 37974
Title: Some counterintuitive observation from TPCH Q17
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

I'm investigating https://github.com/pingcap/tidb/issues/37768 and found some counterintuitive things.

The dominant part of the plan for Q17 looks like this:

```
└─HashAgg_45(Probe)       | root      | time:2m2.9s, loops:9770, partial_worker:{wall_time:1m42.299928702s, concurrency:5, task_num:10802, tot
  └─TableReader_46        | root      | time:1.76s, loops:10803, cop_task: {num: 10803, max: 735.8ms, min: 1.51ms, avg: 53.1ms, p95: 108.5ms, 
    └─HashAgg_41          | cop[tikv] | tikv_task:{proc max:137ms, min:0s, avg: 40.8ms, p80:77ms, p95:87ms, iters:293178, tasks:10803}, scan_d
      └─TableFullScan_44  | cop[tikv] | tikv_task:{proc max:93ms, min:0s, avg: 25.7ms, p80:49ms, p95:57ms, iters:293178, tasks:10803}         
```

--- **The faster the TableReader, the slower the HashAgg !!!** ---


<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

The faster the TableReader, the faster whole query.

### 3. What did you see instead (Required)

enable paging = false

```
Olap_Detail_Log_ID: 2432747   Plan_Digest: 7847c375ff896b78c5d0c191811bc457 Elapsed_Time (s): 91.6 

+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| ID                            | ESTROWS      | ACTROWS   | TASK      | ACCESS OBJECT  | EXECUTION INFO                                                                                                                                                                                                                                                                                                                                                                                                      | OPERATOR INFO                                                                                                                                  | MEMORY   | DISK    |
+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| Projection_17                 | 1.00         | 1         | root      |                | time:1m31.6s, loops:2, Concurrency:OFF                                                                                                                                                                                                                                                                                                                                                                              | div(Column#46, 7.0)->Column#47                                                                                                                 | 1.40 KB  | N/A     |
| └─HashAgg_18                  | 1.00         | 1         | root      |                | time:1m31.6s, loops:2, partial_worker:{wall_time:1m31.562820899s, concurrency:5, task_num:30, tot_wait:7m37.809434978s, tot_exec:4.158178ms, tot_time:7m37.813651092s, max:1m31.562775007s, p95:1m31.562775007s}, final_worker:{wall_time:1m31.562837739s, concurrency:5, task_num:5, tot_wait:7m37.81392209s, tot_exec:48.772µs, tot_time:7m37.813976877s, max:1m31.562808777s, p95:1m31.562808777s}               | funcs:sum(test.lineitem.l_extendedprice)->Column#46                                                                                            | 568.2 KB | N/A     |
|   └─HashJoin_22               | 303299.52    | 26963     | root      |                | time:1m31.6s, loops:31, build_hash_table:{total:44.9s, fetch:44.7s, build:130.6ms}, probe:{concurrency:5, total:7m37.8s, max:1m31.6s, probe:2.39s, fetch:7m35.4s}                                                                                                                                                                                                                                                   | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)], other cond:lt(test.lineitem.l_quantity, mul(0.2, Column#44))             | 30.6 MB  | 0 Bytes |
|     ├─HashJoin_35(Build)      | 303299.52    | 299664    | root      |                | time:44.8s, loops:296, build_hash_table:{total:1.52s, fetch:1.51s, build:5.65ms}, probe:{concurrency:5, total:3m44.3s, max:44.9s, probe:1m6s, fetch:2m38.3s}                                                                                                                                                                                                                                                        | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)]                                                                           | 1.12 MB  | 0 Bytes |
|     │ ├─TableReader_40(Build) | 10074.98     | 9989      | root      |                | time:1.52s, loops:11, cop_task: {num: 17, max: 1.52s, min: 237ms, avg: 944.7ms, p95: 1.52s, max_proc_keys: 648191, p95_proc_keys: 648191, tot_proc: 15.6s, tot_wait: 266ms, rpc_num: 17, rpc_time: 16.1s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                               | data:Selection_39                                                                                                                              | 90.7 KB  | N/A     |
|     │ │ └─Selection_39        | 10074.98     | 9989      | cop[tikv] |                | tikv_task:{proc max:913ms, min:0s, p80:857ms, p95:913ms, iters:9838, tasks:17}, scan_detail: {total_process_keys: 10000000, total_process_keys_size: 1634215609, total_keys: 10000017, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000000, block: {cache_hit_count: 27083, read_count: 0, read_byte: 0 Bytes}}}                                                                                         | eq(test.part.p_brand, "Brand#44"), eq(test.part.p_container, "WRAP PKG")                                                                       | N/A      | N/A     |
|     │ │   └─TableFullScan_38  | 10000000.00  | 10000000  | cop[tikv] | table:part     | tikv_task:{proc max:816ms, min:0s, p80:772ms, p95:816ms, iters:9838, tasks:17}                                                                                                                                                                                                                                                                                                                                      | keep order:false                                                                                                                               | N/A      | N/A     |
|     │ └─TableReader_37(Probe) | 300005811.00 | 300005811 | root      |                | time:29.2s, loops:293178, cop_task: {num: 570, max: 3.22s, min: 128.2ms, avg: 1.12s, p95: 2.12s, max_proc_keys: 528339, p95_proc_keys: 528089, tot_proc: 7m38.5s, tot_wait: 14.7s, rpc_num: 570, rpc_time: 10m39.3s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                    | data:TableFullScan_36                                                                                                                          | 487.7 MB | N/A     |
|     │   └─TableFullScan_36    | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:864ms, min:0s, p80:660ms, p95:756ms, iters:295454, tasks:570}, scan_detail: {total_process_keys: 300005811, total_process_keys_size: 59595430182, total_keys: 300006381, rocksdb: {delete_skipped_count: 0, key_skipped_count: 300005811, block: {cache_hit_count: 974419, read_count: 0, read_byte: 0 Bytes}}}                                                                                 | keep order:false                                                                                                                               | N/A      | N/A     |
|     └─HashAgg_45(Probe)       | 9965568.00   | 10000000  | root      |                | time:1m31.5s, loops:9770, partial_worker:{wall_time:1m11.068166352s, concurrency:5, task_num:569, tot_wait:11.172136908s, tot_exec:5m29.848167534s, tot_time:5m54.428856092s, max:1m11.06810426s, p95:1m11.06810426s}, final_worker:{wall_time:1m31.562343749s, concurrency:5, task_num:25, tot_wait:5m53.464338434s, tot_exec:1m44.243609607s, tot_time:7m37.707970342s, max:1m31.562310817s, p95:1m31.562310817s} | group by:test.lineitem.l_partkey, funcs:avg(Column#50, Column#51)->Column#44, funcs:firstrow(test.lineitem.l_partkey)->test.lineitem.l_partkey | 12.0 GB  | N/A     |
|       └─TableReader_46        | 9965568.00   | 292259075 | root      |                | time:18.3s, loops:570, cop_task: {num: 570, max: 3.58s, min: 2.05ms, avg: 1.28s, p95: 2.41s, max_proc_keys: 528339, p95_proc_keys: 528089, tot_proc: 10m14.3s, tot_wait: 7.98s, rpc_num: 570, rpc_time: 12m11s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                         | data:HashAgg_41                                                                                                                                | 412.1 MB | N/A     |
|         └─HashAgg_41          | 9965568.00   | 292259075 | cop[tikv] |                | tikv_task:{proc max:1.37s, min:1ms, p80:1.07s, p95:1.21s, iters:293178, tasks:570}, scan_detail: {total_process_keys: 300005811, total_process_keys_size: 59595430182, total_keys: 300006381, rocksdb: {delete_skipped_count: 0, key_skipped_count: 300005811, block: {cache_hit_count: 974419, read_count: 0, read_byte: 0 Bytes}}}                                                                                | group by:test.lineitem.l_partkey, funcs:count(test.lineitem.l_quantity)->Column#50, funcs:sum(test.lineitem.l_quantity)->Column#51             | N/A      | N/A     |
|           └─TableFullScan_44  | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:839ms, min:1ms, p80:582ms, p95:685ms, iters:293178, tasks:570}                                                                                                                                                                                                                                                                                                                                  | keep order:false                                                                                                                               | N/A      | N/A     |
+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
```

paging min size 128, max size 8192

```
Baseline Execution Plans
Plan_Digest: 7847c375ff896b78c5d0c191811bc457 Elapsed_Time (s): 105.0 

+-------------------------------+--------------+-----------+-----------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| ID                            | ESTROWS      | ACTROWS   | TASK      | ACCESS OBJECT  | EXECUTION INFO                                                                                                                                                                                                                                                                                                                                                                                                     | OPERATOR INFO                                                                                                                                  | MEMORY   | DISK    |
+-------------------------------+--------------+-----------+-----------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| Projection_17                 | 1.00         | 1         | root      |                | time:1m45s, loops:2, Concurrency:OFF                                                                                                                                                                                                                                                                                                                                                                               | div(Column#46, 7.0)->Column#47                                                                                                                 | 1.40 KB  | N/A     |
| └─HashAgg_18                  | 1.00         | 1         | root      |                | time:1m45s, loops:2, partial_worker:{wall_time:1m45.014051221s, concurrency:5, task_num:29, tot_wait:8m45.065568108s, tot_exec:3.792953ms, tot_time:8m45.069445301s, max:1m45.013963154s, p95:1m45.013963154s}, final_worker:{wall_time:1m45.014093365s, concurrency:5, task_num:5, tot_wait:8m45.070125675s, tot_exec:48.104µs, tot_time:8m45.070186336s, max:1m45.014054972s, p95:1m45.014054972s}               | funcs:sum(test.lineitem.l_extendedprice)->Column#46                                                                                            | 568.2 KB | N/A     |
|   └─HashJoin_22               | 308799.82    | 26963     | root      |                | time:1m45s, loops:30, build_hash_table:{total:46.1s, fetch:46s, build:128.5ms}, probe:{concurrency:5, total:8m45.1s, max:1m45s, probe:3.08s, fetch:8m42s}                                                                                                                                                                                                                                                          | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)], other cond:lt(test.lineitem.l_quantity, mul(0.2, Column#44))             | 30.7 MB  | 0 Bytes |
|     ├─HashJoin_35(Build)      | 308799.82    | 299664    | root      |                | time:46.1s, loops:297, build_hash_table:{total:1.04s, fetch:1.02s, build:16.4ms}, probe:{concurrency:5, total:3m50.7s, max:46.1s, probe:3m1.3s, fetch:49.4s}                                                                                                                                                                                                                                                       | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)]                                                                           | 1.18 MB  | 0 Bytes |
|     │ ├─TableReader_40(Build) | 10257.69     | 9989      | root      |                | time:1.03s, loops:11, cop_task: {num: 64, max: 386.1ms, min: 975.3µs, avg: 186.9ms, p95: 335.9ms, max_proc_keys: 281568, p95_proc_keys: 266208, tot_proc: 11.8s, tot_wait: 42ms, rpc_num: 64, rpc_time: 12s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                                  | data:Selection_39                                                                                                                              | 35.5 KB  | N/A     |
|     │ │ └─Selection_39        | 10257.69     | 9989      | cop[tikv] |                | tikv_task:{proc max:384ms, min:0s, avg: 182.6ms, p80:264ms, p95:333ms, iters:10033, tasks:64}, scan_detail: {total_process_keys: 10000000, total_process_keys_size: 1634215609, total_keys: 10000064, rocksdb: {delete_skipped_count: 0, key_skipped_count: 10000000, block: {cache_hit_count: 27177, read_count: 0, read_byte: 0 Bytes}}}                                                                         | eq(test.part.p_brand, "Brand#44"), eq(test.part.p_container, "WRAP PKG")                                                                       | N/A      | N/A     |
|     │ │   └─TableFullScan_38  | 10000000.00  | 10000000  | cop[tikv] | table:part     | tikv_task:{proc max:330ms, min:0s, avg: 161.4ms, p80:233ms, p95:297ms, iters:10033, tasks:64}                                                                                                                                                                                                                                                                                                                      | keep order:false                                                                                                                               | N/A      | N/A     |
|     │ └─TableReader_37(Probe) | 300005811.00 | 300005811 | root      |                | time:8.7s, loops:295063, cop_task: {num: 36369, max: 424.7ms, min: 572.6µs, avg: 15.8ms, p95: 28.3ms, max_proc_keys: 9184, p95_proc_keys: 9184, tot_proc: 6m25s, tot_wait: 7.88s, rpc_num: 36369, rpc_time: 9m35.7s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                          | data:TableFullScan_36                                                                                                                          | 448.8 MB | N/A     |
|     │   └─TableFullScan_36    | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:28ms, min:0s, avg: 8.38ms, p80:11ms, p95:14ms, iters:437512, tasks:36369}, scan_detail: {total_process_keys: 300005811, total_process_keys_size: 59595430182, total_keys: 300042180, rocksdb: {delete_skipped_count: 0, key_skipped_count: 300005811, block: {cache_hit_count: 1046128, read_count: 0, read_byte: 0 Bytes}}}                                                                   | keep order:false                                                                                                                               | N/A      | N/A     |
|     └─HashAgg_45(Probe)       | 9965568.00   | 10000000  | root      |                | time:1m45s, loops:9770, partial_worker:{wall_time:1m25.779541955s, concurrency:5, task_num:36297, tot_wait:387.856003ms, tot_exec:6m44.241576284s, tot_time:7m8.553442915s, max:1m25.779467129s, p95:1m25.779467129s}, final_worker:{wall_time:1m45.013415348s, concurrency:5, task_num:25, tot_wait:7m8.273279804s, tot_exec:1m36.436308955s, tot_time:8m44.709613464s, max:1m45.013291372s, p95:1m45.013291372s} | group by:test.lineitem.l_partkey, funcs:avg(Column#50, Column#51)->Column#44, funcs:firstrow(test.lineitem.l_partkey)->test.lineitem.l_partkey | 11.9 GB  | N/A     |
|       └─TableReader_46        | 9965568.00   | 299871362 | root      |                | time:1.25s, loops:36298, cop_task: {num: 36298, max: 447.1ms, min: 1.1ms, avg: 15.6ms, p95: 24.9ms, max_proc_keys: 9216, p95_proc_keys: 9216, tot_proc: 7m17.4s, tot_wait: 7.38s, rpc_num: 36298, rpc_time: 9m25s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                            | data:HashAgg_41                                                                                                                                | 352.9 MB | N/A     |
|         └─HashAgg_41          | 9965568.00   | 299871362 | cop[tikv] |                | tikv_task:{proc max:35ms, min:0s, avg: 11.4ms, p80:15ms, p95:19ms, iters:293178, tasks:36298}, scan_detail: {total_process_keys: 300005811, total_process_keys_size: 59595430182, total_keys: 300042109, rocksdb: {delete_skipped_count: 0, key_skipped_count: 300005811, block: {cache_hit_count: 1045972, read_count: 0, read_byte: 0 Bytes}}}                                                                   | group by:test.lineitem.l_partkey, funcs:count(test.lineitem.l_quantity)->Column#50, funcs:sum(test.lineitem.l_quantity)->Column#51             | N/A      | N/A     |
|           └─TableFullScan_44  | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:25ms, min:0s, avg: 7.47ms, p80:10ms, p95:13ms, iters:293178, tasks:36298}                                                                                                                                                                                                                                                                                                                      | keep order:false                                                                                                                               | N/A      | N/A     |
+-------------------------------+--------------+-----------+-----------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
```

paging min size 128, max size 50000

```
Olap_Detail_Log_ID: 3008024   Plan_Digest: 7847c375ff896b78c5d0c191811bc457 Elapsed_Time (s): 122.9 

+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| ID                            | ESTROWS      | ACTROWS   | TASK      | ACCESS OBJECT  | EXECUTION INFO                                                                                                                                                                                                                                                                                                                                                                                                      | OPERATOR INFO                                                                                                                                  | MEMORY   | DISK    |
+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| Projection_17                 | 1.00         | 1         | root      |                | time:2m2.9s, loops:2, Concurrency:OFF                                                                                                                                                                                                                                                                                                                                                                               | div(Column#46, 7.0)->Column#47                                                                                                                 | 1.40 KB  | N/A     |
| └─HashAgg_18                  | 1.00         | 1         | root      |                | time:2m2.9s, loops:2, partial_worker:{wall_time:2m2.892358329s, concurrency:5, task_num:30, tot_wait:10m14.457667369s, tot_exec:3.457452ms, tot_time:10m14.461189249s, max:2m2.892277144s, p95:2m2.892277144s}, final_worker:{wall_time:2m2.89241355s, concurrency:5, task_num:5, tot_wait:10m14.461684469s, tot_exec:77.267µs, tot_time:10m14.461767013s, max:2m2.892382046s, p95:2m2.892382046s}                  | funcs:sum(test.lineitem.l_extendedprice)->Column#46                                                                                            | 568.2 KB | N/A     |
|   └─HashJoin_22               | 300240.88    | 26963     | root      |                | time:2m2.9s, loops:31, build_hash_table:{total:45s, fetch:44.9s, build:142.9ms}, probe:{concurrency:5, total:10m14.5s, max:2m2.9s, probe:2.59s, fetch:10m11.9s}                                                                                                                                                                                                                                                     | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)], other cond:lt(test.lineitem.l_quantity, mul(0.2, Column#44))             | 30.7 MB  | 0 Bytes |
|     ├─HashJoin_35(Build)      | 300240.88    | 299664    | root      |                | time:45s, loops:297, build_hash_table:{total:828.8ms, fetch:823.3ms, build:5.49ms}, probe:{concurrency:5, total:3m45.2s, max:45s, probe:2m12.3s, fetch:1m32.9s}                                                                                                                                                                                                                                                     | inner join, equal:[eq(test.part.p_partkey, test.lineitem.l_partkey)]                                                                           | 1.12 MB  | 0 Bytes |
|     │ ├─TableReader_40(Build) | 9973.38      | 9989      | root      |                | time:828ms, loops:11, cop_task: {num: 48, max: 289.7ms, min: 672.1µs, avg: 209.8ms, p95: 286.4ms, max_proc_keys: 285207, p95_proc_keys: 278079, tot_proc: 9.94s, rpc_num: 48, rpc_time: 10.1s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                                                 | data:Selection_39                                                                                                                              | 54.2 KB  | N/A     |
|     │ │ └─Selection_39        | 9973.38      | 9989      | cop[tikv] |                | tikv_task:{proc max:286ms, min:0s, avg: 206.9ms, p80:258ms, p95:274ms, iters:9968, tasks:48}, scan_detail: {total_process_keys: 10000000, total_process_keys_size: 1634215609, total_keys: 10000048, get_snapshot_time: 904.4µs, rocksdb: {key_skipped_count: 10000000, block: {cache_hit_count: 27145}}}                                                                                                           | eq(test.part.p_brand, "Brand#44"), eq(test.part.p_container, "WRAP PKG")                                                                       | N/A      | N/A     |
|     │ │   └─TableFullScan_38  | 10000000.00  | 10000000  | cop[tikv] | table:part     | tikv_task:{proc max:257ms, min:0s, avg: 182.2ms, p80:221ms, p95:243ms, iters:9968, tasks:48}                                                                                                                                                                                                                                                                                                                        | keep order:false                                                                                                                               | N/A      | N/A     |
|     │ └─TableReader_37(Probe) | 300005811.00 | 300005811 | root      |                | time:16.5s, loops:293926, cop_task: {num: 10803, max: 768.8ms, min: 643.6µs, avg: 52ms, p95: 119.5ms, max_proc_keys: 50144, p95_proc_keys: 50144, tot_proc: 5m43.9s, tot_wait: 63ms, rpc_num: 10803, rpc_time: 9m21.8s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                        | data:TableFullScan_36                                                                                                                          | 46.8 MB  | N/A     |
|     │   └─TableFullScan_36    | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:96ms, min:0s, avg: 26.3ms, p80:47ms, p95:62ms, iters:335817, tasks:10803}, scan_detail: {total_process_keys: 299951104, total_process_keys_size: 59584561134, total_keys: 299961905, get_snapshot_time: 560.2ms, rocksdb: {key_skipped_count: 299951104, block: {cache_hit_count: 994733}}}                                                                                                     | keep order:false                                                                                                                               | N/A      | N/A     |
|     └─HashAgg_45(Probe)       | 9965568.00   | 10000000  | root      |                | time:2m2.9s, loops:9770, partial_worker:{wall_time:1m42.299928702s, concurrency:5, task_num:10802, tot_wait:923.400134ms, tot_exec:8m16.000624309s, tot_time:8m30.777101865s, max:1m42.299877284s, p95:1m42.299877284s}, final_worker:{wall_time:2m2.891836041s, concurrency:5, task_num:25, tot_wait:8m30.219229843s, tot_exec:1m43.837599101s, tot_time:10m14.056853046s, max:2m2.891802925s, p95:2m2.891802925s} | group by:test.lineitem.l_partkey, funcs:avg(Column#50, Column#51)->Column#44, funcs:firstrow(test.lineitem.l_partkey)->test.lineitem.l_partkey | 11.9 GB  | N/A     |
|       └─TableReader_46        | 9965568.00   | 299320645 | root      |                | time:1.76s, loops:10803, cop_task: {num: 10803, max: 735.8ms, min: 1.51ms, avg: 53.1ms, p95: 108.5ms, max_proc_keys: 50176, p95_proc_keys: 50176, tot_proc: 7m37.6s, tot_wait: 58ms, rpc_num: 10803, rpc_time: 9m33.6s, copr_cache_hit_ratio: 0.00, distsql_concurrency: 15}                                                                                                                                        | data:HashAgg_41                                                                                                                                | 42.8 MB  | N/A     |
|         └─HashAgg_41          | 9965568.00   | 299320645 | cop[tikv] |                | tikv_task:{proc max:137ms, min:0s, avg: 40.8ms, p80:77ms, p95:87ms, iters:293178, tasks:10803}, scan_detail: {total_process_keys: 300005811, total_process_keys_size: 59595430182, total_keys: 300016614, get_snapshot_time: 539.5ms, rocksdb: {key_skipped_count: 300005811, block: {cache_hit_count: 994911}}}                                                                                                    | group by:test.lineitem.l_partkey, funcs:count(test.lineitem.l_quantity)->Column#50, funcs:sum(test.lineitem.l_quantity)->Column#51             | N/A      | N/A     |
|           └─TableFullScan_44  | 300005811.00 | 300005811 | cop[tikv] | table:lineitem | tikv_task:{proc max:93ms, min:0s, avg: 25.7ms, p80:49ms, p95:57ms, iters:293178, tasks:10803}                                                                                                                                                                                                                                                                                                                       | keep order:false                                                                                                                               | N/A      | N/A     |
+-------------------------------+--------------+-----------+-----------+----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
```

After using paging, as you can see, the `TableReader_46` is generally faster, but why `HashAgg_45` become slower?

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

master b5ed6740df266b909fcae78df782fce41bd29808