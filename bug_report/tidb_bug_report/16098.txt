ID: 16098
Title: planner: Internal : Can't find a proper physical plan for this query
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. What did you do?

[randgen_agg.txt](https://github.com/pingcap/tidb/files/4441892/randgen_agg.txt)
```
download randgen_agg.txt
source  randgen_agg.txt
```

````
SELECT /*+ stream_agg() */ DISTINCT STRAIGHT_JOIN count(1) as field1 FROM  R AS table1  LEFT  JOIN S AS table2 ON  table1 . `col_varchar_1024_latin1_key` =  table2 . `col_varchar_10_utf8`  WHERE table1 . `col_int_key` >= 4  HAVING (((((field1 >= 3 OR field1 <> 5) AND field1 < 7) OR field1 <> 2) AND field1 > 7) AND field1 = 5)  ;

SELECT /*+ stream_agg() */ DISTINCT  count(1) as field1 FROM  N AS table1  LEFT  JOIN K AS table2 ON  table1 . `col_varchar_1024_utf8` =  table2 . `col_varchar_10_utf8_key`  WHERE table1 . `col_int_key` != 9  HAVING (field1 != 3 AND field1 = 3)  ;

SELECT /*+ stream_agg() */ DISTINCT  count(1) as field1 FROM  M AS table1  LEFT  JOIN F AS table2 ON  table1 . `col_int_key` =  table2 . `pk`  WHERE table1 . `col_int_key` IS  NULL  HAVING (field1 < 1 AND field1 = 8) ORDER BY field1  LIMIT 10 ;

SELECT /*+ stream_agg() */ DISTINCT  count(1) as field1, count(1) as field2 FROM  Z AS table1  LEFT  JOIN B AS table2 ON  table1 . `pk` =  table2 . `pk`  WHERE table1 . `col_int_key` >= table2 . `pk`  HAVING (field1 = 3 AND field1 = 6) ORDER BY field1, field2   ;

SELECT /*+ stream_agg() */ DISTINCT  count(*) as field1 FROM   R AS table1  LEFT  JOIN E AS table2 ON  table1 . `col_int_key` =  table2 . `col_int_key`   LEFT  JOIN  M AS table3  LEFT  JOIN M AS table4 ON  table3 . `col_varchar_10_latin1` =  table4 . `col_varchar_1024_utf8_key`  ON  table2 . `col_varchar_1024_utf8_key` =  table3 . `col_varchar_10_utf8_key`  WHERE table2 . `col_int_key` IS  NULL  HAVING ((field1 = 4 OR field1 = 3) AND field1 = 9) ORDER BY field1  , field1  ;

SELECT /*+ stream_agg() */ DISTINCT  MAX(  table1 . `pk` ) AS field1 FROM  J AS table1  LEFT  JOIN P AS table2 ON  table1 . `col_varchar_10_latin1_key` =  table2 . `col_varchar_10_utf8_key`  WHERE table2 . `pk` <= 3  HAVING (((field1 != 7 AND field1 >= 2) AND field1 < 2) AND field1 = 5) ORDER BY field1 DESC , field1 DESC , field1  ;

SELECT /*+ stream_agg() */ DISTINCT  count(1) as field1 FROM  R AS table1  LEFT  JOIN Q AS table2 ON  table1 . `col_varchar_10_utf8_key` =  table2 . `col_varchar_1024_latin1_key`  WHERE table2 . `col_int`  BETWEEN 6 AND ( 6 + 2 )  HAVING (field1 >= 8 AND field1 = 7)  ;

SELECT /*+ stream_agg() */ DISTINCT STRAIGHT_JOIN MAX( DISTINCT table1 . `col_int` ) AS field1 FROM    CC AS table1  RIGHT  JOIN Z AS table2 ON  table1 . `col_int` =  table2 . `pk`   LEFT  JOIN J AS table3 ON  table1 . `col_varchar_10_latin1_key` =  table3 . `col_varchar_1024_latin1_key`   LEFT  JOIN U AS table4 ON  table3 . `col_varchar_10_latin1_key` =  table4 . `col_varchar_1024_latin1_key`  WHERE table4 . `pk` IS  NULL  HAVING ((field1 < 1 AND field1 = 3) AND field1 = 1) ORDER BY field1  , field1  , field1  , field1 DESC , field1 DESC , field1  ;

SELECT /*+ stream_agg() */ DISTINCT  AVG(  table2 . `col_int_key` ) AS field1 FROM  K AS table1  LEFT OUTER JOIN G AS table2 ON  table1 . `col_varchar_10_latin1` =  table2 . `col_varchar_1024_latin1_key`  WHERE ( table1 . `col_int_key` IS  NULL OR table2 . `col_int_key`  IN (3, 2, 4, 7, 7) )  HAVING (field1 = 6 AND field1 = 5)  ;

```


### 2. What did you expect to see?

### 3. What did you see instead?
```
ERROR 1815 (HY000): Internal : Can't find a proper physical plan for this query

```
### 4. What version of TiDB are you using? (`tidb-server -V` or run `select tidb_version();` on TiDB)
5.7.25-TiDB-v4.0.0-beta-607-ga3ec712d3