ID: 43396
Title: DATA RACE oomCapture.ClearMessageFilter
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
==================

WARNING: DATA RACE

Write at 0x00c0011d37d0 by goroutine 111:

  runtime.mapdelete_faststr()

      GOROOT/src/runtime/map_faststr.go:301 +0x0

  golang.org/x/exp/maps.Clear[...]()

      external/org_golang_x_exp/maps/maps.go:59 +0x1fa

  github.com/pingcap/tidb/util/set.StringSet.Clear()

      util/set/string_set.go:65 +0x153

  executor/oomtest/oomtest_test.(*oomCapture).ClearMessageFilter()

      executor/oomtest/oom_test.go:233 +0x11d

  executor/oomtest/oomtest_test.TestMemTracker4InsertAndReplaceExec()

      executor/oomtest/oom_test.go:134 +0x9dc

  github.com/pingcap/tidb/domain.(*Domain).LoadSysVarCacheLoop()

      domain/domain.go:1586 +0xb9

  github.com/pingcap/tidb/session.BootstrapSession()

      session/session.go:3326 +0x7cc

  github.com/pingcap/tidb/domain.(*Domain).GetSessionCache()

      domain/sysvar_cache.go:62 +0x71

  github.com/pingcap/tidb/session.(*session).loadCommonGlobalVariablesIfNeeded()

      session/session.go:3673 +0x11e

  github.com/pingcap/tidb/session.(*session).ExecuteStmt()

      session/session.go:2089 +0x16b

  github.com/pingcap/tidb/session.(*session).ExecuteInternal()

      session/session.go:1627 +0x365

  github.com/pingcap/tidb/domain.(*Domain).LoadPrivilegeLoop()

      domain/domain.go:1530 +0x143

  github.com/pingcap/tidb/session.BootstrapSession()

      session/session.go:3319 +0x76c

  github.com/pingcap/tidb/testkit.bootstrap()

      testkit/mockstore.go:85 +0x84

  github.com/pingcap/tidb/testkit.CreateMockStoreAndDomain()

      testkit/mockstore.go:70 +0xd0

  github.com/pingcap/tidb/testkit.CreateMockStore()

      testkit/mockstore.go:62 +0x3b2

  executor/oomtest/oomtest_test.TestMemTracker4InsertAndReplaceExec()

      executor/oomtest/oom_test.go:71 +0x4f

  testing.tRunner()

      GOROOT/src/testing/testing.go:1576 +0x216

  testing.(*T).Run.func1()

      GOROOT/src/testing/testing.go:1629 +0x47


Previous read at 0x00c0011d37d0 by goroutine 46028:

  runtime.mapaccess2_faststr()

      GOROOT/src/runtime/map_faststr.go:108 +0x0

  github.com/pingcap/tidb/util/set.StringSet.Exist()

      util/set/string_set.go:33 +0x144

  executor/oomtest/oomtest_test.(*oomCapture).Write()

      executor/oomtest/oom_test.go:266 +0x77

  go.uber.org/zap/zapcore.(*CheckedEntry).Write()

      external/org_uber_go_zap/zapcore/entry.go:255 +0x2ce

  go.uber.org/zap.(*Logger).Info()

      external/org_uber_go_zap/logger.go:220 +0x6a

  github.com/pingcap/tidb/disttask/framework/dispatcher.(*dispatcher).DispatchTaskLoop()

      disttask/framework/dispatcher/dispatcher.go:140 +0x6b

  github.com/pingcap/tidb/disttask/framework/dispatcher.(*dispatcher).DispatchTaskLoop-fm()

      <autogenerated>:1 +0x39

  github.com/pingcap/tidb/util.(*WaitGroupWrapper).Run.func1()

      util/wait_group_wrapper.go:154 +0x87


Goroutine 111 (running) created at:

  testing.(*T).Run()

      GOROOT/src/testing/testing.go:1629 +0x805

  testing.runTests.func1()

      GOROOT/src/testing/testing.go:2036 +0x8d

  testing.tRunner()

      GOROOT/src/testing/testing.go:1576 +0x216

  testing.runTests()

      GOROOT/src/testing/testing.go:2034 +0x87c

  testing.(*M).Run()

      GOROOT/src/testing/testing.go:1906 +0xb44

  go.uber.org/goleak.VerifyTestMain()

      external/org_uber_go_goleak/testmain.go:53 +0x70

  executor/oomtest/oomtest_test.TestMain()

      executor/oomtest/oom_test.go:44 +0x326

  main.main()

      bazel-out/k8-fastbuild/bin/executor/oomtest/oomtest_test_/testmain.go:122 +0x7ce


Goroutine 46028 (running) created at:

  github.com/pingcap/tidb/util.(*WaitGroupWrapper).Run()

      util/wait_group_wrapper.go:152 +0xf6

  github.com/pingcap/tidb/disttask/framework/dispatcher.(*dispatcher).Start()

      disttask/framework/dispatcher/dispatcher.go:127 +0xae

  github.com/pingcap/tidb/domain.(*Domain).distTaskFrameworkLoop.func2()

      domain/domain.go:1404 +0x2aa

  github.com/pingcap/tidb/domain.(*Domain).distTaskFrameworkLoop()

      domain/domain.go:1424 +0x316

  github.com/pingcap/tidb/domain.(*Domain).InitDistTaskLoop.func1()

      domain/domain.go:1378 +0xcb

  github.com/pingcap/tidb/util.(*WaitGroupEnhancedWrapper).Run.func1()

      util/wait_group_wrapper.go:96 +0xde

==================

```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

