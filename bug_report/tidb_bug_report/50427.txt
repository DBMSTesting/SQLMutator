ID: 50427
Title: incorrect partition location using between
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
``` SQL
CREATE TABLE `tlf78bb21c` (
  `col_1` blob DEFAULT NULL,
  `col_2` varchar(177) DEFAULT 'gIm@W8Q#h',
  `col_3` mediumint(9) DEFAULT '0',
  `col_4` text NOT NULL,
  `col_5` time NOT NULL DEFAULT '21:28:35',
  `col_6` int(10) unsigned NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin
PARTITION BY HASH (`col_3`) PARTITIONS 4;

INSERT INTO `tlf78bb21c` VALUES(x'7130493826794972','P8kWmC5A#X63u',5278943,'wo!6dGo~I6vjNmsR','21:51:59',521379067),(x'457032254b7a7e675234573033','Z6_QFh+o1CLWl~*-r',1295190,'tncVlwmHsu','21:51:59',521379067),(x'315a65533d61','~',-7088500,'*PPo!Yd!SPGBsKe_W8','21:51:59',521379067),(x'3d6e2d4131234f3654','H',3275136,'iFmtwtyw*MmJ-o0qh)V','21:51:59',521379067),(x'53','K0Fzny8j',-2566663,'0!@c$a','21:51:59',521379067),(x'293737','zGbX*zce',-8385459,'Umk^xSh^T*o#KZGT)x','21:51:59',4062527422),(x'4f682b4923','sp7vh83L',-7838865,'f~M@','21:51:59',2814750665),(NULL,'_KZBlk48qJJ1=0=7Q!',-4968589,'SyxeO8l4gCfqGkU&+Z','21:51:59',1858686646),(x'6a6e6f6c5a50473463625f','bue-JB0',1692253,'8','21:51:59',1487864801),(x'426a476766573d6f','@m=XUmTaOH',8148200,'QE%d(l$ioIUs$EMsAB@','21:51:59',2938973757),(x'70304c6937','p',4575633,'m_hs_Ejl7%2d=K','21:51:59',857261852),(x'312a4e446772625276515f','&2cifu^l1-',-3700993,'&dDeBHeb7','21:51:59',4147462898),(x'377832286c2d4a4b6959622845475e5149','Ho9-9&SXg42E4IYY!',-1621934,'mPB','21:51:59',3624081906),(x'684d6669524840386269426c5a','L2a$i8c',-2901515,'%','21:51:59',765675232),(x'324736674a5221754b54','1(tpPu#zXJ*)JtGKCm',7736110,'L@LCAx','21:51:59',2147483648),(x'3145527a695a51524d6e74','Sb',-6127100,'@K!Y+BT6x%(F','21:51:59',846916996),(x'344f2535394d4846627e6d437854442d6d','!',1839354,'QxJkRu%v2h70oeP','21:51:59',3059065201),(x'4465292d533624506e323734515055','v7v',-2800306,'qGwCqRWB','21:51:59',1851791672),(x'4a6e636368587350','EXO!G',6439741,'V=OX1','21:51:59',3127499537),(x'4966792d','*8fGP%A9yxWx',4820469,'O','21:51:59',4228543276),(x'426638542d466579515a747240','^kh=f_!^Q~KWtFm',1,'@IOMC!jnhNxsl','21:51:59',3934890179),(x'7959234262373d263674346741217e40516c','GPEYfZ',-5834842,'OA8tEJDrd^2x4p','21:51:59',1056411881),(NULL,'T',-1769065,'RPaC%kFFqpA','21:51:59',2055082168),(x'','6jCuz2CWPWXj)',0,'=','21:51:59',1266978035),(x'433424346d5069297157574b','cM_rM$~-Pw~w',8388607,'~!zBQ@+5Q^PC','21:51:59',2956730831),(x'356b5740','l2moTMmSp&YETEl',-3890881,'kKq1wTwvN','21:51:59',1493891374),(x'4d37216130324c4024296d754537364c7276','xY',2,'qNQKK0@JQK','21:51:59',3951955298),(x'4b2849','qCq7e*',5199709,'=j#!4m#','21:51:59',1491621231),(x'4a2b332d42','esnDci+(a@RF-8',2,'PDA7G@UfUVG*F(^uvq','21:51:59',347741083),(x'2b287366','ts=y3v^3@+oC7+W',-1080691,'gAmVzb','21:51:59',150193619),(x'564f755748587e312437776b41667031','#4a!!B5pK(wvpSv3',-3441593,'SN9N','21:51:59',2147483648),(x'70575f4e4c4b2a48376e5e34325a5f68664e78','SZL@_K&-e!09oP',-8388607,'rT8lu3F897UwDY~Vd','21:51:59',3311501016),(x'','lRP=1CW!MsrlR=Bl',2554999,'!Yt(1KT1#2rD7gltiZ%','21:51:59',3596346038),(x'7a7655','d8n*UuW',-3260400,'ufQ0Fi@z=_g%)','21:51:59',2510844337),(x'4c454747537671345173','hP@uKQk)DHi',-1,'iJ4A$edq','21:51:59',4206266610),(x'6f21','c~b^qy2b_9%4)4lBp!',-5156403,'QEht(7$OqY@_m','21:51:59',78767719),(x'4172','3(ukr~NPLiK',1,'qziOndOnJ3Ri','21:51:59',1339541919),(x'763d71','U$TjajEg',1904463,'OuWMCJLf7L','20:20:02',2642345285),(x'2551612a486b6d4a5141','8',4724676,'%qJiP)9rQXzb','08:02:59',3987004466),(x'7a54305578744b2a3067','%cy2CYD^9vY-Hu',-4804925,'LBY!NM1z','14:50:27',1403812858),(x'6e52494069','wI3wls*',8388607,')93C%SPlz','16:19:39',3483267086),(x'6f734a765837497537452478','kLged',2127584,'oxYNlJO','16:46:36',4189962929),(x'59486e32667a4d33264926582a444d7a58','aOVtf=c18zC8(ry5',-839393,'&nX=)4!5iTiq@(Om','02:35:34',2305757307),(x'23564b51576d697e58336537384e21','W@-IjSEju++TX)NVRvD',-2536967,'9RL$','01:52:20',956138488),(x'246147716a6e5e333772433d63347e5a633975','p+',0,'yxvjma-Z','10:45:46',2856747746),(x'395249755e4e726a236956652429','^r',866531,'V)$','23:48:11',1553045715),(x'706276392d254368','%89d@4xKe&fN%CN',2330084,'Mpma','20:36:41',1708581632),(x'424626754d2b216f7072464e2d346f','o@bA+W1Ii+YLWRHfX-G',-619181,'Wbha9$l','16:26:52',3395284123),(x'4e5172402423715553414d266d2623','1B8f=q',6345862,'R+H-#s84b5^TMw','05:03:31',2408897185),(x'5f6a7e3454','Q$Q#oqD~4m',-4999189,'5V^3hI','07:33:29',1998591662),(x'553230413d444f51445e504a3665','Bhaq^YQZq$eapFLnpEj',1937678,'dRgK@A-9mjJL','08:13:53',1479197090),(x'266e735462254552706c34375f','kNzEg',-4577398,'5VWxLd_KE=','16:32:45',1129941752),(x'44372137672a52654d77664234644b','wBuJZnwWSC(@UvF',NULL,'~1F','02:00:37',2252496761),(x'4941356b4d','Uk!!',573622,'IOP#0(MJ7','15:29:00',1559443624),(x'6546485979504f6a592525652b51','k$eJmg9v^oA',2450009,')C*Doarzdg9hK*Ybc','02:55:11',2685673565),(x'305055764846585e51','Gu)p+*',4095315,'Liy^2Ed@-_Gb_I$S','15:47:14',3790187391),(x'664d','f6jRsqrUwutYVlxF',4493435,'ZrCs)8x5hjSCChqAq','16:04:13',2412677259),(x'6d71574868424229','vmc@PFy+wjI',-8203406,'(2FIo4$2*lVnZJ#','20:56:14',4098158222),(x'4642302b395940796c4571733543252869','PPcmP',1,'VMv2@+fxG#eqsUm73A','19:24:42',489412757),(x'705f4f48764b4a36','L6Vl',2767412,'zve7knd','15:21:26',2),(x'','*kz3KC',1,'KaGMit%$GcXOyQ','13:52:22',2249792424),(x'6c70745f5e6d5475536b4d','uhFP93svwQSva&',-4139102,'sLsOT=wPp)9sk','23:26:26',1311687857),(x'52795372377e4e44','jnZE!',5375175,'PHV48hl','23:47:25',1850945430),(x'57444165736147634b565e','O',2,'GFRNbVcQ8Gtx2jUvhc','18:53:33',1650777423),(x'41692469533d28416469342341644f47','KaSGOWBM5!gSN',5828527,'IHSvK','12:43:57',915783665),(x'2a','VzlOz~Xy+0c7V-@HC',7301751,'~k3sQAs=f0C#','02:46:07',2632151829),(x'3773365a6f74375e7e70504d38413424','sduuqvaVEAG%oCuc&',-7746002,'4!V+=Le@OoEhrM','15:37:06',2706181651),(x'674e4f67547931464374212d5f4e357763','I&nyKYYC',3471912,'ld8vF-_tKpto','15:41:23',3291340233),(x'426f24684b3d2b295563542b58524c76','Q1ere#o*2VXAx',4381912,'QB2K(1SDMIsc-3nWM3Z','08:58:06',372243754),(x'474a792a4c6f686676','WMh9AVq5lF4k17#0',5631010,'Fm)3l6yD','12:36:12',673445421),(x'6a292830','Ai9v2dd7Z',5036825,'BvZs_^1r7DksT8','13:05:04',3041473189),(x'4b665666256a7250','ol$s+*bLQJVb!Vw%wb',5860914,'-HEgp*d2LPkz(E3','06:01:17',4179262767),(x'6c4721496f21','vX)&fz$n7Q',-2980637,'$K3p8StnTHH+zz','04:39:00',1492363708),(x'7a4e444b2d31706b534772','Ql',4458080,'+E$h!f$hU+x8)9PL@_','07:32:39',0),(x'40494b68263125717a4b','Iqs_kbO&snRDxgQ~p',677220,'M0R_','15:07:57',2768348704),(NULL,'w3*F+',1899018,'TfCuha8K7HKYbCVM5A','01:57:40',3059352813),(x'4779423979436d2148776b7e656f','Ql@Bqlo8(wOHOGx*',-3725311,'','16:15:01',3137792343),(x'6a4050495e4d33474664634447','4HNCD',-6183061,'l+6Zt=','21:00:51',2606277777),(x'7532573858724652784241644d35','Kyu^',3532264,'8','05:51:24',2),(x'716c63764f51755f2d6d4e764c4d','k+tc',6411613,'XhCcN','09:25:53',3123241813),(x'2350292b476637646770','a~zssjzrq_^2X',-5448064,'#ffyPD7#@eGT','08:16:36',1822847340),(x'4335764c476c73','P@8cf6iSW(G5',258450,'zL^r6ZiM5thJ%FLh-','14:50:26',1966824931),(x'','6cNzv&yGL',6824340,'fi3Gag','10:05:08',3005554923),(x'21316b684449376f306d333842483424','PSbiEz~kT',NULL,'KcI*)#i~gtAD6(O+q','09:20:40',2147483648),(x'53','&mD89ia#MKJlX_VV(X',-5435587,'grxAt_dm^@Hq3','07:22:19',1807572849);

desc SELECT 1 FROM `tlf78bb21c` WHERE `tlf78bb21c`.`col_3` BETWEEN -8388608 AND -8388607;
```

### 2. What did you expect to see? (Required)


Using partition p3.

### 3. What did you see instead (Required)

``` sql
mysql> desc SELECT 1 FROM `tlf78bb21c` WHERE `tlf78bb21c`.`col_3` BETWEEN -8388608 AND -8388607;
+--------------------------------+---------+-----------+--------------------------------+--------------------------------------------------------------------------+
| id                             | estRows | task      | access object                  | operator info                                                            |
+--------------------------------+---------+-----------+--------------------------------+--------------------------------------------------------------------------+
| Projection_8                   | 1.12    | root      |                                | 1->Column#8                                                              |
| └─PartitionUnion_9             | 1.12    | root      |                                |                                                                          |
|   ├─TableReader_12             | 0.50    | root      |                                | data:Selection_11                                                        |
|   │ └─Selection_11             | 0.50    | cop[tikv] |                                | ge(test.tlf78bb21c.col_3, -8388608), le(test.tlf78bb21c.col_3, -8388607) |
|   │   └─TableFullScan_10       | 20.00   | cop[tikv] | table:tlf78bb21c, partition:p0 | keep order:false, stats:pseudo                                           |
|   └─TableReader_15             | 0.62    | root      |                                | data:Selection_14                                                        |
|     └─Selection_14             | 0.62    | cop[tikv] |                                | ge(test.tlf78bb21c.col_3, -8388608), le(test.tlf78bb21c.col_3, -8388607) |
|       └─TableFullScan_13       | 25.00   | cop[tikv] | table:tlf78bb21c, partition:p1 | keep order:false, stats:pseudo                                           |
+--------------------------------+---------+-----------+--------------------------------+--------------------------------------------------------------------------+
8 rows in set, 1 warning (0.00 sec)

mysql> desc SELECT 1 FROM `tlf78bb21c` where col_3 = -8388607;
+---------------------------+---------+-----------+--------------------------------+-------------------------------------+
| id                        | estRows | task      | access object                  | operator info                       |
+---------------------------+---------+-----------+--------------------------------+-------------------------------------+
| Projection_6              | 0.02    | root      |                                | 1->Column#8                         |
| └─TableReader_9           | 0.02    | root      |                                | data:Selection_8                    |
|   └─Selection_8           | 0.02    | cop[tikv] |                                | eq(test.tlf78bb21c.col_3, -8388607) |
|     └─TableFullScan_7     | 20.00   | cop[tikv] | table:tlf78bb21c, partition:p3 | keep order:false, stats:pseudo      |
+---------------------------+---------+-----------+--------------------------------+-------------------------------------+
4 rows in set, 1 warning (0.00 sec)
```

### 4. What is your TiDB version? (Required)
d0c81e1f2affba08effda0d783e3bb7330b846d0
<!-- Paste the output of SELECT tidb_version() -->

