ID: 49859
Title: Performance jitter in 11D statements of Join Order Benchmark
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
1. deploy cluster with 1 tidb +3 tikv
2. run join order benchmark - 11D
```
SELECT
	MIN(cn.name) AS from_company,
	MIN(mc.note) AS production_note,
	MIN(t.title) AS movie_based_on_book
FROM
	company_name AS cn,
	company_type AS ct,
	keyword AS k,
	link_type AS lt,
	movie_companies AS mc,
	movie_keyword AS mk,
	movie_link AS ml,
	title AS t
WHERE
	cn.country_code != '[pl]'
	AND ct.kind != 'production companies'
	and ct.kind is not NULL
	AND k.keyword in ('sequel', 'revenge', 'based-on-novel')
	AND mc.note is not NULL
	AND t.production_year > 1950
	AND lt.id = ml.link_type_id
	AND ml.movie_id = t.id
	AND t.id = mk.movie_id
	AND mk.keyword_id = k.id
	AND t.id = mc.movie_id
	AND mc.company_type_id = ct.id
	AND mc.company_id = cn.id
	AND ml.movie_id = mk.movie_id
	AND ml.movie_id = mc.movie_id
	AND mk.movie_id = mc.movie_id;

```
### 2. What did you expect to see? (Required)

```
Baseline Execution Plans
Plan_Digest: 6df5d21ab577975303577b1283c20ef0 Elapsed_Time (s): 162.3 

+------------------------------------------+------------+------------+-----------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+
| ID                                       | ESTROWS    | ACTROWS    | TASK      | ACCESS OBJECT                               | EXECUTION INFO                                                                                                                                                                                                                                                                                                                                                                                                                                   | OPERATOR INFO                                                                                                                                                                               | MEMORY    | DISK    |
+------------------------------------------+------------+------------+-----------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+
| HashAgg_35                               | 1.00       | 1          | root      |                                             | time:2m42.3s, loops:2, RU:20581.276319, partial_worker:{wall_time:2m42.287510425s, concurrency:5, task_num:9009, tot_wait:13m30.05205941s, tot_exec:1.383332707s, tot_time:13m31.437332833s, max:2m42.287490326s, p95:2m42.287490326s}, final_worker:{wall_time:2m42.287533312s, concurrency:5, task_num:5, tot_wait:13m31.437519239s, tot_exec:41.425µs, tot_time:13m31.437563769s, max:2m42.287521969s, p95:2m42.287521969s}                   | funcs:min(imdb.company_name.name)->Column#39, funcs:min(imdb.movie_companies.note)->Column#40, funcs:min(imdb.title.title)->Column#41                                                       | 2.41 MB   | N/A     |
| └─Projection_37                          | 4911.99    | 9221275    | root      |                                             | time:2m42.3s, loops:9010, Concurrency:5                                                                                                                                                                                                                                                                                                                                                                                                          | imdb.company_name.name, imdb.movie_companies.note, imdb.title.title                                                                                                                         | 2.25 MB   | N/A     |
|   └─HashJoin_50                          | 4911.99    | 9221275    | root      |                                             | time:2m42.3s, loops:9010, build_hash_table:{total:4.4ms, fetch:4.39ms, build:12.2µs}, probe:{concurrency:5, total:13m31.4s, max:2m42.3s, probe:2m54.1s, fetch:10m37.4s}                                                                                                                                                                                                                                                                          | inner join, equal:[eq(imdb.movie_keyword.keyword_id, imdb.keyword.id)]                                                                                                                      | 25.7 KB   | 0 Bytes |
|     ├─IndexLookUp_233(Build)             | 137.38     | 3          | root      |                                             | time:4.36ms, loops:2, index_task: {total_time: 689.5µs, fetch_handle: 685.2µs, build: 1.34µs, wait: 2.92µs}, table_task: {total_time: 3.59ms, num: 1, concurrency: 5}, next: {wait_index: 751.3µs, wait_table_lookup_build: 174.3µs, wait_table_lookup_resp: 3.41ms}                                                                                                                                                                             |                                                                                                                                                                                             | 13.0 KB   | N/A     |
|     │ ├─IndexRangeScan_230(Build)        | 137.38     | 258        | cop[tikv] | table:k, index:keyword_idx_keyword(keyword) | time:665.2µs, loops:3, cop_task: {num: 1, max: 589.3µs, proc_keys: 258, tot_proc: 202.9µs, tot_wait: 27.5µs, rpc_num: 1, rpc_time: 571.2µs, copr_cache_hit_ratio: 0.00, build_task_duration: 14.7µs, max_distsql_concurrency: 1}, tikv_task:{time:0s, loops:4}, scan_detail: {total_process_keys: 258, total_process_keys_size: 11868, total_keys: 261, get_snapshot_time: 10µs, rocksdb: {key_skipped_count: 258, block: {cache_hit_count: 6}}} | range:["based","based"], ["reven","reven"], ["seque","seque"], keep order:false                                                                                                             | N/A       | N/A     |
|     │ └─Selection_232(Probe)             | 137.38     | 3          | cop[tikv] |                                             | time:3.39ms, loops:2, cop_task: {num: 1, max: 3.28ms, proc_keys: 258, tot_proc: 2.39ms, tot_wait: 37.4µs, rpc_num: 1, rpc_time: 3.25ms, copr_cache_hit_ratio: 0.00, build_task_duration: 32.7µs, max_distsql_concurrency: 1}, tikv_task:{time:3ms, loops:4}, scan_detail: {total_process_keys: 258, total_process_keys_size: 16408, total_keys: 265, get_snapshot_time: 18µs, rocksdb: {key_skipped_count: 14, block: {cache_hit_count: 448}}}   | in(imdb.keyword.keyword, "sequel", "revenge", "based-on-novel")                                                                                                                             | N/A       | N/A     |
|     │   └─TableRowIDScan_231             | 137.38     | 258        | cop[tikv] | table:k                                     | tikv_task:{time:3ms, loops:4}                                                                                                                                                                                                                                                                                                                                                                                                                    | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|     └─HashJoin_64(Probe)                 | 8378871.38 | 2581940039 | root      |                                             | time:2m39.8s, loops:2521430, build_hash_table:{total:5s, fetch:1.89s, build:3.11s}, probe:{concurrency:5, total:13m18.8s, max:2m42.3s, probe:12m53.7s, fetch:25.1s}                                                                                                                                                                                                                                                                              | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.movie_keyword.movie_id) eq(imdb.movie_link.movie_id, imdb.movie_keyword.movie_id) eq(imdb.title.id, imdb.movie_keyword.movie_id)] | 2.34 GB   | 0 Bytes |
|       ├─HashJoin_75(Build)               | 2585150.00 | 17625104   | root      |                                             | time:2s, loops:17214, build_hash_table:{total:77.7µs, fetch:57.3µs, build:20.4µs}, probe:{concurrency:5, total:25s, max:5s, probe:15.9s, fetch:9.11s}                                                                                                                                                                                                                                                                                            | inner join, equal:[eq(imdb.movie_link.link_type_id, imdb.link_type.id)]                                                                                                                     | 9.46 KB   | 0 Bytes |
|       │ ├─TableReader_225(Build)         | 18.00      | 18         | root      |                                             | time:36.7µs, loops:2, cop_task: {num: 1, max: 298.8µs, proc_keys: 18, tot_proc: 47.5µs, tot_wait: 19.7µs, rpc_num: 1, rpc_time: 284µs, copr_cache_hit_ratio: 0.00, build_task_duration: 1.9µs, max_distsql_concurrency: 1}                                                                                                                                                                                                                       | data:TableFullScan_224                                                                                                                                                                      | 385 Bytes | N/A     |
|       │ │ └─TableFullScan_224            | 18.00      | 18         | cop[tikv] | table:lt                                    | tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 18, total_process_keys_size: 486, total_keys: 19, get_snapshot_time: 7.34µs, rocksdb: {key_skipped_count: 18, block: {cache_hit_count: 2}}}                                                                                                                                                                                                                                      | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │ └─HashJoin_88(Probe)             | 2585150.00 | 17625104   | root      |                                             | time:1.84s, loops:17215, build_hash_table:{total:1.03s, fetch:678.3ms, build:352.6ms}, probe:{concurrency:5, total:25s, max:5s, probe:16s, fetch:9.02s}                                                                                                                                                                                                                                                                                          | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.movie_link.movie_id) eq(imdb.title.id, imdb.movie_link.movie_id)]                                                                 | 96.6 MB   | 0 Bytes |
|       │   ├─TableReader_223(Build)       | 2585150.00 | 2585150    | root      |                                             | time:677ms, loops:2528, cop_task: {num: 3, max: 862.1ms, min: 365.6µs, avg: 449.6ms, p95: 862.1ms, max_proc_keys: 1280000, p95_proc_keys: 1280000, tot_proc: 1.3s, tot_wait: 58.3µs, rpc_num: 3, rpc_time: 1.35s, copr_cache_hit_ratio: 0.33, build_task_duration: 7.09µs, max_distsql_concurrency: 3}                                                                                                                                           | data:TableFullScan_222                                                                                                                                                                      | 32.9 MB   | N/A     |
|       │   │ └─TableFullScan_222          | 2585150.00 | 2585150    | cop[tikv] | table:ml                                    | tikv_task:{proc max:783ms, min:438ms, avg: 587.3ms, p80:783ms, p95:783ms, iters:2539, tasks:3}, scan_detail: {total_process_keys: 2156027, total_process_keys_size: 109946493, total_keys: 2156029, get_snapshot_time: 18.4µs, rocksdb: {key_skipped_count: 2156027, block: {cache_hit_count: 4198}}}                                                                                                                                            | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │   └─HashJoin_102(Probe)          | 2307846.25 | 1714499    | root      |                                             | time:1.81s, loops:1678, build_hash_table:{total:1.8s, fetch:356.6ms, build:1.44s}, probe:{concurrency:5, total:24.8s, max:4.97s, probe:15.8s, fetch:9.01s}                                                                                                                                                                                                                                                                                       | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.title.id)]                                                                                                                        | 402.8 MB  | 0 Bytes |
|       │     ├─TableReader_218(Build)     | 4247586.00 | 4247643    | root      |                                             | time:359.5ms, loops:4507, cop_task: {num: 6, max: 917.6ms, min: 344.9ms, avg: 603.2ms, p95: 917.6ms, max_proc_keys: 1107917, p95_proc_keys: 1107917, tot_proc: 3.37s, tot_wait: 120.8µs, rpc_num: 6, rpc_time: 3.62s, copr_cache_hit_ratio: 0.00, build_task_duration: 11.4µs, max_distsql_concurrency: 6}                                                                                                                                       | data:Selection_217                                                                                                                                                                          | 102.4 MB  | N/A     |
|       │     │ └─Selection_217            | 4247586.00 | 4247643    | cop[tikv] |                                             | tikv_task:{proc max:764ms, min:288ms, avg: 493.8ms, p80:700ms, p95:764ms, iters:4653, tasks:6}, scan_detail: {total_process_keys: 4736508, total_process_keys_size: 524795377, total_keys: 4736514, get_snapshot_time: 39.8µs, rocksdb: {key_skipped_count: 4736611, block: {cache_hit_count: 17914}}}                                                                                                                                           | gt(imdb.title.production_year, 1950)                                                                                                                                                        | N/A       | N/A     |
|       │     │   └─TableFullScan_216      | 4736508.00 | 4736508    | cop[tikv] | table:t                                     | tikv_task:{proc max:734ms, min:283ms, avg: 473ms, p80:664ms, p95:734ms, iters:4653, tasks:6}                                                                                                                                                                                                                                                                                                                                                     | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │     └─HashJoin_146(Probe)        | 2288639.00 | 1954290    | root      |                                             | time:582.4ms, loops:1911, build_hash_table:{total:515.5ms, fetch:433.2ms, build:82.3ms}, probe:{concurrency:5, total:24.6s, max:4.94s, probe:21.7s, fetch:2.9s}                                                                                                                                                                                                                                                                                  | inner join, equal:[eq(imdb.movie_companies.company_id, imdb.company_name.id)]                                                                                                               | 38.1 MB   | 0 Bytes |
|       │       ├─TableReader_215(Build)   | 337886.00  | 337601     | root      |                                             | time:433.1ms, loops:355, cop_task: {num: 1, max: 433.2ms, proc_keys: 362131, tot_proc: 414.1ms, tot_wait: 353µs, rpc_num: 1, rpc_time: 433.2ms, copr_cache_hit_ratio: 0.00, build_task_duration: 5.25µs, max_distsql_concurrency: 1}                                                                                                                                                                                                             | data:Selection_214                                                                                                                                                                          | 14.9 MB   | N/A     |
|       │       │ └─Selection_214          | 337886.00  | 337601     | cop[tikv] |                                             | tikv_task:{time:363ms, loops:358}, scan_detail: {total_process_keys: 362131, total_process_keys_size: 40171508, total_keys: 362132, get_snapshot_time: 336.5µs, rocksdb: {key_skipped_count: 362131, block: {cache_hit_count: 1373}}}                                                                                                                                                                                                            | ne(imdb.company_name.country_code, "[pl]")                                                                                                                                                  | N/A       | N/A     |
|       │       │   └─TableFullScan_213    | 362131.00  | 362131     | cop[tikv] | table:cn                                    | tikv_task:{time:323ms, loops:358}                                                                                                                                                                                                                                                                                                                                                                                                                | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │       └─HashJoin_194(Probe)      | 2288639.00 | 1980874    | root      |                                             | time:582.8ms, loops:1938, build_hash_table:{total:63.3µs, fetch:58µs, build:5.29µs}, probe:{concurrency:5, total:24.5s, max:4.91s, probe:21.6s, fetch:2.89s}                                                                                                                                                                                                                                                                                     | inner join, equal:[eq(imdb.company_type.id, imdb.movie_companies.company_type_id)]                                                                                                          | 25.7 KB   | 0 Bytes |
|       │         ├─TableReader_205(Build) | 3.20       | 3          | root      |                                             | time:27.1µs, loops:2, cop_task: {num: 1, max: 662.9µs, proc_keys: 4, tot_proc: 51.8µs, tot_wait: 356.1µs, rpc_num: 1, rpc_time: 649.2µs, copr_cache_hit_ratio: 0.00, build_task_duration: 4.85µs, max_distsql_concurrency: 1}                                                                                                                                                                                                                    | data:Selection_204                                                                                                                                                                          | 381 Bytes | N/A     |
|       │         │ └─Selection_204        | 3.20       | 3          | cop[tikv] |                                             | tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 4, total_process_keys_size: 224, total_keys: 5, get_snapshot_time: 340.6µs, rocksdb: {key_skipped_count: 4, block: {cache_hit_count: 2}}}                                                                                                                                                                                                                                        | ne(imdb.company_type.kind, "production companies"), not(isnull(imdb.company_type.kind))                                                                                                     | N/A       | N/A     |
|       │         │   └─TableFullScan_203  | 4.00       | 4          | cop[tikv] | table:ct                                    | tikv_task:{time:0s, loops:1}                                                                                                                                                                                                                                                                                                                                                                                                                     | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │         └─TableReader_212(Probe) | 2288639.00 | 2288639    | root      |                                             | time:585.1ms, loops:2306, cop_task: {num: 5, max: 1.04s, min: 621.4µs, avg: 472.5ms, p95: 1.04s, max_proc_keys: 1185298, p95_proc_keys: 1185298, tot_proc: 2.19s, tot_wait: 1.76ms, rpc_num: 5, rpc_time: 2.36s, copr_cache_hit_ratio: 0.40, build_task_duration: 9.46µs, max_distsql_concurrency: 5}                                                                                                                                            | data:Selection_211                                                                                                                                                                          | 110.8 MB  | N/A     |
|       │           └─Selection_211        | 2288639.00 | 2288639    | cop[tikv] |                                             | tikv_task:{proc max:809ms, min:463ms, avg: 673.6ms, p80:809ms, p95:809ms, iters:4864, tasks:5}, scan_detail: {total_process_keys: 2969382, total_process_keys_size: 202617625, total_keys: 2969385, get_snapshot_time: 1.68ms, rocksdb: {key_skipped_count: 2969383, block: {cache_hit_count: 7347}}}                                                                                                                                            | not(isnull(imdb.movie_companies.note))                                                                                                                                                      | N/A       | N/A     |
|       │             └─TableFullScan_210  | 4958296.00 | 4958296    | cop[tikv] | table:mc                                    | tikv_task:{proc max:741ms, min:399ms, avg: 619.6ms, p80:741ms, p95:741ms, iters:4864, tasks:5}                                                                                                                                                                                                                                                                                                                                                   | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       └─TableReader_229(Probe)           | 7480087.00 | 7480087    | root      |                                             | time:44.2ms, loops:7311, cop_task: {num: 10, max: 669.9ms, min: 258.7µs, avg: 336.6ms, p95: 669.9ms, max_proc_keys: 960000, p95_proc_keys: 960000, tot_proc: 3.24s, tot_wait: 219µs, rpc_num: 10, rpc_time: 3.37s, copr_cache_hit_ratio: 0.40, build_task_duration: 17.8µs, max_distsql_concurrency: 10}                                                                                                                                         | data:TableFullScan_228                                                                                                                                                                      | 114.3 MB  | N/A     |
|         └─TableFullScan_228              | 7480087.00 | 7480087    | cop[tikv] | table:mk                                    | tikv_task:{proc max:604ms, min:343ms, avg: 486.2ms, p80:599ms, p95:604ms, iters:7350, tasks:10}, scan_detail: {total_process_keys: 5307746, total_process_keys_size: 240613872, total_keys: 5307752, get_snapshot_time: 73.9µs, rocksdb: {key_skipped_count: 5307746, block: {cache_hit_count: 9408}}}                                                                                                                                           | keep order:false                                                                                                                                                                            | N/A       | N/A     |
+------------------------------------------+------------+------------+-----------+---------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+

```

### 3. What did you see instead (Required)
The elapsed time of 11D ranges from 162s to 195s
![image](https://github.com/pingcap/tidb/assets/84501897/e3681f03-4eaa-4d53-a965-b5bb5837c671)
```
Olap_Detail_Log_ID: 6295290   Plan_Digest: 6df5d21ab577975303577b1283c20ef0 Elapsed_Time (s): 195.5 

+------------------------------------------+------------+------------+-----------+---------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+
| ID                                       | ESTROWS    | ACTROWS    | TASK      | ACCESS OBJECT                               | EXECUTION INFO                                                                                                                                                                                                                                                                                                                                                                                                                                    | OPERATOR INFO                                                                                                                                                                               | MEMORY    | DISK    |
+------------------------------------------+------------+------------+-----------+---------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+
| HashAgg_35                               | 1.00       | 1          | root      |                                             | time:3m15.5s, loops:2, RU:21598.602762, partial_worker:{wall_time:3m15.526680121s, concurrency:5, task_num:9008, tot_wait:16m15.894038691s, tot_exec:1.736775085s, tot_time:16m17.632883533s, max:3m15.526652138s, p95:3m15.526652138s}, final_worker:{wall_time:3m15.526689401s, concurrency:5, task_num:20, tot_wait:16m17.633273823s, tot_exec:11.254µs, tot_time:16m17.633290392s, max:3m15.5266614s, p95:3m15.5266614s}                      | funcs:min(imdb.company_name.name)->Column#39, funcs:min(imdb.movie_companies.note)->Column#40, funcs:min(imdb.title.title)->Column#41                                                       | 2.40 MB   | N/A     |
| └─Projection_37                          | 4946.92    | 9221275    | root      |                                             | time:3m15.5s, loops:9009, Concurrency:5                                                                                                                                                                                                                                                                                                                                                                                                           | imdb.company_name.name, imdb.movie_companies.note, imdb.title.title                                                                                                                         | 2.25 MB   | N/A     |
|   └─HashJoin_50                          | 4946.92    | 9221275    | root      |                                             | time:3m15.5s, loops:9009, build_hash_table:{total:4.04ms, fetch:4.03ms, build:5.19µs}, probe:{concurrency:5, total:16m17.6s, max:3m15.5s, probe:3m18.9s, fetch:12m58.7s}                                                                                                                                                                                                                                                                          | inner join, equal:[eq(imdb.movie_keyword.keyword_id, imdb.keyword.id)]                                                                                                                      | 25.7 KB   | 0 Bytes |
|     ├─IndexLookUp_233(Build)             | 138.35     | 3          | root      |                                             | time:3.97ms, loops:2, index_task: {total_time: 857.2µs, fetch_handle: 853.4µs, build: 1.32µs, wait: 2.47µs}, table_task: {total_time: 3.01ms, num: 1, concurrency: 5}, next: {wait_index: 944.5µs, wait_table_lookup_build: 319.4µs, wait_table_lookup_resp: 2.67ms}                                                                                                                                                                              |                                                                                                                                                                                             | 13.0 KB   | N/A     |
|     │ ├─IndexRangeScan_230(Build)        | 138.35     | 258        | cop[tikv] | table:k, index:keyword_idx_keyword(keyword) | time:830.9µs, loops:3, cop_task: {num: 1, max: 742µs, proc_keys: 258, tot_proc: 325.6µs, tot_wait: 23.9µs, rpc_num: 1, rpc_time: 725.2µs, copr_cache_hit_ratio: 0.00, build_task_duration: 15.5µs, max_distsql_concurrency: 1}, tikv_task:{time:1ms, loops:4}, scan_detail: {total_process_keys: 258, total_process_keys_size: 11868, total_keys: 261, get_snapshot_time: 8.81µs, rocksdb: {key_skipped_count: 258, block: {cache_hit_count: 6}}} | range:["based","based"], ["reven","reven"], ["seque","seque"], keep order:false                                                                                                             | N/A       | N/A     |
|     │ └─Selection_232(Probe)             | 138.35     | 3          | cop[tikv] |                                             | time:2.65ms, loops:2, cop_task: {num: 1, max: 2.56ms, proc_keys: 258, tot_proc: 1.67ms, tot_wait: 25µs, rpc_num: 1, rpc_time: 2.53ms, copr_cache_hit_ratio: 0.00, build_task_duration: 77.5µs, max_distsql_concurrency: 1}, tikv_task:{time:2ms, loops:4}, scan_detail: {total_process_keys: 258, total_process_keys_size: 16408, total_keys: 265, get_snapshot_time: 8.6µs, rocksdb: {key_skipped_count: 14, block: {cache_hit_count: 448}}}     | in(imdb.keyword.keyword, "sequel", "revenge", "based-on-novel")                                                                                                                             | N/A       | N/A     |
|     │   └─TableRowIDScan_231             | 138.35     | 258        | cop[tikv] | table:k                                     | tikv_task:{time:1ms, loops:4}                                                                                                                                                                                                                                                                                                                                                                                                                     | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|     └─HashJoin_64(Probe)                 | 8378871.38 | 2581940039 | root      |                                             | time:3m12.9s, loops:2521429, build_hash_table:{total:4.95s, fetch:1.96s, build:2.99s}, probe:{concurrency:5, total:16m6.3s, max:3m15.5s, probe:15m41.4s, fetch:24.8s}                                                                                                                                                                                                                                                                             | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.movie_keyword.movie_id) eq(imdb.movie_link.movie_id, imdb.movie_keyword.movie_id) eq(imdb.title.id, imdb.movie_keyword.movie_id)] | 2.34 GB   | 0 Bytes |
|       ├─HashJoin_75(Build)               | 2585150.00 | 17625104   | root      |                                             | time:2.09s, loops:17216, build_hash_table:{total:57.7µs, fetch:49µs, build:8.75µs}, probe:{concurrency:5, total:24.8s, max:4.95s, probe:15.3s, fetch:9.48s}                                                                                                                                                                                                                                                                                       | inner join, equal:[eq(imdb.movie_link.link_type_id, imdb.link_type.id)]                                                                                                                     | 9.46 KB   | 0 Bytes |
|       │ ├─TableReader_225(Build)         | 18.00      | 18         | root      |                                             | time:28.6µs, loops:2, cop_task: {num: 1, max: 312.5µs, proc_keys: 18, tot_proc: 42.3µs, tot_wait: 21.1µs, rpc_num: 1, rpc_time: 296.4µs, copr_cache_hit_ratio: 0.00, build_task_duration: 1.94µs, max_distsql_concurrency: 1}                                                                                                                                                                                                                     | data:TableFullScan_224                                                                                                                                                                      | 385 Bytes | N/A     |
|       │ │ └─TableFullScan_224            | 18.00      | 18         | cop[tikv] | table:lt                                    | tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 18, total_process_keys_size: 486, total_keys: 19, get_snapshot_time: 6.18µs, rocksdb: {key_skipped_count: 18, block: {cache_hit_count: 2}}}                                                                                                                                                                                                                                       | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │ └─HashJoin_88(Probe)             | 2585150.00 | 17625104   | root      |                                             | time:1.93s, loops:17216, build_hash_table:{total:1.07s, fetch:718.2ms, build:353.3ms}, probe:{concurrency:5, total:24.7s, max:4.95s, probe:15.3s, fetch:9.34s}                                                                                                                                                                                                                                                                                    | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.movie_link.movie_id) eq(imdb.title.id, imdb.movie_link.movie_id)]                                                                 | 96.6 MB   | 0 Bytes |
|       │   ├─TableReader_223(Build)       | 2585150.00 | 2585150    | root      |                                             | time:717.1ms, loops:2528, cop_task: {num: 3, max: 893.9ms, min: 302.5µs, avg: 534.2ms, p95: 893.9ms, max_proc_keys: 1280000, p95_proc_keys: 1280000, tot_proc: 1.55s, tot_wait: 63.7µs, rpc_num: 3, rpc_time: 1.6s, copr_cache_hit_ratio: 0.33, build_task_duration: 6.8µs, max_distsql_concurrency: 3}                                                                                                                                           | data:TableFullScan_222                                                                                                                                                                      | 32.9 MB   | N/A     |
|       │   │ └─TableFullScan_222          | 2585150.00 | 2585150    | cop[tikv] | table:ml                                    | tikv_task:{proc max:820ms, min:241ms, avg: 569.3ms, p80:820ms, p95:820ms, iters:2539, tasks:3}, scan_detail: {total_process_keys: 2156027, total_process_keys_size: 109946493, total_keys: 2156029, get_snapshot_time: 20.2µs, rocksdb: {key_skipped_count: 2156027, block: {cache_hit_count: 4198}}}                                                                                                                                             | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │   └─HashJoin_102(Probe)          | 2307846.25 | 1714499    | root      |                                             | time:1.87s, loops:1678, build_hash_table:{total:1.86s, fetch:440.9ms, build:1.42s}, probe:{concurrency:5, total:24.5s, max:4.91s, probe:15.1s, fetch:9.33s}                                                                                                                                                                                                                                                                                       | inner join, equal:[eq(imdb.movie_companies.movie_id, imdb.title.id)]                                                                                                                        | 402.8 MB  | 0 Bytes |
|       │     ├─TableReader_218(Build)     | 4196105.00 | 4247643    | root      |                                             | time:444ms, loops:4507, cop_task: {num: 6, max: 1.04s, min: 326.9ms, avg: 691.4ms, p95: 1.04s, max_proc_keys: 1107917, p95_proc_keys: 1107917, tot_proc: 3.88s, tot_wait: 132.5µs, rpc_num: 6, rpc_time: 4.15s, copr_cache_hit_ratio: 0.00, build_task_duration: 9.78µs, max_distsql_concurrency: 6}                                                                                                                                              | data:Selection_217                                                                                                                                                                          | 102.4 MB  | N/A     |
|       │     │ └─Selection_217            | 4196105.00 | 4247643    | cop[tikv] |                                             | tikv_task:{proc max:870ms, min:261ms, avg: 575.5ms, p80:808ms, p95:870ms, iters:4653, tasks:6}, scan_detail: {total_process_keys: 4736508, total_process_keys_size: 524795377, total_keys: 4736514, get_snapshot_time: 42.9µs, rocksdb: {key_skipped_count: 4736611, block: {cache_hit_count: 17914}}}                                                                                                                                            | gt(imdb.title.production_year, 1950)                                                                                                                                                        | N/A       | N/A     |
|       │     │   └─TableFullScan_216      | 4736508.00 | 4736508    | cop[tikv] | table:t                                     | tikv_task:{proc max:841ms, min:250ms, avg: 554.3ms, p80:771ms, p95:841ms, iters:4653, tasks:6}                                                                                                                                                                                                                                                                                                                                                    | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │     └─HashJoin_146(Probe)        | 2288639.00 | 1954290    | root      |                                             | time:700.2ms, loops:1912, build_hash_table:{total:457.8ms, fetch:362.7ms, build:95.1ms}, probe:{concurrency:5, total:24.2s, max:4.85s, probe:20.7s, fetch:3.48s}                                                                                                                                                                                                                                                                                  | inner join, equal:[eq(imdb.movie_companies.company_id, imdb.company_name.id)]                                                                                                               | 38.1 MB   | 0 Bytes |
|       │       ├─TableReader_215(Build)   | 337882.00  | 337601     | root      |                                             | time:362.4ms, loops:355, cop_task: {num: 1, max: 362.5ms, proc_keys: 362131, tot_proc: 332.9ms, tot_wait: 247.2µs, rpc_num: 1, rpc_time: 362.5ms, copr_cache_hit_ratio: 0.00, build_task_duration: 1.9µs, max_distsql_concurrency: 1}                                                                                                                                                                                                             | data:Selection_214                                                                                                                                                                          | 14.9 MB   | N/A     |
|       │       │ └─Selection_214          | 337882.00  | 337601     | cop[tikv] |                                             | tikv_task:{time:294ms, loops:358}, scan_detail: {total_process_keys: 362131, total_process_keys_size: 40171508, total_keys: 362132, get_snapshot_time: 229.2µs, rocksdb: {key_skipped_count: 362131, block: {cache_hit_count: 1373}}}                                                                                                                                                                                                             | ne(imdb.company_name.country_code, "[pl]")                                                                                                                                                  | N/A       | N/A     |
|       │       │   └─TableFullScan_213    | 362131.00  | 362131     | cop[tikv] | table:cn                                    | tikv_task:{time:266ms, loops:358}                                                                                                                                                                                                                                                                                                                                                                                                                 | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │       └─HashJoin_194(Probe)      | 2288639.00 | 1980874    | root      |                                             | time:699.5ms, loops:1937, build_hash_table:{total:121.9µs, fetch:114µs, build:7.88µs}, probe:{concurrency:5, total:24.1s, max:4.83s, probe:20.6s, fetch:3.47s}                                                                                                                                                                                                                                                                                    | inner join, equal:[eq(imdb.company_type.id, imdb.movie_companies.company_type_id)]                                                                                                          | 25.7 KB   | 0 Bytes |
|       │         ├─TableReader_205(Build) | 3.20       | 3          | root      |                                             | time:58.7µs, loops:2, cop_task: {num: 1, max: 694.1µs, proc_keys: 4, tot_proc: 53.2µs, tot_wait: 255.1µs, rpc_num: 1, rpc_time: 668.3µs, copr_cache_hit_ratio: 0.00, build_task_duration: 6.2µs, max_distsql_concurrency: 1}                                                                                                                                                                                                                      | data:Selection_204                                                                                                                                                                          | 381 Bytes | N/A     |
|       │         │ └─Selection_204        | 3.20       | 3          | cop[tikv] |                                             | tikv_task:{time:0s, loops:1}, scan_detail: {total_process_keys: 4, total_process_keys_size: 224, total_keys: 5, get_snapshot_time: 242.8µs, rocksdb: {key_skipped_count: 4, block: {cache_hit_count: 2}}}                                                                                                                                                                                                                                         | ne(imdb.company_type.kind, "production companies"), not(isnull(imdb.company_type.kind))                                                                                                     | N/A       | N/A     |
|       │         │   └─TableFullScan_203  | 4.00       | 4          | cop[tikv] | table:ct                                    | tikv_task:{time:0s, loops:1}                                                                                                                                                                                                                                                                                                                                                                                                                      | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       │         └─TableReader_212(Probe) | 2288639.00 | 2288639    | root      |                                             | time:702.5ms, loops:2307, cop_task: {num: 5, max: 1.15s, min: 263.2µs, avg: 515.8ms, p95: 1.15s, max_proc_keys: 1185298, p95_proc_keys: 1185298, tot_proc: 2.41s, tot_wait: 584.9µs, rpc_num: 5, rpc_time: 2.58s, copr_cache_hit_ratio: 0.40, build_task_duration: 12.8µs, max_distsql_concurrency: 5}                                                                                                                                            | data:Selection_211                                                                                                                                                                          | 110.8 MB  | N/A     |
|       │           └─Selection_211        | 2288639.00 | 2288639    | cop[tikv] |                                             | tikv_task:{proc max:908ms, min:565ms, avg: 672.6ms, p80:908ms, p95:908ms, iters:4864, tasks:5}, scan_detail: {total_process_keys: 2969382, total_process_keys_size: 202617625, total_keys: 2969385, get_snapshot_time: 507.9µs, rocksdb: {key_skipped_count: 2969383, block: {cache_hit_count: 7347}}}                                                                                                                                            | not(isnull(imdb.movie_companies.note))                                                                                                                                                      | N/A       | N/A     |
|       │             └─TableFullScan_210  | 4958296.00 | 4958296    | cop[tikv] | table:mc                                    | tikv_task:{proc max:813ms, min:514ms, avg: 617ms, p80:813ms, p95:813ms, iters:4864, tasks:5}                                                                                                                                                                                                                                                                                                                                                      | keep order:false                                                                                                                                                                            | N/A       | N/A     |
|       └─TableReader_229(Probe)           | 7480087.00 | 7480087    | root      |                                             | time:51ms, loops:7311, cop_task: {num: 10, max: 867.7ms, min: 196.6µs, avg: 420.3ms, p95: 867.7ms, max_proc_keys: 960000, p95_proc_keys: 960000, tot_proc: 4.05s, tot_wait: 223.5µs, rpc_num: 10, rpc_time: 4.2s, copr_cache_hit_ratio: 0.30, build_task_duration: 22.7µs, max_distsql_concurrency: 10}                                                                                                                                           | data:TableFullScan_228                                                                                                                                                                      | 114.3 MB  | N/A     |
|         └─TableFullScan_228              | 7480087.00 | 7480087    | cop[tikv] | table:mk                                    | tikv_task:{proc max:796ms, min:313ms, avg: 482.9ms, p80:717ms, p95:796ms, iters:7350, tasks:10}, scan_detail: {total_process_keys: 5957358, total_process_keys_size: 270050336, total_keys: 5957365, get_snapshot_time: 64.9µs, rocksdb: {key_skipped_count: 5957358, block: {cache_hit_count: 10560}}}                                                                                                                                           | keep order:false                                                                                                                                                                            | N/A       | N/A     |
+------------------------------------------+------------+------------+-----------+---------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+---------+

```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Since https://github.com/pingcap/tidb/pull/48264

