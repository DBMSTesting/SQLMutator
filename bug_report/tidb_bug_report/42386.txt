ID: 42386
Title: Result is wrong when open Tiflash late materialation
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
tpcc 1000 warehouse check

```
SELECT COUNT(*) FROM (select d_id,d_w_id,sum(d_ytd) s1 from district group by d_id,d_w_id) d,(select h_d_id,h_w_id,sum(h_amount) s2 from history WHERE  h_w_id = 1 group by h_d_id, h_w_id) h WHERE h_d_id=d_id AND d_w_id=h_w_id and d_w_id= 1 and s1<>s2; -- expect get 0 but got 90
explain analyze SELECT COUNT(*) FROM (select d_id,d_w_id,sum(d_ytd) s1 from district group by d_id,d_w_id) d,(select h_d_id,h_w_id,sum(h_amount) s2 from history WHERE  h_w_id = 1 group by h_d_id, h_w_id) h WHERE h_d_id=d_id AND d_w_id=h_w_id and d_w_id= 1 and s1<>s2;
+------------------------------------------------+----------+---------+--------------+---------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| id                                             | estRows  | actRows | task         | access object                                     | execution info                                                                                                                                                                                                                                                                                                      | operator info                                                                                                                                                          | memory  | disk |
+------------------------------------------------+----------+---------+--------------+---------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
| StreamAgg_22                                   | 1.00     | 1       | root         |                                                   | time:24.1ms, loops:2, RRU:0.000000, WRU:0.000000                                                                                                                                                                                                                                                                    | funcs:count(1)->Column#24                                                                                                                                              | 10.1 KB | N/A  |
| └─TableReader_92                               | 7.03     | 90      | root         | partition:p1 of district, partition:p1 of history | time:24.1ms, loops:2, cop_task: {num: 2, max: 0s, min: 0s, avg: 0s, p95: 0s, copr_cache_hit_ratio: 0.00}                                                                                                                                                                                                            | MppVersion: 1, data:ExchangeSender_91                                                                                                                                  | 8.60 KB | N/A  |
|   └─ExchangeSender_91                          | 7.03     | 90      | mpp[tiflash] |                                                   | tiflash_task:{time:22.1ms, loops:1, threads:8}                                                                                                                                                                                                                                                                      | ExchangeType: PassThrough                                                                                                                                              | N/A     | N/A  |
|     └─HashJoin_88                              | 7.03     | 90      | mpp[tiflash] |                                                   | tiflash_task:{time:22.1ms, loops:1, threads:8}                                                                                                                                                                                                                                                                      | inner join, equal:[eq(tpcc.district.d_id, tpcc.history.h_d_id)], other cond:ne(Column#13, Column#23)                                                                   | N/A     | N/A  |
|       ├─ExchangeReceiver_45(Build)             | 0.88     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:22.1ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      |                                                                                                                                                                        | N/A     | N/A  |
|       │ └─ExchangeSender_44                    | 0.88     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:20.8ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      | ExchangeType: Broadcast                                                                                                                                                | N/A     | N/A  |
|       │   └─Selection_30                       | 0.88     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:20.8ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      | not(isnull(Column#23))                                                                                                                                                 | N/A     | N/A  |
|       │     └─Projection_40                    | 1.10     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:20.8ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      | Column#23, tpcc.history.h_d_id                                                                                                                                         | N/A     | N/A  |
|       │       └─HashAgg_41                     | 1.10     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:20.8ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      | group by:tpcc.history.h_d_id, tpcc.history.h_w_id, funcs:sum(Column#26)->Column#23, funcs:firstrow(tpcc.history.h_d_id)->tpcc.history.h_d_id, stream_count: 8          | N/A     | N/A  |
|       │         └─ExchangeReceiver_43          | 1.10     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:20.8ms, loops:8, threads:8}                                                                                                                                                                                                                                                                      | stream_count: 8                                                                                                                                                        | N/A     | N/A  |
|       │           └─ExchangeSender_42          | 1.10     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:21.8ms, loops:1, threads:1}                                                                                                                                                                                                                                                                      | ExchangeType: HashPartition, Compression: FAST, Hash Cols: [name: tpcc.history.h_d_id, collate: binary], [name: tpcc.history.h_w_id, collate: binary], stream_count: 8 | N/A     | N/A  |
|       │             └─HashAgg_32               | 1.10     | 100     | mpp[tiflash] |                                                   | tiflash_task:{time:21.8ms, loops:1, threads:1}                                                                                                                                                                                                                                                                      | group by:tpcc.history.h_d_id, tpcc.history.h_w_id, funcs:sum(tpcc.history.h_amount)->Column#26                                                                         | N/A     | N/A  |
|       │               └─TableFullScan_38       | 30250.96 | 300680  | mpp[tiflash] | table:history                                     | tiflash_task:{time:17.8ms, loops:7, threads:1}, tiflash_scan:{dtfile:{total_scanned_packs:74, total_skipped_packs:0, total_scanned_rows:600000, total_skipped_rows:0, total_rs_index_load_time: 0ms, total_read_time: 7ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0} | pushed down filter:eq(1, tpcc.history.h_w_id), eq(tpcc.history.h_w_id, 1), keep order:false, PartitionTableScan:true                                                   | N/A     | N/A  |
|       └─Projection_26(Probe)                   | 8.00     | 10      | mpp[tiflash] |                                                   | tiflash_task:{time:2.06ms, loops:1, threads:8}                                                                                                                                                                                                                                                                      | tpcc.district.d_id, cast(tpcc.district.d_ytd, decimal(34,2) BINARY)->Column#13                                                                                         | N/A     | N/A  |
|         └─Selection_28                         | 8.00     | 10      | mpp[tiflash] |                                                   | tiflash_task:{time:2.06ms, loops:1, threads:1}                                                                                                                                                                                                                                                                      | eq(tpcc.district.d_w_id, 1), not(isnull(cast(tpcc.district.d_ytd, decimal(34,2) BINARY)))                                                                              | N/A     | N/A  |
|           └─TableFullScan_27                   | 1000.00  | 100     | mpp[tiflash] | table:district                                    | tiflash_task:{time:2.06ms, loops:1, threads:1}, tiflash_scan:{dtfile:{total_scanned_packs:2, total_skipped_packs:0, total_scanned_rows:200, total_skipped_rows:0, total_rs_index_load_time: 0ms, total_read_time: 0ms}, total_create_snapshot_time: 0ms, total_local_region_num: 0, total_remote_region_num: 0}     | pushed down filter:empty, keep order:false, PartitionTableScan:true                                                                                                    | N/A     | N/A  |
+------------------------------------------------+----------+---------+--------------+---------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+------+
16 rows in set (0.10 sec)
```
### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v6.7.0-alpha
Edition: Community
Git Commit Hash: 56412f514ecad4209cb0d92878b68644ed94469a
Git Branch: heads/refs/tags/v6.7.0-alpha
UTC Build Time: 2023-03-18 11:42:18
GoVersion: go1.20.2
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv |
