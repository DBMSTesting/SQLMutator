ID: 50498
Title: data race in import realtikv test
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```
==================
WARNING: DATA RACE
Read at 0x00c020c47018 by goroutine 69184:
  github.com/pingcap/tidb/pkg/disttask/importinto.(*ImportSchedulerExt).GetEligibleInstances()
      pkg/disttask/importinto/scheduler.go:336 +0xcb
  github.com/pingcap/tidb/pkg/disttask/importinto.(*importScheduler).GetEligibleInstances()
      <autogenerated>:1 +0x86
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.getEligibleNodes()
      pkg/disttask/framework/scheduler/scheduler.go:625 +0xb1
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balanceSubtasks()
      pkg/disttask/framework/scheduler/balancer.go:89 +0xd6
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balance()
      pkg/disttask/framework/scheduler/balancer.go:79 +0x2d6
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balanceLoop()
      pkg/disttask/framework/scheduler/balancer.go:63 +0x98
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).Start.func3()
      pkg/disttask/framework/scheduler/scheduler_manager.go:167 +0x71
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x9d

Previous write at 0x00c020c47018 by goroutine 466233:
  github.com/pingcap/tidb/pkg/disttask/importinto.updateMeta()
      pkg/disttask/importinto/scheduler.go:512 +0x86
  github.com/pingcap/tidb/pkg/disttask/importinto.updateResult()
      pkg/disttask/importinto/scheduler.go:568 +0x64b
  github.com/pingcap/tidb/pkg/disttask/importinto.(*ImportSchedulerExt).OnNextSubtasksBatch()
      pkg/disttask/importinto/scheduler.go:271 +0x82d
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).switch2NextStep()
      pkg/disttask/framework/scheduler/scheduler.go:449 +0x9c7
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).onRunning()
      pkg/disttask/framework/scheduler/scheduler.go:352 +0xb14
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).scheduleTask()
      pkg/disttask/framework/scheduler/scheduler.go:213 +0x13ea
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).ScheduleTask()
      pkg/disttask/framework/scheduler/scheduler.go:122 +0x27e
  github.com/pingcap/tidb/pkg/disttask/importinto.(*importScheduler).ScheduleTask()
      <autogenerated>:1 +0x3e
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).startScheduler.func1()
      pkg/disttask/framework/scheduler/scheduler_manager.go:321 +0x1d8
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).run.func1()
      pkg/resourcemanager/pool/spool/spool.go:144 +0xa7

Goroutine 69184 (running) created at:
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run()
      pkg/util/wait_group_wrapper.go:155 +0xf0
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).Start()
      pkg/disttask/framework/scheduler/scheduler_manager.go:166 +0x4ad
  github.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop.func2()
      pkg/domain/domain.go:1529 +0x324
  github.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop()
      pkg/domain/domain.go:1547 +0x5b6
  github.com/pingcap/tidb/pkg/domain.(*Domain).InitDistTaskLoop.func1()
      pkg/domain/domain.go:1500 +0xeb
  github.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:99 +0xf4

Goroutine 466233 (running) created at:
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).run()
      pkg/resourcemanager/pool/spool/spool.go:136 +0xf0
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).Run()
      pkg/resourcemanager/pool/spool/spool.go:116 +0x1b9
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).startScheduler()
      pkg/disttask/framework/scheduler/scheduler_manager.go:313 +0x89d
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).scheduleTaskLoop()
      pkg/disttask/framework/scheduler/scheduler_manager.go:251 +0x1446
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).scheduleTaskLoop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x9d
==================
==================
WARNING: DATA RACE
Read at 0x00c006c9d800 by goroutine 69184:
  encoding/json.checkValid()
      GOROOT/src/encoding/json/scanner.go:33 +0x10c
  encoding/json.Unmarshal()
      GOROOT/src/encoding/json/decode.go:102 +0xad
  github.com/pingcap/tidb/pkg/disttask/importinto.(*ImportSchedulerExt).GetEligibleInstances()
      pkg/disttask/importinto/scheduler.go:336 +0xf9
  github.com/pingcap/tidb/pkg/disttask/importinto.(*importScheduler).GetEligibleInstances()
      <autogenerated>:1 +0x86
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.getEligibleNodes()
      pkg/disttask/framework/scheduler/scheduler.go:625 +0xb1
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balanceSubtasks()
      pkg/disttask/framework/scheduler/balancer.go:89 +0xd6
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balance()
      pkg/disttask/framework/scheduler/balancer.go:79 +0x2d6
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*balancer).balanceLoop()
      pkg/disttask/framework/scheduler/balancer.go:63 +0x98
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).Start.func3()
      pkg/disttask/framework/scheduler/scheduler_manager.go:167 +0x71
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x9d

Previous write at 0x00c006c9d800 by goroutine 466233:
  runtime.slicecopy()
      GOROOT/src/runtime/slice.go:310 +0x0
  encoding/json.Marshal()
      GOROOT/src/encoding/json/encode.go:166 +0x1f2
  github.com/pingcap/tidb/pkg/disttask/importinto.updateMeta()
      pkg/disttask/importinto/scheduler.go:508 +0x47
  github.com/pingcap/tidb/pkg/disttask/importinto.updateResult()
      pkg/disttask/importinto/scheduler.go:568 +0x64b
  github.com/pingcap/tidb/pkg/disttask/importinto.(*ImportSchedulerExt).OnNextSubtasksBatch()
      pkg/disttask/importinto/scheduler.go:271 +0x82d
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).switch2NextStep()
      pkg/disttask/framework/scheduler/scheduler.go:449 +0x9c7
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).onRunning()
      pkg/disttask/framework/scheduler/scheduler.go:352 +0xb14
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).scheduleTask()
      pkg/disttask/framework/scheduler/scheduler.go:213 +0x13ea
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*BaseScheduler).ScheduleTask()
      pkg/disttask/framework/scheduler/scheduler.go:122 +0x27e
  github.com/pingcap/tidb/pkg/disttask/importinto.(*importScheduler).ScheduleTask()
      <autogenerated>:1 +0x3e
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).startScheduler.func1()
      pkg/disttask/framework/scheduler/scheduler_manager.go:321 +0x1d8
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).run.func1()
      pkg/resourcemanager/pool/spool/spool.go:144 +0xa7

Goroutine 69184 (running) created at:
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run()
      pkg/util/wait_group_wrapper.go:155 +0xf0
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).Start()
      pkg/disttask/framework/scheduler/scheduler_manager.go:166 +0x4ad
  github.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop.func2()
      pkg/domain/domain.go:1529 +0x324
  github.com/pingcap/tidb/pkg/domain.(*Domain).distTaskFrameworkLoop()
      pkg/domain/domain.go:1547 +0x5b6
  github.com/pingcap/tidb/pkg/domain.(*Domain).InitDistTaskLoop.func1()
      pkg/domain/domain.go:1500 +0xeb
  github.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:99 +0xf4

Goroutine 466233 (running) created at:
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).run()
      pkg/resourcemanager/pool/spool/spool.go:136 +0xf0
  github.com/pingcap/tidb/pkg/resourcemanager/pool/spool.(*Pool).Run()
      pkg/resourcemanager/pool/spool/spool.go:116 +0x1b9
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).startScheduler()
      pkg/disttask/framework/scheduler/scheduler_manager.go:313 +0x89d
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).scheduleTaskLoop()
      pkg/disttask/framework/scheduler/scheduler_manager.go:251 +0x1446
  github.com/pingcap/tidb/pkg/disttask/framework/scheduler.(*Manager).scheduleTaskLoop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x9d
==================
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->

