ID: 40535
Title: invalid memory address or nil pointer dereference during find_best_task
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
``` SQL
CREATE TABLE `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d` (
  `b0dceb86-8cc7-4793-8399-267b6203bd9e` bigint(20) NOT NULL DEFAULT '-2312745469307452950',
  `d7680f00-2bcc-47e7-a824-578f02596c62` datetime DEFAULT '5316-02-03 06:54:49',
  `43856708-fe5e-4621-a5f6-5bcae4388dbe` tinyblob DEFAULT NULL,
  PRIMARY KEY (`b0dceb86-8cc7-4793-8399-267b6203bd9e`) /*T![clustered_index] CLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

CREATE TABLE `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2` (
  `eb6dac0f-faf2-460e-b9cd-12c09d34ed02` set('kn8pu','7et','vekx6','v3','liwrh','q14','1met','nnd5i','5o0','8cz','l') DEFAULT '7et,vekx6,liwrh,q14,1met',
  `8ff9cf50-5f41-41ab-945c-0d3294b2df9d` float DEFAULT '1.683167',
  KEY `458a28d4-3bed-42ea-bad6-5166af85b71d` (`8ff9cf50-5f41-41ab-945c-0d3294b2df9d`,`eb6dac0f-faf2-460e-b9cd-12c09d34ed02`),
  KEY `ffa721d4-f094-4a56-9f73-27bf4fb75b4f` (`8ff9cf50-5f41-41ab-945c-0d3294b2df9d`)
) ENGINE=InnoDB DEFAULT CHARSET=gbk COLLATE=gbk_chinese_ci;

( select   /*+ agg_to_cop()  */  locate( `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` , `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` ) as r0 , `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` as r1 from `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d` where not( IsNull( `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`b0dceb86-8cc7-4793-8399-267b6203bd9e` ) )   order by r0,r1  ) union all ( select     concat_ws(',', `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`8ff9cf50-5f41-41ab-945c-0d3294b2df9d` , `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`eb6dac0f-faf2-460e-b9cd-12c09d34ed02` ) as r0 , `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`eb6dac0f-faf2-460e-b9cd-12c09d34ed02` as r1 from `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`    order by r0,r1  ) order by 1 limit 273;
```

### 2. What did you expect to see? (Required)
No error
### 3. What did you see instead (Required)
```
[conn.go:1058] ["connection running loop panic"] [conn=223449350066407177] [lastSQL="( select   /*+ agg_to_cop()  */  locate( `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` , `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` ) as r0 , `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`43856708-fe5e-4621-a5f6-5bcae4388dbe` as r1 from `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d` where not( IsNull( `eda2f928-9e08-4a11-b0a2-c9c74ac67a3d`.`b0dceb86-8cc7-4793-8399-267b6203bd9e` ) )   order by r0,r1  ) union all ( select     concat_ws(',', `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`8ff9cf50-5f41-41ab-945c-0d3294b2df9d` , `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`eb6dac0f-faf2-460e-b9cd-12c09d34ed02` ) as r0 , `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`.`eb6dac0f-faf2-460e-b9cd-12c09d34ed02` as r1 from `6b47f970-0e36-4b97-bf5f-c10a5f8e87d2`    order by r0,r1  ) order by 1 limit 273"] [err="runtime error: invalid memory address or nil pointer dereference"] [stack="github.com/pingcap/tidb/server.(*clientConn).Run.func1\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/conn.go:1061\nruntime.gopanic\n\t/usr/local/go1.19.3/src/runtime/panic.go:884\ngithub.com/pingcap/tidb/executor.(*Compiler).Compile.func1\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/executor/compiler.go:70\nruntime.gopanic\n\t/usr/local/go1.19.3/src/runtime/panic.go:884\nruntime.panicmem\n\t/usr/local/go1.19.3/src/runtime/panic.go:260\nruntime.sigpanic\n\t/usr/local/go1.19.3/src/runtime/signal_unix.go:835\ngithub.com/pingcap/tidb/planner/core.(*PhysicalTopN).getPushedDownTopN\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/task.go:926\ngithub.com/pingcap/tidb/planner/core.(*PhysicalTopN).attach2Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/task.go:976\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:252\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).findBestTask\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:440\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:224\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).findBestTask\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:440\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:224\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).findBestTask\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:440\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:224\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).findBestTask\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:440\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:224\ngithub.com/pingcap/tidb/planner/core.(*baseLogicalPlan).findBestTask\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/find_best_task.go:440\ngithub.com/pingcap/tidb/planner/core.physicalOptimize\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/optimizer.go:947\ngithub.com/pingcap/tidb/planner/core.DoOptimize\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/core/optimizer.go:296\ngithub.com/pingcap/tidb/planner.optimize\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/optimize.go:426\ngithub.com/pingcap/tidb/planner.Optimize\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/planner/optimize.go:254\ngithub.com/pingcap/tidb/executor.(*Compiler).Compile\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/executor/compiler.go:114\ngithub.com/pingcap/tidb/session.(*session).ExecuteStmt\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/session/session.go:2184\ngithub.com/pingcap/tidb/server.(*TiDBContext).ExecuteStmt\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/driver_tidb.go:247\ngithub.com/pingcap/tidb/server.(*clientConn).handleStmt\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/conn.go:2093\ngithub.com/pingcap/tidb/server.(*clientConn).handleQuery\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/conn.go:1943\ngithub.com/pingcap/tidb/server.(*clientConn).dispatch\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/conn.go:1374\ngithub.com/pingcap/tidb/server.(*clientConn).Run\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/conn.go:1123\ngithub.com/pingcap/tidb/server.(*Server).onConn\n\t/Users/pingcap/workspace/build-common/go/src/github.com/pingcap/tidb/server/server.go:625"]
```
### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->

