ID: 48034
Title: add index failed when inject ddl-owner-to-all-network-partition chaos
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、inject ddl owner network partition to all
2、add index
3. add index rollback
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
add index success
### 3. What did you see instead (Required)
add index rollback

[2023/10/15 11:02:25.144 +00:00] [INFO] [conn.go:1098] ["command dispatched failed"] [conn=2071989606] [session_alias=] [connInfo="id:2071989606, addr:10.233.98.63:50442 status:11, collation:latin1_swedish_ci, user:root"] [command=Execute] [status="inTxn:1, autocommit:1"] [sql="SELECT c FROM sbtest19 WHERE id=? [arguments: 34828256]"] [txn_mode=PESSIMISTIC] [timestamp=444954743629152315] [err="[tikv:9001]PD server timeout: \ngithub.com/pingcap/errors.AddStack\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/normalize.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/error.ToTiDBErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/error/error.go:112\ngithub.com/pingcap/tidb/pkg/store/driver/txn.extractKeyErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/error.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/txn.(*tikvSnapshot).Get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/snapshot.go:61\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:493\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).getAndLock\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:373\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:310\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/internal/exec/executor.go:283\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:1223\ngithub.com/pingcap/tidb/pkg/executor.(*recordSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:155\ngithub.com/pingcap/tidb/pkg/server/internal/resultset.(*tidbResultSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/internal/resultset/resultset.go:62\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeChunks\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2229\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeResultSet\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2172\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePreparedStmtAndWriteResult\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:419\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePlanCacheStmt\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:233\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).handleStmtExecute\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:225\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).dispatch\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1315\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).Run\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1067\ngithub.com/pingcap/tidb/pkg/server.(*Server).onConn\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/server.go:700\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650\nSELECT c FROM sbtest19 WHERE id=? [arguments: 34828256]"]
[2023/10/15 11:02:25.145 +00:00] [INFO] [txn.go:55] ["Try to create a new txn inside a transaction auto commit"] [conn=2071989606] [session_alias=] [schemaVersion=355] [txnStartTS=444954743629152315] [txnScope=global]
[2023/10/15 11:02:25.184 +00:00] [WARN] [backoff.go:172] ["pdRPC backoffer.maxSleep 40000ms is exceeded, errors:\nloadRegion from PD failed, key: \"7480000000000000F55F7280000000020E9A2E00\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:12.861854537Z\nloadRegion from PD failed, key: \"7480000000000000F55F7280000000020E9A2E00\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:18.540106974Z\nloadRegion from PD failed, key: \"7480000000000000F55F7280000000020E9A2E00\", err: rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing: dial tcp 10.233.83.156:2379: i/o timeout\" at 2023-10-15T11:02:22.25250348Z\ntotal-backoff-times: 22, backoff-detail: tikvRPC:2, regionMiss:1, pdRPC:19\nlongest sleep type: pdRPC, time: 40065ms"]
[2023/10/15 11:02:25.184 +00:00] [ERROR] [scheduler.go:474] [onError] [task-id=120026] [error="[tikv:9001]PD server timeout: "]
[2023/10/15 11:02:25.184 +00:00] [ERROR] [scheduler.go:480] ["scheduler error"] [task-id=120026] [error="[tikv:9001]PD server timeout: "]
[2023/10/15 11:02:25.184 +00:00] [WARN] [scheduler.go:589] ["subtask failed"] [task-id=120026] [error="[tikv:9001]PD server timeout: "]
[2023/10/15 11:02:25.248 +00:00] [WARN] [backoff.go:172] ["pdRPC backoffer.maxSleep 40000ms is exceeded, errors:\nloadRegion from PD failed, key: \"74800000000000014F5F728000000002147290\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:12.704648174Z\nloadRegion from PD failed, key: \"74800000000000014F5F728000000002147290\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:17.312943274Z\nloadRegion from PD failed, key: \"74800000000000014F5F728000000002147290\", err: rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing: dial tcp 10.233.83.156:2379: i/o timeout\" at 2023-10-15T11:02:22.252584047Z\ntotal-backoff-times: 21, backoff-detail: tikvRPC:2, regionMiss:1, pdRPC:18\nlongest sleep type: pdRPC, time: 40282ms"] [conn=2071989590] [session_alias=]
[2023/10/15 11:02:25.249 +00:00] [INFO] [conn.go:1098] ["command dispatched failed"] [conn=2071989590] [session_alias=] [connInfo="id:2071989590, addr:10.233.98.63:50422 status:11, collation:latin1_swedish_ci, user:root"] [command=Execute] [status="inTxn:1, autocommit:1"] [sql="SELECT c FROM sbtest2 WHERE id=? [arguments: 34894480]"] [txn_mode=PESSIMISTIC] [timestamp=444954743629152344] [err="[tikv:9001]PD server timeout: \ngithub.com/pingcap/errors.AddStack\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/normalize.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/error.ToTiDBErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/error/error.go:112\ngithub.com/pingcap/tidb/pkg/store/driver/txn.extractKeyErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/error.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/txn.(*tikvSnapshot).Get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/snapshot.go:61\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:493\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).getAndLock\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:373\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:310\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/internal/exec/executor.go:283\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:1223\ngithub.com/pingcap/tidb/pkg/executor.(*recordSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:155\ngithub.com/pingcap/tidb/pkg/server/internal/resultset.(*tidbResultSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/internal/resultset/resultset.go:62\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeChunks\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2229\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeResultSet\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2172\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePreparedStmtAndWriteResult\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:419\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePlanCacheStmt\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:233\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).handleStmtExecute\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:225\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).dispatch\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1315\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).Run\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1067\ngithub.com/pingcap/tidb/pkg/server.(*Server).onConn\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/server.go:700\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650\nSELECT c FROM sbtest2 WHERE id=? [arguments: 34894480]"]
[2023/10/15 11:02:25.249 +00:00] [INFO] [txn.go:55] ["Try to create a new txn inside a transaction auto commit"] [conn=2071989590] [session_alias=] [schemaVersion=355] [txnStartTS=444954743629152344] [txnScope=global]
[2023/10/15 11:02:25.249 +00:00] [WARN] [backoff.go:172] ["pdRPC backoffer.maxSleep 40000ms is exceeded, errors:\nloadRegion from PD failed, key: \"74800000000000011A5F72800000000278B7C8\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:13.075794292Z\nloadRegion from PD failed, key: \"74800000000000011A5F72800000000278B7C8\", err: rpc error: code = DeadlineExceeded desc = context deadline exceeded at 2023-10-15T11:02:17.722711011Z\nloadRegion from PD failed, key: \"74800000000000011A5F72800000000278B7C8\", err: rpc error: code = Unavailable desc = connection error: desc = \"transport: Error while dialing: dial tcp 10.233.83.156:2379: i/o timeout\" at 2023-10-15T11:02:22.252443307Z\ntotal-backoff-times: 23, backoff-detail: pdRPC:21, tikvRPC:1, regionMiss:1\nlongest sleep type: pdRPC, time: 41160ms"] [conn=2071989566] [session_alias=]
[2023/10/15 11:02:25.249 +00:00] [INFO] [conn.go:1098] ["command dispatched failed"] [conn=2071989566] [session_alias=] [connInfo="id:2071989566, addr:10.233.98.63:50344 status:11, collation:latin1_swedish_ci, user:root"] [command=Execute] [status="inTxn:1, autocommit:1"] [sql="SELECT c FROM sbtest47 WHERE id=? [arguments: 41465800]"] [txn_mode=PESSIMISTIC] [timestamp=444954743629152343] [err="[tikv:9001]PD server timeout: \ngithub.com/pingcap/errors.AddStack\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/errors.go:174\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/normalize.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/error.ToTiDBErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/error/error.go:112\ngithub.com/pingcap/tidb/pkg/store/driver/txn.extractKeyErr\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/error.go:164\ngithub.com/pingcap/tidb/pkg/store/driver/txn.(*tikvSnapshot).Get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/store/driver/txn/snapshot.go:61\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).get\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:493\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).getAndLock\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:373\ngithub.com/pingcap/tidb/pkg/executor.(*PointGetExecutor).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/point_get.go:310\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/internal/exec/executor.go:283\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:1223\ngithub.com/pingcap/tidb/pkg/executor.(*recordSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/executor/adapter.go:155\ngithub.com/pingcap/tidb/pkg/server/internal/resultset.(*tidbResultSet).Next\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/internal/resultset/resultset.go:62\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeChunks\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2229\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).writeResultSet\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:2172\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePreparedStmtAndWriteResult\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:419\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).executePlanCacheStmt\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:233\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).handleStmtExecute\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn_stmt.go:225\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).dispatch\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1315\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).Run\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/conn.go:1067\ngithub.com/pingcap/tidb/pkg/server.(*Server).onConn\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/server/server.go:700\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650\nSELECT c FROM sbtest47 WHERE id=? [arguments: 41465800]"]
[2023/10/15 11:02:25.250 +00:00] [INFO] [txn.go:55] ["Try to create a new txn inside a transaction auto commit"] [conn=2071989566] [session_alias=] [schemaVersion=355] [txnStartTS=444954743629152343] [txnScope=global]
### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->

