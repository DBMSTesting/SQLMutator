ID: 49743
Title: lightning failed with error ‚Äúruntime error: integer divide by zero‚Äù when pd rolling restart
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1„ÄÅrun lightning
2„ÄÅpd rolling restart after lightning starting 5mins

### 2. What did you expect to see? (Required)
lightning can success when pd rolling restart

### 3. What did you see instead (Required)
lightning failed when pd rolling restart

Verbose debug logs will be written to /tmp/lightning.log.2023-12-23T01.12.04Z
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  # | CHECK ITEM                                                                                                                         | TYPE        | PASSED |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  1 | Source data files size is proper                                                                                                   | performance | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  2 | the checkpoints are valid                                                                                                          | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  3 | table schemas are valid                                                                                                            | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  4 | all importing tables on the target are empty                                                                                       | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  5 | Cluster version check passed                                                                                                       | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  6 | Lightning has the correct storage permission                                                                                       | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  7 | local disk resources are rich, estimate sorted data size 26.05GiB, local available is 3.399TiB                                     | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|  8 | The storage space is rich, which TiKV/Tiflash is 5.289TiB/0B. The estimated storage space is 78.16GiB/0B.                          | performance | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
|[33m  9 [0m|[33m TiKV stores (19, 13, 4, 1) contains more than 1000 empty regions respectively, which will greatly affect the import speed and succ [0m|[33m performance [0m|[33m false  [0m|
|[33m    [0m|[33m ess rate                                                                                                                           [0m|[33m             [0m|[33m        [0m|
+[33m----[0m+[33m------------------------------------------------------------------------------------------------------------------------------------[0m+[33m-------------[0m+[33m--------[0m+
| 10 | Cluster region distribution is balanced                                                                                            | performance | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
| 11 | no CDC or PiTR task found                                                                                                          | critical    | true   |
+----+------------------------------------------------------------------------------------------------------------------------------------+-------------+--------+
tidb lightning encountered error: [Lightning:Restore:ErrRestoreTable]restore table `sysbench`.`user_data1` failed: runtime error: integer divide by zero

logsÔºö
[2023/12/23 01:19:05.771 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.772 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.772 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.916 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.916 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.917 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.959 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.960 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:05.960 +00:00] [ERROR] [local.go:1460] ["failed to get StoreInfo from pd http api"] [error="request pd http api failed with status: '503 Service Unavailable'"] [errorVerbose="request pd http api failed with status: '503 Service Unavailable'\[ngithub.com/tikv/pd/client/http.(*clientInner).doRequest\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242\ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156\ngithub.com/tikv/pd/client/http.(*client).request\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414\ngithub.com/tikv/pd/client/http.(*client).GetStore\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1650](http://ngithub.com/tikv/pd/client/http.(*clientInner).doRequest/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:242/ngithub.com/tikv/pd/client/http.(*clientInner).requestWithRetry/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:156/ngithub.com/tikv/pd/client/http.(*client).request/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/client.go:414/ngithub.com/tikv/pd/client/http.(*client).GetStore/n/t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20231219031951-25f48f0bdd27/http/interface.go:337/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1458/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75/nruntime.goexit/n/t/usr/local/go/src/runtime/asm_amd64.s:1650)"]
[2023/12/23 01:19:06.870 +00:00] [ERROR] [wait_group_wrapper.go:233] ["panic in error group"] [recover="runtime error: integer divide by zero"] [stack="[github.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7.1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:233\nruntime.gopanic\n\t/usr/local/go/src/runtime/panic.go:914\nruntime.panicdivide\n\t/usr/local/go/src/runtime/panic.go:240\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.checkDiskAvail\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1437\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1463\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75](http://github.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7.1/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:233/nruntime.gopanic/n/t/usr/local/go/src/runtime/panic.go:914/nruntime.panicdivide/n/t/usr/local/go/src/runtime/panic.go:240/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.checkDiskAvail/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1437/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).executeJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1463/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).startWorker/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1371/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.func5/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/local.go:1713/ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*Backend).doImport.(*ErrorGroupWithRecover).Go.func7/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/pkg/util/wait_group_wrapper.go:237/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.5.0/errgroup/errgroup.go:75)"]


### 4. What is your TiDB version? (Required)
./tidb-server -V
 Release Version: v7.6.0-alpha
Edition: Community
Git Commit Hash: 5c279d800774ae7ce5ff9934e1334740f1c7207b
Git Branch: heads/refs/tags/v7.6.0-alpha
UTC Build Time: 2023-12-21 07:56:10
GoVersion: go1.21.5
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2023-12-23T04:16:24.782+0800

