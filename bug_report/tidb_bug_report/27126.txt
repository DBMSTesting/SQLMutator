ID: 27126
Title: Test [udaf_avg_union] failed 
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!
```
[2021-08-11T11:21:42.520Z] 2021/08/11 19:21:42.110  [fatal] run test [udaf_avg_union] err: sql:select cast(avg(distinct `col_double_unsigned_key`) as decimal(30, 6)) as a from (select * from `table50_int_autoinc` union all select * from `table60_int_autoinc`) tmp group by tmp.`col_decimal_10_4_unsigned`, tmp.`col_decimal_6_3_unsigned` order by a;: failed to run query 

[2021-08-11T11:21:42.520Z] "select cast(avg(distinct `col_double_unsigned_key`) as decimal(30, 6)) as a from (select * from `table50_int_autoinc` union all select * from `table60_int_autoinc`) tmp group by tmp.`col_decimal_10_4_unsigned`, tmp.`col_decimal_6_3_unsigned` order by a;" 

[2021-08-11T11:21:42.520Z]  around line 559, 

[2021-08-11T11:21:42.520Z] we need(1046):

[2021-08-11T11:21:42.520Z] select cast(avg(distinct `col_double_unsigned_key`) as decimal(30, 6)) as a from (select * from `table50_int_autoinc` union all select * from `table60_int_autoinc`) tmp group by tmp.`col_decimal_10_4_unsigned`, tmp.`col_decimal_6_3_unsigned` order by a;

[2021-08-11T11:21:42.520Z] a

[2021-08-11T11:21:42.520Z] NULL

[2021-08-11T11:21:42.520Z] NULL

[2021-08-11T11:21:42.520Z] NULL

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.000000

[2021-08-11T11:21:42.520Z] 0.056173

[2021-08-11T11:21:42.520Z] 0.112345

[2021-08-11T11:21:42.520Z] 0.112345

[2021-08-11T11:21:42.520Z] 0.112345

[2021-08-11T11:21:42.520Z] 0.112345

[2021-08-11T11:21:42.520Z] 0.112345

[2021-08-11T11:21:42.520Z] 0.500000

[2021-08-11T11:21:42.520Z] 0.500000

[2021-08-11T11:21:42.520Z] 0.504500

[2021-08-11T11:21:42.520Z] 0.504500

[2021-08-11T11:21:42.520Z] 0.549391

[2021-08-11T11:21:42.520Z] 0.702594

[2021-08-11T11:21:42.520Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.009000

[2021-08-11T11:21:42.521Z] 1.009000

[2021-08-11T11:21:42.521Z] 1.053891

[2021-08-11T11:21:42.521Z] 1.098781

[2021-08-11T11:21:42.521Z] 1.098781

[2021-08-11T11:21:42.521Z] 6.493655

[2021-08-11T11:21:42.521Z] 6.493655

[2021-08-11T11:21:42.521Z] 6.769273

[2021-08-11T11:21:42.521Z] 12.987310

[2021-08-11T11:21:42.521Z] 12.991000

[2021-08-11T11:21:42.521Z] 12.991000

[2021-08-11T11:21:42.521Z] 12.991000

[2021-08-11T11:21:42.521Z] 25.000000

[2021-08-11T11:21:42.521Z] 26.000000

[2021-08-11T11:21:42.521Z] 42.000000

[2021-08-11T11:21:42.521Z] 2213.000000

[2021-08-11T11:21:42.521Z] 2688.000000

[2021-08-11T11:21:42.521Z] 18957.000000

[2021-08-11T11:21:42.521Z] 24717.000000

[2021-08-11T11:21:42.521Z] 26387.000000

[2021-08-11T11:21:42.521Z] select cast(avg(`col_bigint_unsigned_key`) as decimal(30,

[2021-08-11T11:21:42.521Z] but got(1046):

[2021-08-11T11:21:42.521Z] select cast(avg(distinct `col_double_unsigned_key`) as decimal(30, 6)) as a from (select * from `table50_int_autoinc` union all select * from `table60_int_autoinc`) tmp group by tmp.`col_decimal_10_4_unsigned`, tmp.`col_decimal_6_3_unsigned` order by a;

[2021-08-11T11:21:42.521Z] a

[2021-08-11T11:21:42.521Z] NULL

[2021-08-11T11:21:42.521Z] NULL

[2021-08-11T11:21:42.521Z] NULL

[2021-08-11T11:21:42.521Z] -25706.000000

[2021-08-11T11:21:42.521Z] -25410.000000

[2021-08-11T11:21:42.521Z] -14619.500000

[2021-08-11T11:21:42.521Z] -11129.000000

[2021-08-11T11:21:42.521Z] -10245.000000

[2021-08-11T11:21:42.521Z] -2748.000000

[2021-08-11T11:21:42.521Z] -119.000000

[2021-08-11T11:21:42.521Z] -111.121200

[2021-08-11T11:21:42.521Z] -111.121200

[2021-08-11T11:21:42.521Z] -111.121200

[2021-08-11T11:21:42.521Z] -111.121200

[2021-08-11T11:21:42.521Z] -88.000000

[2021-08-11T11:21:42.521Z] -86.000000

[2021-08-11T11:21:42.521Z] -5.091150

[2021-08-11T11:21:42.521Z] -4.591150

[2021-08-11T11:21:42.521Z] -1.000000

[2021-08-11T11:21:42.521Z] -1.000000

[2021-08-11T11:21:42.521Z] -0.987103

[2021-08-11T11:21:42.521Z] -0.987103

[2021-08-11T11:21:42.521Z] -0.987103

[2021-08-11T11:21:42.521Z] -0.987103

[2021-08-11T11:21:42.521Z] -0.987103

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.000000

[2021-08-11T11:21:42.521Z] 0.055839

[2021-08-11T11:21:42.521Z] 0.056173

[2021-08-11T11:21:42.521Z] 0.112345

[2021-08-11T11:21:42.521Z] 0.112345

[2021-08-11T11:21:42.521Z] 0.112345

[2021-08-11T11:21:42.521Z] 0.112345

[2021-08-11T11:21:42.521Z] 0.112345

[2021-08-11T11:21:42.521Z] 0.500000

[2021-08-11T11:21:42.521Z] 0.504500

[2021-08-11T11:21:42.521Z] 0.504500

[2021-08-11T11:21:42.521Z] 0.702594

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.000000

[2021-08-11T11:21:42.521Z] 1.009000

[2021-08-11T11:21:42.521Z] 1.009000

[2021-08-11T11:21:42.522Z] 1.053891

[2021-08-11T11:21:42.522Z] 1.098781

[2021-08-11T11:21:42.522Z] 1.098781

[2021-08-11T11:21:42.522Z] 1.902505

[2021-08-11T11:21:42.522Z] 6.493655

[2021-08-11T11:21:42.522Z] 6.769273

[2021-08-11T11:21:42.522Z] 12.987310

[2021-08-11T11:21:42.522Z] 12.991000

[2021-08-11T11:21:42.522Z] 12.991000

[2021-08-11T11:21:42.522Z] 12.991000

[2021-08-11T11:21:42.522Z] 25.000000

[2021-08-11T11:21:42.522Z] 26.000000

[2021-08-11T11:21:42.522Z] 42.000000

[2021-08-11T11:21:42.522Z] 2213.000000

[2021-08-11T11:21:42.522Z] 2624.500000

[2021-08-11T11:21:42.522Z] 18957.000000

[2021-08-11T11:21:42.522Z] 24717.000000

[2021-08-11T11:21:42.522Z] 26387.000000

[2021-08-11T11:21:42.522Z] 

[2021-08-11T11:21:42.522Z] 

script returned exit code 1
```

### 1. Minimal reproduce step (Required)

ci: https://ci.pingcap.net/blue/organizations/jenkins/tidb_ghpr_integration_common_test/detail/tidb_ghpr_integration_common_test/6101/pipeline/137

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)



