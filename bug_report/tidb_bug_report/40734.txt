ID: 40734
Title: DATA RACE in the Job 
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
==================
WARNING: DATA RACE
Write at 0x00c0096d6458 by goroutine 205781:
  github.com/pingcap/tidb/ddl.(*ddl).addBatchDDLJobs2Table()
      ddl/ddl_worker.go:365 +0x6a8
  github.com/pingcap/tidb/ddl.(*ddl).addBatchDDLJobs()
      ddl/ddl_worker.go:213 +0x12c
  github.com/pingcap/tidb/ddl.(*ddl).limitDDLJobs()
      ddl/ddl_worker.go:199 +0xeb
  github.com/pingcap/tidb/ddl.(*ddl).limitDDLJobs-fm()
      <autogenerated>:1 +0x39
  github.com/pingcap/tidb/util.(*WaitGroupWrapper).Run.func1()
      util/wait_group_wrapper.go:154 +0x87
Previous read at 0x00c0096d6458 by goroutine 185314:
  reflect.Value.Int()
      GOROOT/src/reflect/value.go:1457 +0xf7
  encoding/json.intEncoder()
      GOROOT/src/encoding/json/encode.go:551 +0x45
  encoding/json.structEncoder.encode()
      GOROOT/src/encoding/json/encode.go:760 +0x2ba
  encoding/json.structEncoder.encode-fm()
      <autogenerated>:1 +0xdb
  encoding/json.ptrEncoder.encode()
      GOROOT/src/encoding/json/encode.go:944 +0x3c2
  encoding/json.ptrEncoder.encode-fm()
      <autogenerated>:1 +0x90
  encoding/json.(*encodeState).reflectValue()
      GOROOT/src/encoding/json/encode.go:359 +0x88
  encoding/json.(*encodeState).marshal()
      GOROOT/src/encoding/json/encode.go:331 +0x20b
  encoding/json.Marshal()
      GOROOT/src/encoding/json/encode.go:160 +0x51
  github.com/pingcap/tidb/parser/model.(*Job).Encode()
      parser/model/ddl.go:633 +0x34b
  github.com/pingcap/tidb/parser/model.(*Job).Clone()
      parser/model/ddl.go:552 +0x5d
  github.com/pingcap/tidb/ddl.(*ddl).DoDDLJob()
      ddl/ddl.go:952 +0x335
  github.com/pingcap/tidb/ddl.(*ddl).MultiSchemaChange()
      ddl/multi_schema_change.go:59 +0xa29
  github.com/pingcap/tidb/ddl.(*ddl).AlterTable()
      ddl/ddl_api.go:3523 +0x33e5
  github.com/pingcap/tidb/executor.(*DDLExec).executeAlterTable()
      executor/ddl.go:383 +0x2cb
  github.com/pingcap/tidb/executor.(*DDLExec).Next()
      executor/ddl.go:147 +0x591
  github.com/pingcap/tidb/executor.Next()
      executor/executor.go:328 +0x632
  github.com/pingcap/tidb/executor.(*ExecStmt).next()
      executor/adapter.go:1198 +0x9d
  github.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelayExecutor()
      executor/adapter.go:950 +0x779
  github.com/pingcap/tidb/executor.(*ExecStmt).handleNoDelay()
      executor/adapter.go:779 +0x404
  github.com/pingcap/tidb/executor.(*ExecStmt).Exec()
      executor/adapter.go:574 +0x146d
  github.com/pingcap/tidb/session.runStmt()
      session/session.go:2353 +0x85c
  github.com/pingcap/tidb/session.(*session).ExecuteStmt()
      session/session.go:2217 +0x11c4
  github.com/pingcap/tidb/testkit.(*TestKit).ExecWithContext()
      testkit/testkit.go:321 +0x84e
  github.com/pingcap/tidb/testkit.(*TestKit).MustExecWithContext()
      testkit/testkit.go:130 +0xb7
  github.com/pingcap/tidb/testkit.(*TestKit).MustExec()
      testkit/testkit.go:125 +0xf7
  github.com/pingcap/tidb/ddl_test.TestMultiSchemaChangeDropIndexesParallel.func1()
      ddl/multi_schema_change_test.go:692 +0x47
  github.com/pingcap/tidb/ddl_test.putTheSameDDLJobTwice()
      ddl/multi_schema_change_test.go:1310 +0x79
  github.com/pingcap/failpoint.parseTerm()
      external/com_github_pingcap_failpoint/terms.go:149 +0x389
  github.com/pingcap/failpoint.parse()
      external/com_github_pingcap_failpoint/terms.go:126 +0xa8
  github.com/pingcap/failpoint.newTerms()
      external/com_github_pingcap_failpoint/terms.go:98 +0x50
  github.com/pingcap/failpoint.(*Failpoint).Enable()
      external/com_github_pingcap_failpoint/failpoint.go:54 +0x44
  github.com/pingcap/failpoint.(*Failpoints).Enable()
      external/com_github_pingcap_failpoint/failpoints.go:105 +0x276
  github.com/pingcap/failpoint.Enable()
      external/com_github_pingcap_failpoint/failpoints.go:222 +0x50
  github.com/pingcap/tidb/ddl_test.putTheSameDDLJobTwice()
      ddl/multi_schema_change_test.go:1308 +0x2c
  github.com/pingcap/tidb/ddl_test.TestMultiSchemaChangeDropIndexesParallel()
      ddl/multi_schema_change_test.go:691 +0xba
  github.com/pingcap/tidb/domain.(*Domain).LoadSysVarCacheLoop()
      domain/domain.go:1383 +0xb9
  github.com/pingcap/tidb/session.BootstrapSession()
      session/session.go:3339 +0x78c
  github.com/pingcap/tidb/domain.(*Domain).GetSessionCache()
      domain/sysvar_cache.go:62 +0x6a
  github.com/pingcap/tidb/session.(*session).loadCommonGlobalVariablesIfNeeded()
      session/session.go:3658 +0x11e
  github.com/pingcap/tidb/session.(*session).ExecuteStmt()
      session/session.go:2136 +0x2fb
  github.com/pingcap/tidb/session.(*session).ExecuteInternal()
      session/session.go:1670 +0x4eb
  github.com/pingcap/tidb/domain.(*Domain).LoadPrivilegeLoop()
      domain/domain.go:1327 +0x143
  github.com/pingcap/tidb/session.BootstrapSession()
      session/session.go:3332 +0x72c
  github.com/pingcap/tidb/testkit.bootstrap()
      testkit/mockstore.go:85 +0x84
  github.com/pingcap/tidb/testkit.CreateMockStoreAndDomain()
      testkit/mockstore.go:70 +0xd0
  github.com/pingcap/tidb/testkit.CreateMockStore()
      testkit/mockstore.go:62 +0x3b2
  github.com/pingcap/tidb/ddl_test.TestMultiSchemaChangeDropIndexesParallel()
      ddl/multi_schema_change_test.go:687 +0x3e
  testing.tRunner()
      GOROOT/src/testing/testing.go:1446 +0x216
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1493 +0x47
Goroutine 205781 (running) created at:
  github.com/pingcap/tidb/util.(*WaitGroupWrapper).Run()
      util/wait_group_wrapper.go:152 +0xf6
  github.com/pingcap/tidb/ddl.(*ddl).Start()
      ddl/ddl.go:683 +0x311
  github.com/pingcap/tidb/domain.(*Domain).Init()
      domain/domain.go:1052 +0x14d9
  github.com/pingcap/tidb/session.(*domainMap).Get.func1()
      session/tidb.go:91 +0x67c
  github.com/pingcap/tidb/util.RunWithRetry()
      util/misc.go:69 +0xbe
  github.com/pingcap/tidb/session.(*domainMap).Get()
      session/tidb.go:77 +0x2f8
  github.com/pingcap/tidb/session.createSessionWithOpt()
      session/session.go:3515 +0x86
  github.com/pingcap/tidb/session.createSession()
      session/session.go:3511 +0x49
  github.com/pingcap/tidb/session.createSessions()
      session/session.go:3496 +0x9a
  github.com/pingcap/tidb/session.BootstrapSession()
      session/session.go:3299 +0x415
  github.com/pingcap/tidb/testkit.bootstrap()
      testkit/mockstore.go:85 +0x84
  github.com/pingcap/tidb/testkit.CreateMockStoreAndDomain()
      testkit/mockstore.go:70 +0xd0
  github.com/pingcap/tidb/testkit.CreateMockStore()
      testkit/mockstore.go:62 +0x3b2
  github.com/pingcap/tidb/ddl_test.TestMultiSchemaChangeDropIndexesParallel()
      ddl/multi_schema_change_test.go:687 +0x3e
  testing.tRunner()
      GOROOT/src/testing/testing.go:1446 +0x216
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1493 +0x47
Goroutine 185314 (running) created at:
  testing.(*T).Run()
      GOROOT/src/testing/testing.go:1493 +0x75d
  testing.runTests.func1()
      GOROOT/src/testing/testing.go:1846 +0x99
  testing.tRunner()
      GOROOT/src/testing/testing.go:1446 +0x216
  testing.runTests()
      GOROOT/src/testing/testing.go:1844 +0x7ec
  testing.(*M).Run()
      GOROOT/src/testing/testing.go:1726 +0xa84
  go.uber.org/goleak.VerifyTestMain()
      external/org_uber_go_goleak/testmain.go:53 +0x70
  github.com/pingcap/tidb/ddl_test.TestMain()
      ddl/main_test.go:71 +0x93a
  main.main()
      bazel-out/k8-fastbuild/bin/ddl/ddl_test_/testmain.go:1362 +0x7c9
==================
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

