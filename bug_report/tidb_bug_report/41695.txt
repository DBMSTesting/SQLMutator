ID: 41695
Title: The result of tpcc check is not correct
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
1. tpcc 100 and run workload 
2. execute the check query
```sql
SELECT
    COUNT(*)
FROM
    (
        SELECT
            o_ol_cnt,
            order_line_count
        FROM
            orders
            LEFT JOIN (
                SELECT
                    ol_w_id,
                    ol_d_id,
                    ol_o_id,
                    count(*) order_line_count
                FROM
                    order_line
                GROUP BY
                    ol_w_id,
                    ol_d_id,
                    ol_o_id
                ORDER by
                    ol_w_id,
                    ol_d_id,
                    ol_o_id
            ) AS order_line ON orders.o_w_id = order_line.ol_w_id
            AND orders.o_d_id = order_line.ol_d_id
            AND orders.o_id = order_line.ol_o_id
        WHERE
            orders.o_w_id = 1
    ) AS T
WHERE
    T.o_ol_cnt != T.order_line_count;
```

```
+-------------------------------------+-----------+---------+-----------+-----------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| id                                  | estRows   | actRows | task      | access object                                                         | execution info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | operator info                                                                                                                                                                                                                                                                                                               | memory   | disk    |
+-------------------------------------+-----------+---------+-----------+-----------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
| HashAgg_14                          | 1.00      | 1       | root      |                                                                       | time:8.83ms, loops:2, partial_worker:{wall_time:8.730339ms, concurrency:5, task_num:1, tot_wait:43.151648ms, tot_exec:3.938µs, tot_time:43.162971ms, max:8.657089ms, p95:8.657089ms}, final_worker:{wall_time:0s, concurrency:5, task_num:1, tot_wait:43.450326ms, tot_exec:49.456µs, tot_time:43.503606ms, max:8.757508ms, p95:8.757508ms}                                                                                                                                                                                                         | funcs:count(1)->Column#22                                                                                                                                                                                                                                                                                                   | 6.18 KB  | N/A     |
| └─IndexHashJoin_22                  | 30289.82  | 1       | root      |                                                                       | time:8.64ms, loops:2, inner:{total:13.9ms, concurrency:5, task:3, construct:833.9µs, fetch:12.4ms, build:131.4µs, join:634.5µs}                                                                                                                                                                                                                                                                                                                                                                                                                     | inner join, inner:IndexLookUp_19, outer key:tpcc.order_line.ol_d_id, tpcc.order_line.ol_o_id, inner key:tpcc.orders.o_d_id, tpcc.orders.o_id, equal cond:eq(tpcc.order_line.ol_d_id, tpcc.orders.o_d_id), eq(tpcc.order_line.ol_o_id, tpcc.orders.o_id), other cond:ne(tpcc.orders.o_ol_cnt, Column#21)                     | 208.0 KB | N/A     |
|   ├─Sort_31(Build)                  | 30.29     | 197     | root      |                                                                       | time:2.83ms, loops:5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | tpcc.order_line.ol_w_id, tpcc.order_line.ol_d_id, tpcc.order_line.ol_o_id                                                                                                                                                                                                                                                   | 14.0 KB  | 0 Bytes |
|   │ └─HashAgg_39                    | 30.29     | 197     | root      |                                                                       | time:2.46ms, loops:6, partial_worker:{wall_time:2.224747ms, concurrency:5, task_num:1, tot_wait:6.757382ms, tot_exec:258.04µs, tot_time:7.176359ms, max:1.73855ms, p95:1.73855ms}, final_worker:{wall_time:2.480837ms, concurrency:5, task_num:5, tot_wait:9.808255ms, tot_exec:1.042222ms, tot_time:10.855189ms, max:2.323146ms, p95:2.323146ms}                                                                                                                                                                                                   | group by:tpcc.order_line.ol_d_id, tpcc.order_line.ol_o_id, tpcc.order_line.ol_w_id, funcs:count(Column#27)->Column#21, funcs:firstrow(tpcc.order_line.ol_o_id)->tpcc.order_line.ol_o_id, funcs:firstrow(tpcc.order_line.ol_d_id)->tpcc.order_line.ol_d_id, funcs:firstrow(tpcc.order_line.ol_w_id)->tpcc.order_line.ol_w_id | 104.2 KB | N/A     |
|   │   └─IndexReader_40              | 30.29     | 197     | root      |                                                                       | time:1.32ms, loops:2, cop_task: {num: 1, max: 1.79ms, proc_keys: 0, rpc_num: 1, rpc_time: 1.56ms, copr_cache_hit_ratio: 1.00, build_task_duration: 9.83µs, max_distsql_concurrency: 1}                                                                                                                                                                                                                                                                                                                                                              | index:HashAgg_33                                                                                                                                                                                                                                                                                                            | 6.41 KB  | N/A     |
|   │     └─HashAgg_33                | 30.29     | 197     | cop[tikv] |                                                                       | tikv_task:{time:2ms, loops:2}, scan_detail: {get_snapshot_time: 693.6µs, rocksdb: {block: {}}}                                                                                                                                                                                                                                                                                                                                                                                                                                                      | group by:tpcc.order_line.ol_d_id, tpcc.order_line.ol_o_id, tpcc.order_line.ol_w_id, funcs:count(1)->Column#27                                                                                                                                                                                                               | N/A      | N/A     |
|   │       └─IndexRangeScan_38       | 302661.12 | 2048    | cop[tikv] | table:order_line, index:PRIMARY(ol_w_id, ol_d_id, ol_o_id, ol_number) | tikv_task:{time:1ms, loops:2}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | range:[1,1], keep order:false                                                                                                                                                                                                                                                                                               | N/A      | N/A     |
|   └─IndexLookUp_19(Probe)           | 30.29     | 197     | root      |                                                                       | time:11.4ms, loops:6, index_task: {total_time: 5.94ms, fetch_handle: 5.93ms, build: 2.98µs, wait: 3.24µs}, table_task: {total_time: 4.89ms, num: 3, concurrency: 5}, next: {wait_index: 6.5ms, wait_table_lookup_build: 202.2µs, wait_table_lookup_resp: 4.54ms}                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                             | 11.5 KB  | N/A     |
|     ├─IndexRangeScan_16(Build)      | 30.29     | 197     | cop[tikv] | table:orders, index:PRIMARY(o_w_id, o_d_id, o_id)                     | time:5.89ms, loops:9, cop_task: {num: 3, max: 2.93ms, min: 1.05ms, avg: 1.85ms, p95: 2.93ms, max_proc_keys: 64, p95_proc_keys: 64, tot_proc: 1ms, rpc_num: 3, rpc_time: 5.45ms, copr_cache_hit_ratio: 0.33, build_task_duration: 69µs, max_distsql_concurrency: 1}, tikv_task:{proc max:2ms, min:0s, avg: 1.33ms, p80:2ms, p95:2ms, iters:6, tasks:3}, scan_detail: {total_process_keys: 69, total_process_keys_size: 4278, total_keys: 138, get_snapshot_time: 694.6µs, rocksdb: {key_skipped_count: 69, block: {cache_hit_count: 138}}}           | range: decided by [eq(tpcc.orders.o_d_id, tpcc.order_line.ol_d_id) eq(tpcc.orders.o_id, tpcc.order_line.ol_o_id) eq(tpcc.orders.o_w_id, 1)], keep order:false                                                                                                                                                               | N/A      | N/A     |
|     └─Selection_18(Probe)           | 30.29     | 197     | cop[tikv] |                                                                       | time:4.43ms, loops:6, cop_task: {num: 3, max: 1.51ms, min: 1.1ms, avg: 1.36ms, p95: 1.51ms, max_proc_keys: 128, p95_proc_keys: 128, rpc_num: 3, rpc_time: 3.92ms, copr_cache_hit_ratio: 0.00, build_task_duration: 40.7µs, max_distsql_concurrency: 1, max_extra_concurrency: 1}, tikv_task:{proc max:0s, min:0s, avg: 0s, p80:0s, p95:0s, iters:6, tasks:3}, scan_detail: {total_process_keys: 197, total_process_keys_size: 14441, total_keys: 200, get_snapshot_time: 507.6µs, rocksdb: {key_skipped_count: 197, block: {cache_hit_count: 6}}}   | not(isnull(tpcc.orders.o_ol_cnt))                                                                                                                                                                                                                                                                                           | N/A      | N/A     |
|       └─TableRowIDScan_17           | 30.29     | 197     | cop[tikv] | table:orders                                                          | tikv_task:{proc max:0s, min:0s, avg: 0s, p80:0s, p95:0s, iters:6, tasks:3}                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | keep order:false                                                                                                                                                                                                                                                                                                            | N/A      | N/A     |
+-------------------------------------+-----------+---------+-----------+-----------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+
```

### 2. What did you expect to see? (Required)
0
### 3. What did you see instead (Required)
1
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
master
Release Version: v6.7.0-alpha
Edition: Community
Git Commit Hash: 7cac20ee19eceda4c222de243bd97af34ddaff8d
Git Branch: heads/refs/tags/v6.7.0-alpha
UTC Build Time: 2023-02-23 06:44:36
GoVersion: go1.19.5
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv