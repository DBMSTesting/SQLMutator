ID: 40525
Title: lighting parallel import single table with duplicate fail for "tidb lightning encountered error: collect local duplicate rows f ailed: region unavailable"
Description:
## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. use two lightning nodes to parallelly import single table with duplicate rows and million data
2. check duplicate rows

### 2. What did you expect to see? (Required)
import successfully

### 3. What did you see instead (Required)
```code
[2023/01/11 18:55:13.599 +00:00] [ERROR] [local.go:1693] ["[detect-dupe] collect local duplicate keys failed"] [table=`IFRS9`.`ECL_RETAIL_LOAN_BIZ_INFO`] [takeTime=1m30.020958815s] [error="collect local duplicate rows failed: region unavailable"]
[2023/01/11 18:55:13.600 +00:00] [ERROR] [table_restore.go:792] ["collect local duplicate keys failed"] [table=`IFRS9`.`ECL_RETAIL_LOAN_BIZ_INFO`] [error="collect local duplicate rows failed: region unavailable"]
[2023/01/11 18:55:13.600 +00:00] [ERROR] [restore.go:1542] ["restore all tables data failed"] [takeTime=5m9.787286s] [error="collect local duplicate rows failed: region unavailable"]
[2023/01/11 18:55:13.600 +00:00] [INFO] [restore.go:1185] ["everything imported, stopping periodic actions"]
[2023/01/11 18:55:13.602 +00:00] [ERROR] [restore.go:479] ["run failed"] [step=4] [error="collect local duplicate rows failed: region unavailable"]
[2023/01/11 18:55:13.602 +00:00] [ERROR] [restore.go:489] ["the whole procedure failed"] [takeTime=5m12.809853632s] [error="collect local duplicate rows failed: region unavailable"]
[2023/01/11 18:55:13.602 +00:00] [WARN] [errormanager.go:472] ["Detect 1723424 data type errors in total, please refer to table `lightning_task_info`.`conflict_error_v1` for more details"]
[2023/01/11 18:55:13.697 +00:00] [ERROR] [main.go:103] ["tidb lightning encountered error stack info"] [error="collect local duplicate rows failed: region unavailable"] [errorVerbose="region unavailable\ngithub.com/tikv/client-go/v2/error.init\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/error/error.go:83\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6329\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.doInit\n\t/usr/local/go/src/runtime/proc.go:6306\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:233\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1594\ngithub.com/tikv/client-go/v2/internal/retry.(*Backoffer).BackoffWithCfgAndMaxSleep\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/internal/retry/backoff.go:160\ngithub.com/tikv/client-go/v2/internal/retry.(*Backoffer).Backoff\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/internal/retry/backoff.go:120\ngithub.com/tikv/client-go/v2/txnkv/txnsnapshot.(*KVSnapshot).batchGetSingleRegion\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/txnkv/txnsnapshot/snapshot.go:425\ngithub.com/tikv/client-go/v2/txnkv/txnsnapshot.(*KVSnapshot).batchGetKeysByRegions.func3\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/txnkv/txnsnapshot/snapshot.go:347\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1594\ngithub.com/tikv/client-go/v2/txnkv/txnsnapshot.(*KVSnapshot).batchGetKeysByRegions\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/txnkv/txnsnapshot/snapshot.go:355\ngithub.com/tikv/client-go/v2/txnkv/txnsnapshot.(*KVSnapshot).BatchGet\n\t/go/pkg/mod/github.com/tikv/client-go/v2@v2.0.5-0.20230110071533-f313ddf58d73/txnkv/txnsnapshot/snapshot.go:234\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).saveIndexHandles\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:472\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).RecordIndexConflictError\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:522\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).CollectDuplicateRowsFromDupDB.func1.1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:678\ngithub.com/pingcap/tidb/br/pkg/lightning/common.Retry\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/common/util.go:180\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).CollectDuplicateRowsFromDupDB.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:672\ngithub.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/worker.go:76\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1594\ngithub.com/pingcap/errors.AddStack\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/errors.go:174\ngithub.com/pingcap/errors.Trace\n\t/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20221009092201-b66cddb77c32/juju_adaptor.go:15\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).saveIndexHandles\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:474\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).RecordIndexConflictError\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:522\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).CollectDuplicateRowsFromDupDB.func1.1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:678\ngithub.com/pingcap/tidb/br/pkg/lightning/common.Retry\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/common/util.go:180\ngithub.com/pingcap/tidb/br/pkg/lightning/backend/local.(*DuplicateManager).CollectDuplicateRowsFromDupDB.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/lightning/backend/local/duplicate.go:672\ngithub.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/worker.go:76\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:75\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1594\ncollect local duplicate rows failed"]
```
### 4. What is your TiDB version? (Required)

[2023/01/11 18:49:59.893 +00:00] [INFO] [info.go:49] ["Welcome to TiDB-Lightning"] [release-version=v6.6.0-alpha] [git-hash=cefb26146b016a34739918ddd344972debb19ff9] [git-branch=heads/refs/tags/v6.6.0-alpha] [go-version=go1.19.3] [utc-build-time="2023-01-11 11:43:07"] [race-enabled=false]

