ID: 75189
Title: Logical error on incorrect number of arguments to function tumble
Description:
```sql
CREATE WINDOW VIEW re3.v TO out                                                                                                            
(                                                                                                                                          
    `k` String,                                                                                                                                                                                                                                                                       
    `s` Int64                                                                                                                              
) INNER                                                                                                                                                                                                                                                                               
ENGINE = ReplicatedAggregatingMergeTree                                                                                                    
ORDER BY x                                                           
AS SELECT                 
    k,                                                               
    sum(v),                                                                                                                                
    tumbleStart(now()) AS s                                                                                                                                                                                                                                                           
FROM re3.in                                                                                                                                                                                                                                                                           
GROUP BY tumble(now())                                                                                                                     
SETTINGS allow_experimental_window_view = 1, allow_experimental_analyzer = 0                                                               
                                                                                                                                                                                                                                                                                      
Query id: aa64d612-c94b-4734-9d22-804356220d1c                                                                                                                                                                                                                                        
                                                                                                                                           
[ip-172-31-8-116] 2025.01.29 03:37:53.138547 [ 3105375 ] {aa64d612-c94b-4734-9d22-804356220d1c} <Fatal> : Logical error: 'std::exception. Code: 1001, type: std::out_of_range, e.what() = `InlinedVector::at(size_type) const` failed bounds check (version 25.2.1.1), Stack trace:   
                                                                                                                                                                                                                                                                                      
0. /home/ubuntu/ClickHouse/contrib/llvm-project/libcxx/include/__exception/exception.h:106: std::logic_error::logic_error(char const*) @ 0x000000001a8d8954                                                                                                                           
1. /home/ubuntu/ClickHouse/contrib/llvm-project/libcxx/include/stdexcept:163: std::out_of_range::out_of_range[abi:se180100](char const*) @ 0x0000000007727ea9                                                                                                                         
2. /home/ubuntu/ClickHouse/contrib/abseil-cpp/absl/base/internal/throw_delegate.cc:110: absl::base_internal::ThrowStdOutOfRange(char const*) @ 0x000000001a8809df                                                                                                                     
3. /home/ubuntu/ClickHouse/contrib/abseil-cpp/absl/container/inlined_vector.h:395: DB::StorageWindowView::innerQueryParser(DB::ASTSelectQuery const&) @ 0x00000000144ea336                                                                                                            
4. /home/ubuntu/ClickHouse/src/Storages/WindowView/StorageWindowView.cpp:1332: DB::StorageWindowView::initInnerQuery(DB::ASTSelectQuery, std::shared_ptr<DB::Context const>) @ 0x00000000144dce7b                                                                                     
5. /home/ubuntu/ClickHouse/src/Storages/WindowView/StorageWindowView.cpp:1263: DB::StorageWindowView::StorageWindowView(DB::StorageID const&, std::shared_ptr<DB::Context const>, DB::ASTCreateQuery const&, DB::ColumnsDescription const&, String const&, DB::LoadingStrictnessLevel)
 @ 0x00000000144e6e63                                                                                                                                                                                                                                                                 
6. /home/ubuntu/ClickHouse/contrib/llvm-project/libcxx/include/__memory/construct_at.h:41: std::shared_ptr<DB::StorageWindowView> std::allocate_shared[abi:se180100]<DB::StorageWindowView, std::allocator<DB::StorageWindowView>, DB::StorageID const&, std::shared_ptr<DB::Context>,
 DB::ASTCreateQuery const&, DB::ColumnsDescription const&, String const&, DB::LoadingStrictnessLevel const&, void>(std::allocator<DB::StorageWindowView> const&, DB::StorageID const&, std::shared_ptr<DB::Context>&&, DB::ASTCreateQuery const&, DB::ColumnsDescription const&, Strin
g const&, DB::LoadingStrictnessLevel const&) @ 0x00000000144f856f                                                                                                                                                                                                                     
7. /home/ubuntu/ClickHouse/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:831: std::shared_ptr<DB::IStorage> std::__function::__policy_invoker<std::shared_ptr<DB::IStorage> (DB::StorageFactory::Arguments const&)>::__call_impl[abi:se180100]<std::__function::__default_
alloc_func<DB::registerStorageWindowView(DB::StorageFactory&)::$_0, std::shared_ptr<DB::IStorage> (DB::StorageFactory::Arguments const&)>>(std::__function::__policy_storage const*, DB::StorageFactory::Arguments const&) @ 0x00000000144f1e6d                                       
8. /home/ubuntu/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:714: ? @ 0x0000000013b810e2                                                                                                                                                                    
9. /home/ubuntu/ClickHouse/src/Interpreters/InterpreterCreateQuery.cpp:1910: DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&, DB::LoadingStrictne
ssLevel) @ 0x000000001252c3e0                                                                                                                                                                                                                                                         
10. /home/ubuntu/ClickHouse/src/Interpreters/InterpreterCreateQuery.cpp:1722: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x0000000012525ef2                                                                                                                       
11. /home/ubuntu/ClickHouse/src/Interpreters/InterpreterCreateQuery.cpp:2301: DB::InterpreterCreateQuery::execute() @ 0x0000000012532021                                                                                                                                              
12. /home/ubuntu/ClickHouse/src/Interpreters/executeQuery.cpp:1457: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x0000000012b0e960                    
13. /home/ubuntu/ClickHouse/src/Interpreters/executeQuery.cpp:1760: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::shared_ptr<DB::Context>, std::function<void (DB::QueryResultDetails const&)>, DB::QueryFlags, std::optional<DB::FormatSettings> const&, std::functi
on<void (DB::IOutputFormat&, String const&, std::shared_ptr<DB::Context const> const&, std::optional<DB::FormatSettings> const&)>) @ 0x0000000012b12566                                                                                                                               
14. /home/ubuntu/ClickHouse/src/Interpreters/DDLWorker.cpp:508: DB::DDLWorker::tryExecuteQuery(DB::DDLTaskBase&, std::shared_ptr<zkutil::ZooKeeper> const&) @ 0x00000000121227a3                                                                                                      
15. /home/ubuntu/ClickHouse/src/Interpreters/DDLWorker.cpp:672: DB::DDLWorker::processTask(DB::DDLTaskBase&, std::shared_ptr<zkutil::ZooKeeper> const&) @ 0x0000000012120c47                                                                                                          
16. /home/ubuntu/ClickHouse/src/Databases/DatabaseReplicatedWorker.cpp:371: DB::DatabaseReplicatedDDLWorker::tryEnqueueAndExecuteEntry(DB::DDLLogEntry&, std::shared_ptr<DB::Context const>) @ 0x0000000011c8820e                                                                     
17. /home/ubuntu/ClickHouse/src/Databases/DatabaseReplicated.cpp:1087: DB::DatabaseReplicated::tryEnqueueReplicatedDDL(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const>, DB::QueryFlags) @ 0x0000000011c61f2e                                                     
18. /home/ubuntu/ClickHouse/src/Interpreters/InterpreterCreateQuery.cpp:1702: DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x0000000012525a14                                                                                                                       
19. /home/ubuntu/ClickHouse/src/Interpreters/InterpreterCreateQuery.cpp:2301: DB::InterpreterCreateQuery::execute() @ 0x0000000012532021
20. /home/ubuntu/ClickHouse/src/Interpreters/executeQuery.cpp:1457: DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, DB::ReadBuffer*, std::shared_ptr<DB::IAST>&) @ 0x0000000012b0e960
21. /home/ubuntu/ClickHouse/src/Interpreters/executeQuery.cpp:1623: DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x0000000012b09f6b
22. /home/ubuntu/ClickHouse/src/Server/TCPHandler.cpp:660: DB::TCPHandler::runImpl() @ 0x00000000147225d2
23. /home/ubuntu/ClickHouse/src/Server/TCPHandler.cpp:2620: DB::TCPHandler::run() @ 0x000000001473a419
24. /home/ubuntu/ClickHouse/base/poco/Net/src/TCPServerConnection.cpp:40: Poco::Net::TCPServerConnection::start() @ 0x0000000018864647
25. /home/ubuntu/ClickHouse/base/poco/Net/src/TCPServerDispatcher.cpp:115: Poco::Net::TCPServerDispatcher::run() @ 0x0000000018864b1e
26. /home/ubuntu/ClickHouse/base/poco/Foundation/src/ThreadPool.cpp:205: Poco::PooledThread::run() @ 0x000000001880fff2
27. /home/ubuntu/ClickHouse/base/poco/Foundation/src/Thread_POSIX.cpp:335: Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001880dbe3
28. ? @ 0x00007ffff7c94ac3
29. ? @ 0x00007ffff7d26850
```

`StorageWindowView::innerQueryParser` uses `.at()` in a few places instead of explicitly checking the number of arguments. It should be changed to do explicit checks for better error messages and to avoid the abort/alerts from logical error.