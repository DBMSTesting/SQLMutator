ID: 16980
Title: fuzzBits: PODArray.h:376: Assertion failed
Description:
```
SELECT fuzzBits('stringstring', 0.5), * FROM ( SELECT x, toTypeName(x), count() FROM ( SELECT 1 AS x UNION ALL SELECT NULL UNION ALL SELECT 0. ) GROUP BY x ) ORDER BY x DESC



clickhouse-server: /home/akuzm/ch2/ch/src/Common/PODArray.h:376: const T &DB::PODArray<unsigned long, 4096, Allocator<false, false>, 15, 16>::operator[](ssize_t) const [T = unsigned long, initial_bytes = 4096, TAllocator = Allocator<false, false>, pad_right_ = 15, pad_left_ = 16]: Assertion `(n >= (static_cast<ssize_t>(pad_left_) ? -1 : 0)) && (n <= static_cast<ssize_t>(this->size()))' failed.
2020.11.13 14:01:57.359341 [ 1524626 ] {} <Trace> BaseDaemon: Received signal 6
2020.11.13 14:01:57.360354 [ 1659265 ] {} <Fatal> BaseDaemon: ########################################
2020.11.13 14:01:57.361012 [ 1659265 ] {} <Fatal> BaseDaemon: (version 20.12.1.1, build id: B0E4AF80C6E8FCE8) (from thread 1524699) (query_id: b0e67a3e-c810-4e61-ace9-3b45552f68e4) Received signal Aborted (6)
2020.11.13 14:01:57.361476 [ 1659265 ] {} <Fatal> BaseDaemon: 
2020.11.13 14:01:57.361978 [ 1659265 ] {} <Fatal> BaseDaemon: Stack trace: 0x7feedaea118b 0x7feedae80859 0x7feedae80729 0x7feedae91f36 0x7feed8bce5dd 0x7feed2e22a64 0x7feed171fa7e 0x7feed22bf633 0x7feed22c05c5 0x7feec9c3a665 0x7feec9c3cef9 0x7feec4fe40b4 0x7feec7f16c25 0x7feec5aefbe8 0x7feec5923d69 0x7feec5923c5f 0x7feec5923c1d 0x7feec5923bcd 0x7feec5923b9d 0x7feec5922cee 0x7feedf608e15 0x7feedf608db5 0x7feec5921605 0x7feec5921df9 0x7feec5926176 0x7feec59260dd 0x7feec59260a1 0x7feec5925fe2
2020.11.13 14:01:57.364152 [ 1659265 ] {} <Fatal> BaseDaemon: 4. /build/glibc-ZN95T4/glibc-2.31/signal/../sysdeps/unix/sysv/linux/raise.c:51: raise @ 0x4618b in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.31.so
2020.11.13 14:01:57.365669 [ 1659265 ] {} <Fatal> BaseDaemon: 5. /build/glibc-ZN95T4/glibc-2.31/stdlib/abort.c:81: __GI_abort @ 0x25859 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.31.so
2020.11.13 14:01:57.367566 [ 1659265 ] {} <Fatal> BaseDaemon: 6. /build/glibc-ZN95T4/glibc-2.31/intl/loadmsgcat.c:509: _nl_load_domain.cold @ 0x25729 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.31.so
2020.11.13 14:01:57.368806 [ 1659265 ] {} <Fatal> BaseDaemon: 7. ? @ 0x36f36 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.31.so
2020.11.13 14:01:57.370238 [ 1659265 ] {} <Fatal> BaseDaemon: 8. /home/akuzm/ch2/ch/src/Common/PODArray.h:0: DB::PODArray<unsigned long, 4096ul, Allocator<false, false>, 15ul, 16ul>::operator[](long) const @ 0x3b2d5dd in /home/akuzm/ch2/build-clang10/src/AggregateFunctions/libclickhouse_aggregate_functionsd.so
2020.11.13 14:01:57.375356 [ 1659265 ] {} <Fatal> BaseDaemon: 9. /home/akuzm/ch2/ch/src/Functions/fuzzBits.cpp:112: DB::(anonymous namespace)::FunctionFuzzBits::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> >&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x4279a64 in /home/akuzm/ch2/build-clang10/src/Functions/libclickhouse_functionsd.so
2020.11.13 14:01:57.376110 [ 1659265 ] {} <Fatal> BaseDaemon: 10. /home/akuzm/ch2/ch/src/Functions/IFunctionAdaptors.h:152: DB::DefaultExecutable::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> >&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) @ 0x2b76a7e in /home/akuzm/ch2/build-clang10/src/Functions/libclickhouse_functionsd.so
2020.11.13 14:01:57.377929 [ 1659265 ] {} <Fatal> BaseDaemon: 11. /home/akuzm/ch2/ch/src/Functions/IFunction.cpp:291: DB::ExecutableFunctionAdaptor::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> >&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) @ 0x3716633 in /home/akuzm/ch2/build-clang10/src/Functions/libclickhouse_functionsd.so
2020.11.13 14:01:57.379695 [ 1659265 ] {} <Fatal> BaseDaemon: 12. /home/akuzm/ch2/ch/src/Functions/IFunction.cpp:446: DB::ExecutableFunctionAdaptor::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> >&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) @ 0x37175c5 in /home/akuzm/ch2/build-clang10/src/Functions/libclickhouse_functionsd.so
2020.11.13 14:01:57.381297 [ 1659265 ] {} <Fatal> BaseDaemon: 13. /home/akuzm/ch2/ch/src/Interpreters/ExpressionActions.cpp:368: DB::ExpressionAction::execute(DB::Block&, bool) const @ 0x144d665 in /home/akuzm/ch2/build-clang10/src/libclickhouse_interpretersd.so
2020.11.13 14:01:57.382663 [ 1659265 ] {} <Fatal> BaseDaemon: 14. /home/akuzm/ch2/ch/src/Interpreters/ExpressionActions.cpp:633: DB::ExpressionActions::execute(DB::Block&, bool) const @ 0x144fef9 in /home/akuzm/ch2/build-clang10/src/libclickhouse_interpretersd.so
2020.11.13 14:01:57.384079 [ 1659265 ] {} <Fatal> BaseDaemon: 15. /home/akuzm/ch2/ch/src/Processors/Transforms/ExpressionTransform.cpp:25: DB::ExpressionTransform::transform(DB::Chunk&) @ 0x2740b4 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_transformsd.so
2020.11.13 14:01:57.387943 [ 1659265 ] {} <Fatal> BaseDaemon: 16. /home/akuzm/ch2/ch/src/Processors/ISimpleTransform.h:43: DB::ISimpleTransform::transform(DB::Chunk&, DB::Chunk&) @ 0xb85c25 in /home/akuzm/ch2/build-clang10/src/libclickhouse_storagesd.so
2020.11.13 14:01:57.388548 [ 1659265 ] {} <Fatal> BaseDaemon: 17. /home/akuzm/ch2/ch/src/Processors/ISimpleTransform.cpp:89: DB::ISimpleTransform::work() @ 0x19abe8 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processorsd.so
2020.11.13 14:01:57.389178 [ 1659265 ] {} <Fatal> BaseDaemon: 18. /home/akuzm/ch2/ch/src/Processors/Executors/PipelineExecutor.cpp:80: DB::executeJob(DB::IProcessor*) @ 0x134d69 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.389844 [ 1659265 ] {} <Fatal> BaseDaemon: 19. /home/akuzm/ch2/ch/src/Processors/Executors/PipelineExecutor.cpp:97: DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0::operator()() const @ 0x134c5f in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.390466 [ 1659265 ] {} <Fatal> BaseDaemon: 20. /home/akuzm/ch2/ch/contrib/libcxx/include/type_traits:3519: decltype(std::__1::forward<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&>(fp)()) std::__1::__invoke<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&>(DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&) @ 0x134c1d in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.391096 [ 1659265 ] {} <Fatal> BaseDaemon: 21. /home/akuzm/ch2/ch/contrib/libcxx/include/__functional_base:349: void std::__1::__invoke_void_return_wrapper<void>::__call<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&>(DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&) @ 0x134bcd in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.391749 [ 1659265 ] {} <Fatal> BaseDaemon: 22. /home/akuzm/ch2/ch/contrib/libcxx/include/functional:1540: std::__1::__function::__alloc_func<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0, std::__1::allocator<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0>, void ()>::operator()() @ 0x134b9d in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.392348 [ 1659265 ] {} <Fatal> BaseDaemon: 23. /home/akuzm/ch2/ch/contrib/libcxx/include/functional:1714: std::__1::__function::__func<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0, std::__1::allocator<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0>, void ()>::operator()() @ 0x133cee in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.393912 [ 1659265 ] {} <Fatal> BaseDaemon: 24. /home/akuzm/ch2/ch/contrib/libcxx/include/functional:1867: std::__1::__function::__value_func<void ()>::operator()() const @ 0x178e15 in /home/akuzm/ch2/build-clang10/programs/server/libclickhouse-server-libd.so
2020.11.13 14:01:57.395402 [ 1659265 ] {} <Fatal> BaseDaemon: 25. /home/akuzm/ch2/ch/contrib/libcxx/include/functional:2473: std::__1::function<void ()>::operator()() const @ 0x178db5 in /home/akuzm/ch2/build-clang10/programs/server/libclickhouse-server-libd.so
2020.11.13 14:01:57.395975 [ 1659265 ] {} <Fatal> BaseDaemon: 26. /home/akuzm/ch2/ch/src/Processors/Executors/PipelineExecutor.cpp:566: DB::PipelineExecutor::executeStepImpl(unsigned long, unsigned long, std::__1::atomic<bool>*) @ 0x132605 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.396559 [ 1659265 ] {} <Fatal> BaseDaemon: 27. /home/akuzm/ch2/ch/src/Processors/Executors/PipelineExecutor.cpp:479: DB::PipelineExecutor::executeSingleThread(unsigned long, unsigned long) @ 0x132df9 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.397229 [ 1659265 ] {} <Fatal> BaseDaemon: 28. /home/akuzm/ch2/ch/src/Processors/Executors/PipelineExecutor.cpp:738: DB::PipelineExecutor::executeImpl(unsigned long)::$_4::operator()() const @ 0x137176 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.397958 [ 1659265 ] {} <Fatal> BaseDaemon: 29. /home/akuzm/ch2/ch/contrib/libcxx/include/type_traits:3525: decltype(std::__1::forward<DB::PipelineExecutor::executeImpl(unsigned long)::$_4&>(fp)()) std::__1::__invoke_constexpr<DB::PipelineExecutor::executeImpl(unsigned long)::$_4&>(DB::PipelineExecutor::executeImpl(unsigned long)::$_4&) @ 0x1370dd in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.398630 [ 1659265 ] {} <Fatal> BaseDaemon: 30. /home/akuzm/ch2/ch/contrib/libcxx/include/tuple:1415: decltype(auto) std::__1::__apply_tuple_impl<DB::PipelineExecutor::executeImpl(unsigned long)::$_4&, std::__1::tuple<>&>(DB::PipelineExecutor::executeImpl(unsigned long)::$_4&, std::__1::tuple<>&, std::__1::__tuple_indices<>) @ 0x1370a1 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
2020.11.13 14:01:57.399296 [ 1659265 ] {} <Fatal> BaseDaemon: 31. /home/akuzm/ch2/ch/contrib/libcxx/include/tuple:1424: decltype(auto) std::__1::apply<DB::PipelineExecutor::executeImpl(unsigned long)::$_4&, std::__1::tuple<>&>(DB::PipelineExecutor::executeImpl(unsigned long)::$_4&, std::__1::tuple<>&) @ 0x136fe2 in /home/akuzm/ch2/build-clang10/src/libclickhouse_processors_executorsd.so
```