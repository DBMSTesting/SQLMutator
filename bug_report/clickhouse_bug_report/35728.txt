ID: 35728
Title: Bad cast due to constant columns with the same names but different types
Description:
Initially reported in https://github.com/ClickHouse/ClickHouse/pull/27386#issuecomment-896162594, still reproducible on 22.4.1.1 (current master)
The test from #26912 started to pass somewhere between v21.12.1.8816-testing and v21.12.1.9017-prestable for unknown reason, but the root cause was not fixed

```
$ echo "select groupArray(1) from numbers(22) where number = (select toInt64(1))" | curl 'http://localhost:8123/' --data-binary @-
$ grep -Fa Fatal server.log
2022.03.29 17:43:03.656078 [ 236162 ] {0a659b54-c6b8-45b6-bb18-90f387e348be} <Fatal> : Logical error: 'Bad cast from type DB::ColumnVector<signed char> to DB::ColumnVector<char8_t>'.
2022.03.29 17:43:03.656714 [ 248030 ] {} <Fatal> BaseDaemon: ########################################
2022.03.29 17:43:03.656836 [ 248030 ] {} <Fatal> BaseDaemon: (version 22.4.1.1, build id: B24A62478773B9B0D1F120CDE6620BB99F024A44) (from thread 236162) (query_id: 0a659b54-c6b8-45b6-bb18-90f387e348be) (query: select groupArray(1) from numbers(22) where number = (select toInt64(1))
2022.03.29 17:43:03.656913 [ 248030 ] {} <Fatal> BaseDaemon: 
2022.03.29 17:43:03.656994 [ 248030 ] {} <Fatal> BaseDaemon: Stack trace: 0x7fe3d9f6c34c 0x7fe3d9f1f4b8 0x7fe3d9f09534 0x172d823b 0x172d8372 0x17627d60 0x17e52ba2 0x17e5355f 0x271772b5 0x27124299 0x28dc2740 0x28dc0689 0x289dac66 0x289dab42 0x289bc255 0x289bc564 0x289bb5ec 0x289baa85 0x289b89f9 0x278ab8f9 0x288ac697 0x288af2ff 0x28950281 0x2d76cdd9 0x2d76d5f9 0x2d9dfb41 0x2d9dc1da 0x2d9dae94 0x7fe3d9f6a5c2 0x7fe3d9fef584
2022.03.29 17:43:03.657104 [ 248030 ] {} <Fatal> BaseDaemon: 4. ? @ 0x7fe3d9f6c34c in ?
2022.03.29 17:43:03.657174 [ 248030 ] {} <Fatal> BaseDaemon: 5. raise @ 0x7fe3d9f1f4b8 in ?
2022.03.29 17:43:03.657254 [ 248030 ] {} <Fatal> BaseDaemon: 6. abort @ 0x7fe3d9f09534 in ?
2022.03.29 17:43:03.720627 [ 248030 ] {} <Fatal> BaseDaemon: 7. ./cmake-build-debug/./src/Common/Exception.cpp:52: DB::handle_error_code(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool, std::__1::vector<void*, std::__1::allocator<void*> > const&) @ 0x172d823b in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:03.773244 [ 248030 ] {} <Fatal> BaseDaemon: 8. ./cmake-build-debug/./src/Common/Exception.cpp:59: DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x172d8372 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:03.887586 [ 248030 ] {} <Fatal> BaseDaemon: 9. ./cmake-build-debug/./src/Common/assert_cast.h:47: DB::ColumnVector<char8_t> const& assert_cast<DB::ColumnVector<char8_t> const&, DB::IColumn const&>(DB::IColumn const&) @ 0x17627d60 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:04.041594 [ 248030 ] {} <Fatal> BaseDaemon: 10. ./cmake-build-debug/./src/AggregateFunctions/AggregateFunctionGroupArray.h:161: DB::GroupArrayNumericImpl<char8_t, DB::GroupArrayTrait<false, (DB::Sampler)0> >::add(char*, DB::IColumn const**, unsigned long, DB::Arena*) const @ 0x17e52ba2 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:04.195251 [ 248030 ] {} <Fatal> BaseDaemon: 11. ./cmake-build-debug/./src/AggregateFunctions/IAggregateFunction.h:424: DB::IAggregateFunctionHelper<DB::GroupArrayNumericImpl<char8_t, DB::GroupArrayTrait<false, (DB::Sampler)0> > >::addBatchSinglePlace(unsigned long, char*, DB::IColumn const**, DB::Arena*, long) const @ 0x17e5355f in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:04.701461 [ 248030 ] {} <Fatal> BaseDaemon: 12. ./cmake-build-debug/./src/Interpreters/Aggregator.cpp:0: void DB::Aggregator::executeWithoutKeyImpl<false>(char*&, unsigned long, DB::Aggregator::AggregateFunctionInstruction*, DB::Arena*) const @ 0x271772b5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.204303 [ 248030 ] {} <Fatal> BaseDaemon: 13. ./cmake-build-debug/./src/Interpreters/Aggregator.cpp:1014: DB::Aggregator::executeOnBlock(std::__1::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::__1::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn> > >, unsigned long, DB::AggregatedDataVariants&, std::__1::vector<DB::IColumn const*, std::__1::allocator<DB::IColumn const*> >&, std::__1::vector<std::__1::vector<DB::IColumn const*, std::__1::allocator<DB::IColumn const*> >, std::__1::allocator<std::__1::vector<DB::IColumn const*, std::__1::allocator<DB::IColumn const*> > > >&, bool&) const @ 0x27124299 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.376421 [ 248030 ] {} <Fatal> BaseDaemon: 14. ./cmake-build-debug/./src/Processors/Transforms/AggregatingTransform.cpp:536: DB::AggregatingTransform::consume(DB::Chunk) @ 0x28dc2740 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.548729 [ 248030 ] {} <Fatal> BaseDaemon: 15. ./cmake-build-debug/./src/Processors/Transforms/AggregatingTransform.cpp:497: DB::AggregatingTransform::work() @ 0x28dc0689 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.601636 [ 248030 ] {} <Fatal> BaseDaemon: 16. ./cmake-build-debug/./src/Processors/Executors/ExecutionThreadContext.cpp:45: DB::executeJob(DB::IProcessor*) @ 0x289dac66 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.652053 [ 248030 ] {} <Fatal> BaseDaemon: 17. ./cmake-build-debug/./src/Processors/Executors/ExecutionThreadContext.cpp:63: DB::ExecutionThreadContext::executeTask() @ 0x289dab42 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.744152 [ 248030 ] {} <Fatal> BaseDaemon: 18. ./cmake-build-debug/./src/Processors/Executors/PipelineExecutor.cpp:213: DB::PipelineExecutor::executeStepImpl(unsigned long, std::__1::atomic<bool>*) @ 0x289bc255 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.835491 [ 248030 ] {} <Fatal> BaseDaemon: 19. ./cmake-build-debug/./src/Processors/Executors/PipelineExecutor.cpp:178: DB::PipelineExecutor::executeSingleThread(unsigned long) @ 0x289bc564 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:05.913080 [ 248030 ] {} <Fatal> BaseDaemon: 20. ./cmake-build-debug/./src/Processors/Executors/PipelineExecutor.cpp:324: DB::PipelineExecutor::executeImpl(unsigned long) @ 0x289bb5ec in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.003539 [ 248030 ] {} <Fatal> BaseDaemon: 21. ./cmake-build-debug/./src/Processors/Executors/PipelineExecutor.cpp:84: DB::PipelineExecutor::execute(unsigned long) @ 0x289baa85 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.051375 [ 248030 ] {} <Fatal> BaseDaemon: 22. ./cmake-build-debug/./src/Processors/Executors/CompletedPipelineExecutor.cpp:95: DB::CompletedPipelineExecutor::execute() @ 0x289b89f9 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.244611 [ 248030 ] {} <Fatal> BaseDaemon: 23. ./cmake-build-debug/./src/Interpreters/executeQuery.cpp:1167: DB::executeQuery(DB::ReadBuffer&, DB::WriteBuffer&, bool, std::__1::shared_ptr<DB::Context>, std::__1::function<void (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&)>, std::__1::optional<DB::FormatSettings> const&) @ 0x278ab8f9 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.393832 [ 248030 ] {} <Fatal> BaseDaemon: 24. ./cmake-build-debug/./src/Server/HTTPHandler.cpp:821: DB::HTTPHandler::processQuery(DB::HTTPServerRequest&, DB::HTMLForm&, DB::HTTPServerResponse&, DB::HTTPHandler::Output&, std::__1::optional<DB::CurrentThread::QueryScope>&) @ 0x288ac697 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.560568 [ 248030 ] {} <Fatal> BaseDaemon: 25. ./cmake-build-debug/./src/Server/HTTPHandler.cpp:959: DB::HTTPHandler::handleRequest(DB::HTTPServerRequest&, DB::HTTPServerResponse&) @ 0x288af2ff in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.607607 [ 248030 ] {} <Fatal> BaseDaemon: 26. ./cmake-build-debug/./src/Server/HTTP/HTTPServerConnection.cpp:65: DB::HTTPServerConnection::run() @ 0x28950281 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.648044 [ 248030 ] {} <Fatal> BaseDaemon: 27. ./cmake-build-debug/./contrib/poco/Net/src/TCPServerConnection.cpp:43: Poco::Net::TCPServerConnection::start() @ 0x2d76cdd9 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.699853 [ 248030 ] {} <Fatal> BaseDaemon: 28. ./cmake-build-debug/./contrib/poco/Net/src/TCPServerDispatcher.cpp:115: Poco::Net::TCPServerDispatcher::run() @ 0x2d76d5f9 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.754571 [ 248030 ] {} <Fatal> BaseDaemon: 29. ./cmake-build-debug/./contrib/poco/Foundation/src/ThreadPool.cpp:199: Poco::PooledThread::run() @ 0x2d9dfb41 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.808737 [ 248030 ] {} <Fatal> BaseDaemon: 30. ./cmake-build-debug/./contrib/poco/Foundation/src/Thread.cpp:56: Poco::(anonymous namespace)::RunnableHolder::run() @ 0x2d9dc1da in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.861919 [ 248030 ] {} <Fatal> BaseDaemon: 31. ./cmake-build-debug/./contrib/poco/Foundation/src/Thread_POSIX.cpp:345: Poco::ThreadImpl::runnableEntry(void*) @ 0x2d9dae94 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse
2022.03.29 17:43:06.862027 [ 248030 ] {} <Fatal> BaseDaemon: 32. ? @ 0x7fe3d9f6a5c2 in ?
2022.03.29 17:43:06.862086 [ 248030 ] {} <Fatal> BaseDaemon: 33. clone @ 0x7fe3d9fef584 in ?
2022.03.29 17:43:07.531173 [ 248030 ] {} <Fatal> BaseDaemon: Calculated checksum of the binary: 242BBA0242A97CA322CDF221A0754F76. There is no information about the reference checksum.
```
