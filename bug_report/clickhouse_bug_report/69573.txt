ID: 69573
Title: DB::HashJoin::getTotalByteCount() : Logical error: 'data->blocks_allocated_size != debug_blocks_allocated_size (80128 != 131072)'
Description:
Happens in stress test run:
https://s3.amazonaws.com/clickhouse-test-reports/69525/e15b86cd9dcf27b88bb53aa718c3888e54cf4468/stress_test__debug_.html

```
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.258039 [ 22004 ] {} <Fatal> BaseDaemon: ########## Short fault info ############
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.262189 [ 22004 ] {} <Fatal> BaseDaemon: (version 24.9.1.2587, build id: EC2EB30436DBDA3CA9588AF52B4F9DA3F2AD5AE7, git hash: aaffbf151cdc1a172d41fae7f746a051b0a1fda0, architecture: x86_64) (from thread 5602) Received signal 6
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.264500 [ 22004 ] {} <Fatal> BaseDaemon: Signal description: Aborted
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.264842 [ 22004 ] {} <Fatal> BaseDaemon: 
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.275053 [ 22004 ] {} <Fatal> BaseDaemon: Stack trace: 0x000000000c726728 0x000000000c979b25 0x00007f72701f7520 0x00007f727024b9fd 0x00007f72701f7476 0x00007f72701dd7f3 0x000000000c6f8b93 0x000000000c6f9654 0x000000000703116c 0x0000000007ccc8ab 0x0000000011aa770d 0x0000000011aaf7b7 0x00000000130818cf 0x0000000010cac4ce 0x0000000010caf2c0 0x0000000010cb46c2 0x0000000012d82aa3 0x0000000012d971f9 0x00000000165e5ee7 0x00000000165e63be 0x0000000016592932 0x0000000016590643 0x00007f7270249ac3 0x00007f72702db850
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.276757 [ 22004 ] {} <Fatal> BaseDaemon: ########################################
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.285404 [ 22004 ] {} <Fatal> BaseDaemon: (version 24.9.1.2587, build id: EC2EB30436DBDA3CA9588AF52B4F9DA3F2AD5AE7, git hash: aaffbf151cdc1a172d41fae7f746a051b0a1fda0) (from thread 5602) (query_id: 9cdedbb1-b9d9-4d89-a8f7-8fdaa16fb29d) (query: SELECT max(`__table2`.`a`) AS `MAX(test_right.a)` FROM `test_of0sadkf`.`test_left` AS `__table1` ALL INNER JOIN `test_of0sadkf`.`test_right` AS `__table2` ON `__table1`.`b` = `__table2`.`b`) Received signal Aborted (6)
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.297016 [ 22004 ] {} <Fatal> BaseDaemon: 
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.308868 [ 22004 ] {} <Fatal> BaseDaemon: Stack trace: 0x000000000c726728 0x000000000c979b25 0x00007f72701f7520 0x00007f727024b9fd 0x00007f72701f7476 0x00007f72701dd7f3 0x000000000c6f8b93 0x000000000c6f9654 0x000000000703116c 0x0000000007ccc8ab 0x0000000011aa770d 0x0000000011aaf7b7 0x00000000130818cf 0x0000000010cac4ce 0x0000000010caf2c0 0x0000000010cb46c2 0x0000000012d82aa3 0x0000000012d971f9 0x00000000165e5ee7 0x00000000165e63be 0x0000000016592932 0x0000000016590643 0x00007f7270249ac3 0x00007f72702db850
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.380824 [ 22004 ] {} <Fatal> BaseDaemon: 0.0. inlined from /build/src/Common/StackTrace.cpp:380: StackTrace::tryCapture()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.383942 [ 22004 ] {} <Fatal> BaseDaemon: 0. /build/src/Common/StackTrace.cpp:349: StackTrace::StackTrace(ucontext_t const&) @ 0x000000000c726728
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.475822 [ 22004 ] {} <Fatal> BaseDaemon: 1. /build/src/Common/SignalHandlers.cpp:85: signalHandler(int, siginfo_t*, void*) @ 0x000000000c979b25
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.507812 [ 22004 ] {} <Fatal> BaseDaemon: 2. ? @ 0x00007f72701f7520
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.522750 [ 22004 ] {} <Fatal> BaseDaemon: 3. ? @ 0x00007f727024b9fd
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.537932 [ 22004 ] {} <Fatal> BaseDaemon: 4. ? @ 0x00007f72701f7476
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.545854 [ 22004 ] {} <Fatal> BaseDaemon: 5. ? @ 0x00007f72701dd7f3
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.653603 [ 22004 ] {} <Fatal> BaseDaemon: 6. /build/src/Common/Exception.cpp:48: DB::abortOnFailedAssertion(String const&, void* const*, unsigned long, unsigned long) @ 0x000000000c6f8b93
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.768934 [ 22004 ] {} <Fatal> BaseDaemon: 7.0. inlined from /build/src/Common/Exception.cpp:71: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&)
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.776100 [ 22004 ] {} <Fatal> BaseDaemon: 7. /build/src/Common/Exception.cpp:115: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000c6f9654
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:12.958792 [ 22004 ] {} <Fatal> BaseDaemon: 8.0. inlined from /build/src/Common/Exception.h:110: Exception
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.027611 [ 22004 ] {} <Fatal> BaseDaemon: 8. /build/src/Common/Exception.h:63: DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000703116c
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.071938 [ 22004 ] {} <Fatal> BaseDaemon: 9. /build/src/Common/Exception.h:128: DB::Exception::Exception<unsigned long&, unsigned long&>(int, FormatStringHelperImpl<std::type_identity<unsigned long&>::type, std::type_identity<unsigned long&>::type>, unsigned long&, unsigned long&) @ 0x0000000007ccc8ab
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.211427 [ 22004 ] {} <Fatal> BaseDaemon: 10. /build/src/Interpreters/HashJoin/HashJoin.cpp:352: DB::HashJoin::getTotalByteCount() const @ 0x0000000011aa770d
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.469653 [ 22004 ] {} <Fatal> BaseDaemon: 11. /build/src/Interpreters/HashJoin/HashJoin.cpp:969: DB::HashJoin::~HashJoin() @ 0x0000000011aaf7b7
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.552357 [ 22004 ] {} <Fatal> BaseDaemon: 12.0. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174: std::__shared_count::__release_shared[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.555549 [ 22004 ] {} <Fatal> BaseDaemon: 12.1. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:215: std::__shared_weak_count::__release_shared[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.559541 [ 22004 ] {} <Fatal> BaseDaemon: 12.2. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:702: ~shared_ptr
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.561125 [ 22004 ] {} <Fatal> BaseDaemon: 12. /build/src/Processors/Transforms/JoiningTransform.cpp:45: DB::JoiningTransform::~JoiningTransform() @ 0x00000000130818cf
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.753331 [ 22004 ] {} <Fatal> BaseDaemon: 13.0. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174: ~shared_ptr
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.761298 [ 22004 ] {} <Fatal> BaseDaemon: 13.1. inlined from /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:63: _ZNSt3__112__destroy_atB6v15007INS_10shared_ptrIN2DB10IProcessorEEETnNS_9enable_ifIXntsr8is_arrayIT_EE5valueEiE4typeELi0EEEvPS6_
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.774054 [ 22004 ] {} <Fatal> BaseDaemon: 13.2. inlined from /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:88: _ZNSt3__110destroy_atB6v15007INS_10shared_ptrIN2DB10IProcessorEEETnNS_9enable_ifIXnt10is_array_vIT_EEiE4typeELi0EEEvPS6_
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.778184 [ 22004 ] {} <Fatal> BaseDaemon: 13.3. inlined from /build/contrib/llvm-project/libcxx/include/__memory/allocator_traits.h:317: void std::allocator_traits<std::allocator<std::shared_ptr<DB::IProcessor>>>::destroy[abi:v15007]<std::shared_ptr<DB::IProcessor>, void, void>(std::allocator<std::shared_ptr<DB::IProcessor>>&, std::shared_ptr<DB::IProcessor>*)
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.780913 [ 22004 ] {} <Fatal> BaseDaemon: 13.4. inlined from /build/contrib/llvm-project/libcxx/include/vector:843: std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>::__base_destruct_at_end[abi:v15007](std::shared_ptr<DB::IProcessor>*)
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.781768 [ 22004 ] {} <Fatal> BaseDaemon: 13.5. inlined from /build/contrib/llvm-project/libcxx/include/vector:837: std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>::__clear[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.783679 [ 22004 ] {} <Fatal> BaseDaemon: 13.6. inlined from /build/contrib/llvm-project/libcxx/include/vector:439: std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>::__destroy_vector::operator()[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.790774 [ 22004 ] {} <Fatal> BaseDaemon: 13.7. inlined from /build/contrib/llvm-project/libcxx/include/vector:449: ~vector
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.808710 [ 22004 ] {} <Fatal> BaseDaemon: 13.8. inlined from /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:63: _ZNSt3__112__destroy_atB6v15007INS_6vectorINS_10shared_ptrIN2DB10IProcessorEEENS_9allocatorIS5_EEEETnNS_9enable_ifIXntsr8is_arrayIT_EE5valueEiE4typeELi0EEEvPSA_
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.819486 [ 22004 ] {} <Fatal> BaseDaemon: 13.9. inlined from /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:88: _ZNSt3__110destroy_atB6v15007INS_6vectorINS_10shared_ptrIN2DB10IProcessorEEENS_9allocatorIS5_EEEETnNS_9enable_ifIXnt10is_array_vIT_EEiE4typeELi0EEEvPSA_
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.827761 [ 22004 ] {} <Fatal> BaseDaemon: 13.10. inlined from /build/contrib/llvm-project/libcxx/include/__memory/allocator_traits.h:317: void std::allocator_traits<std::allocator<std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>>>::destroy[abi:v15007]<std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>, void, void>(std::allocator<std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>>&, std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>*)
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.856881 [ 22004 ] {} <Fatal> BaseDaemon: 13. /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:309: std::__shared_ptr_emplace<std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>, std::allocator<std::vector<std::shared_ptr<DB::IProcessor>, std::allocator<std::shared_ptr<DB::IProcessor>>>>>::__on_zero_shared() @ 0x0000000010cac4ce
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:13.982378 [ 22004 ] {} <Fatal> BaseDaemon: 14.0. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174: std::__shared_count::__release_shared[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.016028 [ 22004 ] {} <Fatal> BaseDaemon: 14.1. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:215: std::__shared_weak_count::__release_shared[abi:v15007]()
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.019633 [ 22004 ] {} <Fatal> BaseDaemon: 14.2. inlined from /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:702: ~shared_ptr
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.032802 [ 22004 ] {} <Fatal> BaseDaemon: 14. /build/src/QueryPipeline/QueryPipeline.cpp:49: DB::QueryPipeline::~QueryPipeline() @ 0x0000000010caf2c0
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.131510 [ 22004 ] {} <Fatal> BaseDaemon: 15. /build/src/QueryPipeline/QueryPipeline.cpp:698: DB::QueryPipeline::reset() @ 0x0000000010cb46c2
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.330920 [ 22004 ] {} <Fatal> BaseDaemon: 16. /build/src/Server/TCPHandler.cpp:674: DB::TCPHandler::runImpl() @ 0x0000000012d82aa3
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.691297 [ 22004 ] {} <Fatal> BaseDaemon: 17. /build/src/Server/TCPHandler.cpp:2484: DB::TCPHandler::run() @ 0x0000000012d971f9
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.711804 [ 22004 ] {} <Fatal> BaseDaemon: 18. /build/base/poco/Net/src/TCPServerConnection.cpp:43: Poco::Net::TCPServerConnection::start() @ 0x00000000165e5ee7
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.759640 [ 22004 ] {} <Fatal> BaseDaemon: 19. /build/base/poco/Net/src/TCPServerDispatcher.cpp:115: Poco::Net::TCPServerDispatcher::run() @ 0x00000000165e63be
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.774015 [ 22004 ] {} <Fatal> BaseDaemon: 20. /build/base/poco/Foundation/src/ThreadPool.cpp:205: Poco::PooledThread::run() @ 0x0000000016592932
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.795154 [ 22004 ] {} <Fatal> BaseDaemon: 21. /build/base/poco/Foundation/src/Thread_POSIX.cpp:335: Poco::ThreadImpl::runnableEntry(void*) @ 0x0000000016590643
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.799752 [ 22004 ] {} <Fatal> BaseDaemon: 22. ? @ 0x00007f7270249ac3
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.831513 [ 22004 ] {} <Fatal> BaseDaemon: 23. ? @ 0x00007f72702db850
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:14.837769 [ 22004 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:16.962704 [ 22004 ] {} <Fatal> BaseDaemon: This ClickHouse version is not official and should be upgraded to the official build.
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:16.986151 [ 22004 ] {} <Fatal> BaseDaemon: Changed settings: min_compress_block_size = 1831887, max_compress_block_size = 1992809, max_block_size = 94683, min_external_table_block_size_bytes = 0, max_joined_block_size_rows = 14217, max_insert_threads = 2, max_threads = 3, max_parsing_threads = 10, max_read_buffer_size = 980206, connect_timeout_with_failover_ms = 2000, connect_timeout_with_failover_secure_ms = 3000, use_hedged_requests = false, idle_connection_timeout = 36000, s3_max_get_rps = 1000000, s3_max_get_burst = 2000000, s3_max_put_rps = 1000000, s3_max_put_burst = 2000000, s3_check_objects_after_upload = true, use_uncompressed_cache = true, max_remote_read_network_bandwidth = 1000000000000, max_remote_write_network_bandwidth = 1000000000000, max_local_read_bandwidth = 1000000000000, max_local_write_bandwidth = 1000000000000, stream_like_engine_allow_direct_select = true, enable_multiple_prewhere_read_steps = false, replication_wait_for_inactive_replica_timeout = 30, min_count_to_compile_expression = 0, compile_sort_description = false, group_by_two_level_threshold = 1, group_by_two_level_threshold_bytes = 1, allow_nonconst_timezone_arguments = true, max_parallel_replicas = 3, input_format_parallel_parsing = false, min_chunk_bytes_for_parallel_parsing = 15200502, merge_tree_coarse_index_granularity = 5, min_bytes_to_use_direct_io = 5047481743, min_bytes_to_use_mmap_io = 7428980494, log_queries = true, insert_quorum_timeout = 60000, table_function_remote_max_addresses = 200, merge_tree_read_split_ranges_into_intersecting_and_non_intersecting_injection_probability = 0.46000000834465027, http_response_buffer_size = 5135516, fsync_metadata = true, http_send_timeout = 60., http_receive_timeout = 60., use_index_for_in_with_subqueries_max_values = 1000000000, opentelemetry_start_trace_probability = 0.10000000149011612, max_rows_to_read = 20000000, max_bytes_to_read = 1000000000000, max_bytes_to_read_leaf = 1000000000000, max_rows_to_group_by = 10000000000, max_bytes_before_external_group_by = 10737418240, max_rows_to_sort = 10000000000, max_bytes_to_sort = 10000000000, prefer_external_sort_block_bytes = 100000000, max_bytes_before_external_sort = 0, max_bytes_before_remerge_sort = 2257058399, max_result_rows = 1000000000, max_result_bytes = 1000000000, max_execution_time = 60., max_execution_time_leaf = 600., max_execution_speed = 100000000000, max_execution_speed_bytes = 10000000000000, timeout_before_checking_execution_speed = 300., max_estimated_execution_time = 600., max_columns_to_read = 20000, max_temporary_columns = 20000, max_temporary_non_const_columns = 20000, max_rows_in_set = 10000000000, max_bytes_in_set = 10000000000, max_rows_in_join = 10000000000, max_bytes_in_join = 10000000000, cross_join_min_rows_to_compress = 100000000, cross_join_min_bytes_to_compress = 100000000, max_rows_to_transfer = 1000000000, max_bytes_to_transfer = 1000000000, max_rows_in_distinct = 10000000000, max_bytes_in_distinct = 10000000000, max_memory_usage = 10000000000, max_memory_usage_for_user = 19896744345, max_untracked_memory = 1048576, memory_profiler_step = 1048576, max_network_bandwidth = 100000000000, max_network_bytes = 1000000000000, max_network_bandwidth_for_user = 100000000000, max_network_bandwidth_for_all_users = 100000000000, max_temporary_data_on_disk_size_for_user = 100000000000, max_temporary_data_on_disk_size_for_query = 100000000000, max_backup_bandwidth = 100000000000, log_comment = '03228_join_to_rerange_right_table.sql', send_logs_level = 'warning', prefer_localhost_replica = false, optimize_aggregation_in_order = true, aggregation_in_order_max_block_bytes = 35868349, read_in_order_two_level_merge_threshold = 17, max_hyperscan_regexp_length = 1000000, max_hyperscan_regexp_total_length = 10000000, allow_introspection_functions = true, database_atomic_wait_for_drop_and_detach_synchronously = true, optimize_trivial_approximate_count_query = true, optimize_functions_to_subcolumns = false, query_cache_max_size_in_bytes = 10000000, query_cache_max_entries = 100000, distributed_ddl_entry_format_version = 6, external_storage_max_read_rows = 10000000000, external_storage_max_read_bytes = 10000000000, local_filesystem_read_method = 'mmap', local_filesystem_read_prefetch = true, remote_filesystem_read_prefetch = false, merge_tree_min_bytes_per_task_for_remote_reading = 8388608, merge_tree_compact_parts_min_granules_to_multibuffer_read = 10, async_insert_busy_timeout_max_ms = 5000, enable_filesystem_cache = true, enable_filesystem_cache_on_write_operations = true, throw_on_error_from_cache_on_write_operations = true, filesystem_cache_segments_batch_size = 50, page_cache_inject_eviction = true, load_marks_asynchronously = true, allow_prefetched_read_pool_for_remote_filesystem = false, allow_prefetched_read_pool_for_local_filesystem = false, filesystem_prefetch_step_marks = 50, filesystem_prefetch_max_memory_usage = 134217728, filesystem_prefetches_limit = 0, allow_deprecated_database_ordinary = true, max_streams_for_merge_tree_reading = 1000, insert_keeper_max_retries = 100, insert_keeper_retry_initial_backoff_ms = 1, insert_keeper_retry_max_backoff_ms = 10, insert_keeper_fault_injection_probability = 0.009999999776482582, ignore_drop_queries_probability = 0.5, allow_experimental_join_right_table_sorting = true, session_timezone = 'Africa/Khartoum', cluster_for_parallel_replicas = 'parallel_replicas', allow_experimental_parallel_reading_from_replicas = 1, parallel_replicas_for_non_replicated_merge_tree = true
/var/log/clickhouse-server/clickhouse-server.err.log:2024.09.12 16:46:17.313502 [ 22004 ] {} <Fatal> BaseDaemon: Code: 210. DB::NetException: Connection reset by peer, while writing to socket ([::ffff:127.0.0.10]:9000 -> [::ffff:127.0.0.1]:41598). (NETWORK_ERROR), Stack trace (when copying this message, always include the lines below):

```

```
2024-09-12 16:44:39 Thread 864 "TCPHandler" received signal SIGABRT, Aborted.
2024-09-12 16:44:39 [Switching to Thread 0x7f6e413a1640 (LWP 8451)]
2024-09-12 16:44:39 0x00007f727024b9fc in pthread_kill () from /lib/x86_64-linux-gnu/libc.so.6
2024-09-12 16:44:39 #0  0x00007f727024b9fc in pthread_kill () from /lib/x86_64-linux-gnu/libc.so.6
2024-09-12 16:44:39 No symbol table info available.
2024-09-12 16:44:39 #1  0x00007f72701f7476 in raise () from /lib/x86_64-linux-gnu/libc.so.6
2024-09-12 16:44:39 No symbol table info available.
2024-09-12 16:44:39 #2  0x00007f72701dd7f3 in abort () from /lib/x86_64-linux-gnu/libc.so.6
2024-09-12 16:44:39 No symbol table info available.
2024-09-12 16:44:39 #3  0x000000000c6f8b93 in DB::abortOnFailedAssertion (description=..., trace=<optimized out>, trace_offset=trace_offset@entry=0, trace_size=<optimized out>) at /build/src/Common/Exception.cpp:48
2024-09-12 16:44:39         logger = <optimized out>
2024-09-12 16:44:39 #4  0x000000000c6f9654 in DB::handle_error_code (msg=..., code=49, trace=..., remote=<optimized out>) at /build/src/Common/Exception.cpp:71
2024-09-12 16:44:39 No locals.
2024-09-12 16:44:39 #5  DB::Exception::Exception (this=0x7f708e99b480, msg_masked=..., code=49, remote_=<optimized out>) at /build/src/Common/Exception.cpp:115
2024-09-12 16:44:39 No locals.
2024-09-12 16:44:39 #6  0x000000000703116c in DB::Exception::Exception (this=0x7f708e99b480, msg=..., code=49, remote_=false) at /build/src/Common/Exception.h:110
2024-09-12 16:44:39 No locals.
2024-09-12 16:44:39 #7  DB::Exception::Exception (this=0x7f708e99b480, msg=..., code=49) at /build/src/Common/Exception.h:63
2024-09-12 16:44:39 No locals.
2024-09-12 16:44:39 #8  0x0000000007ccc8ab in DB::Exception::Exception<unsigned long&, unsigned long&> (this=0x7f708e99b480, code=49, fmt=..., args=<optimized out>, args=<optimized out>) at /build/src/Common/Exception.h:128
2024-09-12 16:44:39 No locals.
2024-09-12 16:44:39 #9  0x0000000011aa770d in DB::HashJoin::getTotalByteCount (this=this@entry=0x7f715cd87598) at /build/src/Interpreters/HashJoin/HashJoin.cpp:352
2024-09-12 16:44:39         debug_blocks_allocated_size = 131072
2024-09-12 16:44:39         debug_blocks_nullmaps_allocated_size = 140118675140656
2024-09-12 16:44:39         res = 140124760741584
2024-09-12 16:44:39 #10 0x0000000011aaf7b7 in DB::HashJoin::~HashJoin (this=0x7f715cd87598) at /build/src/Interpreters/HashJoin/HashJoin.cpp:969
2024-09-12 16:44:39         _file_function = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x7f6e41396588 "\001", __size_ = 401419029, __cap_ = 12896, __is_long_ = 0}, __s = {__data_ = "\210e9An\177\000\000\025+\355\027\000\000\000\000`2\000\000\000\000", __padding_ = 0x7f6e413939d7 "", __size_ = 0 '\000', __is_long_ = 0 '\000'}, __r = {__words = {140111517410696, 401419029, 12896}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}
2024-09-12 16:44:39         _channel = 0x7f726de71fb0
2024-09-12 16:44:39         _nargs = 4
2024-09-12 16:44:39         _format_string = {static npos = 18446744073709551615, __data = 0x0, __size = 66}
2024-09-12 16:44:39         _formatted_message = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x0, __size_ = 0, __cap_ = 0, __is_long_ = 0}, __s = {__data_ = '\000' <repeats 22 times>, __padding_ = 0x7f6e413939b7 "", __size_ = 0 '\000', __is_long_ = 0 '\000'}, __r = {__words = {0, 0, 0}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}
2024-09-12 16:44:39         _format_string_args = {__begin_ = 0x0, __end_ = 0x0, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*, 0, false>> = {__value_ = 0x0}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, 1, true>> = {<std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}
2024-09-12 16:44:40         _poco_message = {_source = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x7f0100000003 <error: Cannot access memory at address 0x7f0100000003>, __size_ = 140111517410696, __cap_ = 48, __is_long_ = 0}, __s = {__data_ = "\003\000\000\000\001\177\000\000\210e9An\177\000\0000\000\000\000\000\000", __padding_ = 0x7f6e41393a47 "", __size_ = 0 '\000', __is_long_ = 0 '\000'}, __r = {__words = {139642271694851, 140111517410696, 48}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}, _text = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x1 <error: Cannot access memory at address 0x1>, __size_ = 140124760741584, __cap_ = 140111517411552, __is_long_ = 0}, __s = {__data_ = "\001\000\000\000\000\000\000\000Ð–\226Vq\177\000\000\340h9An\177", __padding_ = 0x7f6e41393a5f "", __size_ = 0 '\000', __is_long_ = 0 '\000'}, __r = {__words = {1, 140124760741584, 140111517411552}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}, _prio = 0, _time = {static TIMEVAL_MIN = -9223372036854775808, static TIMEVAL_MAX = 9223372036854775807, _ts = 401369639}, _tid = 140124760741584, _thread = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x28 <error: Cannot access memory at address 0x28>, __size_ = 0, __cap_ = 0, __is_long_ = 0}, __s = {__data_ = "(", '\000' <repeats 21 times>, __padding_ = 0x7f6e41393a8f "", __size_ = 0 '\000', __is_long_ = 0 '\000'}, __r = {__words = {40, 0, 0}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}, _pid = 140118675140656, _file = 0x0, _line = 40, _pMap = 0x7f71569696d0, _fmt_str = {static npos = 18446744073709551615, __data = 0x7f6fd2302508 "H0\357\030", __size = 401372095}, _fmt_str_args = {__begin_ = 0x28, __end_ = 0x7f71569696d0, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*, 0, false>> = {__value_ = 0x30}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, 1, true>> = {<std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}}
2024-09-12 16:44:40         is_preformatted_message = false
2024-09-12 16:44:40         _logger = {__ptr_ = 0x7f6fd7a289c0, __cntrl_ = 0x0}
2024-09-12 16:44:40         logger_exception = <optimized out>
2024-09-12 16:44:40         logger_exception = <optimized out>
2024-09-12 16:44:40         _is_clients_log = <optimized out>
2024-09-12 16:44:40 #11 0x00000000130818cf in std::__1::__shared_count::__release_shared[abi:v15007]() (this=0x7f715cd87580) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #12 std::__1::__shared_weak_count::__release_shared[abi:v15007]() (this=0x7f715cd87580) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:215
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #13 std::__1::shared_ptr<DB::IJoin>::~shared_ptr[abi:v15007]() (this=0x7f713e319178) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:702
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #14 DB::JoiningTransform::~JoiningTransform (this=0x7f713e319018) at /build/src/Processors/Transforms/JoiningTransform.cpp:45
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #15 0x0000000010cac4ce in std::__1::__shared_count::__release_shared[abi:v15007]() (this=0x7f713e319000) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #16 std::__1::__shared_weak_count::__release_shared[abi:v15007]() (this=0x7f713e319000) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:215
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #17 std::__1::shared_ptr<DB::IProcessor>::~shared_ptr[abi:v15007]() (this=<optimized out>) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:702
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #18 _ZNSt3__112__destroy_atB6v15007INS_10shared_ptrIN2DB10IProcessorEEETnNS_9enable_ifIXntsr8is_arrayIT_EE5valueEiE4typeELi0EEEvPS6_ (__loc=<optimized out>) at /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:63
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #19 _ZNSt3__110destroy_atB6v15007INS_10shared_ptrIN2DB10IProcessorEEETnNS_9enable_ifIXnt10is_array_vIT_EEiE4typeELi0EEEvPS6_ (__loc=<optimized out>) at /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:88
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #20 std::__1::allocator_traits<std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >::destroy[abi:v15007]<std::__1::shared_ptr<DB::IProcessor>, void, void>(std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> >&, std::__1::shared_ptr<DB::IProcessor>*) (__p=<optimized out>) at /build/contrib/llvm-project/libcxx/include/__memory/allocator_traits.h:317
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #21 std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >::__base_destruct_at_end[abi:v15007](std::__1::shared_ptr<DB::IProcessor>*) (this=0x7f7001091018, __new_last=0x7f6febdbb000) at /build/contrib/llvm-project/libcxx/include/vector:843
2024-09-12 16:44:40         __soon_to_be_end = <optimized out>
2024-09-12 16:44:40 #22 std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >::__clear[abi:v15007]() (this=0x7f7001091018) at /build/contrib/llvm-project/libcxx/include/vector:837
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #23 std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >::__destroy_vector::operator()[abi:v15007]() (this=<optimized out>) at /build/contrib/llvm-project/libcxx/include/vector:439
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #24 std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >::~vector[abi:v15007]() (this=0x7f7001091018) at /build/contrib/llvm-project/libcxx/include/vector:449
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #25 _ZNSt3__112__destroy_atB6v15007INS_6vectorINS_10shared_ptrIN2DB10IProcessorEEENS_9allocatorIS5_EEEETnNS_9enable_ifIXntsr8is_arrayIT_EE5valueEiE4typeELi0EEEvPSA_ (__loc=0x7f7001091018) at /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:63
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #26 _ZNSt3__110destroy_atB6v15007INS_6vectorINS_10shared_ptrIN2DB10IProcessorEEENS_9allocatorIS5_EEEETnNS_9enable_ifIXnt10is_array_vIT_EEiE4typeELi0EEEvPSA_ (__loc=0x7f7001091018) at /build/contrib/llvm-project/libcxx/include/__memory/construct_at.h:88
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #27 std::__1::allocator_traits<std::__1::allocator<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > > > >::destroy[abi:v15007]<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >, void, void>(std::__1::allocator<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > > >&, std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >*) (__p=0x7f7001091018) at /build/contrib/llvm-project/libcxx/include/__memory/allocator_traits.h:317
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #28 std::__1::__shared_ptr_emplace<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > >, std::__1::allocator<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > > > >::__on_zero_shared (this=0x7f7001091000) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:309
2024-09-12 16:44:40         __tmp = <optimized out>
2024-09-12 16:44:40 #29 0x0000000010caf2c0 in std::__1::__shared_count::__release_shared[abi:v15007]() (this=0x7f7001091000) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:174
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #30 std::__1::__shared_weak_count::__release_shared[abi:v15007]() (this=0x7f7001091000) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:215
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #31 std::__1::shared_ptr<std::__1::vector<std::__1::shared_ptr<DB::IProcessor>, std::__1::allocator<std::__1::shared_ptr<DB::IProcessor> > > >::~shared_ptr[abi:v15007]() (this=0x7f6e41393c30) at /build/contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:702
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #32 DB::QueryPipeline::~QueryPipeline (this=this@entry=0x7f6e41393b98) at /build/src/QueryPipeline/QueryPipeline.cpp:49
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #33 0x0000000010cb46c2 in DB::QueryPipeline::reset (this=0x7f6fd2302868) at /build/src/QueryPipeline/QueryPipeline.cpp:698
2024-09-12 16:44:40         to_remove = {resources = {interpreter_context = {__begin_ = 0x7f708e4053d0, __end_ = 0x7f708e405400, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::shared_ptr<DB::Context const>*, 0, false>> = {__value_ = 0x7f708e405400}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::shared_ptr<DB::Context const> >, 1, true>> = {<std::__1::allocator<std::__1::shared_ptr<DB::Context const> >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::shared_ptr<DB::Context const> > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}, storage_holders = {__begin_ = 0x7f7143eeeba0, __end_ = 0x7f7143eeebc0, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::shared_ptr<DB::IStorage>*, 0, false>> = {__value_ = 0x7f7143eeebc0}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::shared_ptr<DB::IStorage> >, 1, true>> = {<std::__1::allocator<std::__1::shared_ptr<DB::IStorage> >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::shared_ptr<DB::IStorage> > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}, table_locks = {__begin_ = 0x7f7000fd7ba0, __end_ = 0x7f7000fd7bc0, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::shared_ptr<DB::RWLockImpl::LockHolderImpl>*, 0, false>> = {__value_ = 0x7f7000fd7bc0}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::shared_ptr<DB::RWLockImpl::LockHolderImpl> >, 1, true>> = {<std::__1::allocator<std::__1::shared_ptr<DB::RWLockImpl::LockHolderImpl> >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::shared_ptr<DB::RWLockImpl::LockHolderImpl> > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}, query_id_holders = {__begin_ = 0x0, __end_ = 0x0, __end_cap_ = {<std::__1::__compressed_pair_elem<std::__1::shared_ptr<DB::QueryIdHolder>*, 0, false>> = {__value_ = 0x0}, <std::__1::__compressed_pair_elem<std::__1::allocator<std::__1::shared_ptr<DB::QueryIdHolder> >, 1, true>> = {<std::__1::allocator<std::__1::shared_ptr<DB::QueryIdHolder> >> = {<std::__1::__non_trivial_if<true, std::__1::allocator<std::__1::shared_ptr<DB::QueryIdHolder> > >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}}}, progress_callback = {<std::__1::__function::__maybe_derive_from_unary_function<void(DB::Progress const&)>> = {<std::__1::unary_function<DB::Progress const&, void>> = {<No data fields>}, <No data fields>}, <std::__1::__function::__maybe_derive_from_binary_function<void(DB::Progress const&)>> = {<No data fields>}, __f_ = {__buf_ = {__small = "\000%0\322o\177\000\000\003\000\000\000\001\000\000", __large = 0x7f6fd2302500}, __invoker_ = {__call_ = 0x12d98cc0 <std::__1::__function::__policy_invoker<void (DB::Progress const&)>::__call_impl<std::__1::__function::__default_alloc_func<DB::TCPHandler::receiveQuery()::$_0, void (DB::Progress const&)> >(std::__1::__function::__policy_storage const*, DB::Progress const&)>}, __policy_ = 0x18c2e998 <std::__1::__function::__policy::__choose_policy[abi:v15007]<std::__1::__function::__default_alloc_func<DB::TCPHandler::receiveQuery()::$_0, void (DB::Progress const&)> >(std::__1::integral_constant<bool, true>)::__policy_>}}, quota = {__ptr_ = 0x0, __cntrl_ = 0x0}, update_profile_events = true, processors = {__ptr_ = 0x7f7001091018, __cntrl_ = 0x7f7001091000}, input = 0x0, output = 0x0, totals = 0x0, extremes = 0x0, process_list_element = {__ptr_ = 0x7f6fb6d9ce18, __cntrl_ = 0x7f6fb6d9ce00}, output_format = 0x7f708e4bab18, num_threads = 1, concurrency_control = false}
2024-09-12 16:44:40 #34 0x0000000012d81551 in DB::TCPHandler::runImpl()::$_9::operator()() const (this=<optimized out>) at /build/src/Server/TCPHandler.cpp:574
2024-09-12 16:44:40 No locals.
2024-09-12 16:44:40 #35 0x0000000012d81551 in DB::TCPHandler::runImpl (this=0x7f6fd2302500)
2024-09-12 16:44:40         client_logs_level = <optimized out>
2024-09-12 16:44:40         finish_or_cancel = <optimized out>
2024-09-12 16:44:40         query_scope = {<std::__1::__optional_move_assign_base<DB::CurrentThread::QueryScope, false>> = {<std::__1::__optional_copy_assign_base<DB::CurrentThread::QueryScope, false>> = {<std::__1::__optional_move_base<DB::CurrentThread::QueryScope, false>> = {<std::__1::__optional_copy_base<DB::CurrentThread::QueryScope, false>> = {<std::__1::__optional_storage_base<DB::CurrentThread::QueryScope, false>> = {<std::__1::__optional_destruct_base<DB::CurrentThread::QueryScope, false>> = {{__null_state_ = 1 '\001', __val_ = {<boost::noncopyable_::noncopyable> = {<boost::noncopyable_::base_token> = {<No data fields>}, <No data fields>}, log_peak_memory_usage_in_destructor = true}}, __engaged_ = true}, <No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, <std::__1::__sfinae_ctor_base<false, false>> = {<No data fields>}, <std::__1::__sfinae_assign_base<false, false>> = {<No data fields>}, <No data fields>}
2024-09-12 16:44:40         exception = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::Exception*, 0, false>> = {__value_ = 0x0}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::Exception>, 1, true>> = {<std::__1::default_delete<DB::Exception>> = {<No data fields>}, <No data fields>}, <No data fields>}}
2024-09-12 16:44:40         thread_trace_context = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::OpenTelemetry::TracingContextHolder*, 0, false>> = {__value_ = 0x7f6fd4ce5550}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::OpenTelemetry::TracingContextHolder>, 1, true>> = {<std::__1::default_delete<DB::OpenTelemetry::TracingContextHolder>> = {<No data fields>}, <No data fields>}, <No data fields>}}
2024-09-12 16:44:40         query_duration_already_logged = false
2024-09-12 16:44:40         network_error = false
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40         log_query_duration = {this = 0x7f6fd2302500, query_duration_already_logged = @0x7f6e41393e1f}
2024-09-12 16:44:40         user_expired = false
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40 #36 0x0000000012d971f9 in DB::TCPHandler::run (this=0xd9d) at /build/src/Server/TCPHandler.cpp:2484
2024-09-12 16:44:40         e = <optimized out>
2024-09-12 16:44:40 #37 0x00000000165e5ee7 in Poco::Net::TCPServerConnection::start (this=0xd9d) at /build/base/poco/Net/src/TCPServerConnection.cpp:43
2024-09-12 16:44:40         exc = <optimized out>
2024-09-12 16:44:40         exc = <optimized out>
2024-09-12 16:44:40 #38 0x00000000165e63be in Poco::Net::TCPServerDispatcher::run (this=0x7f715d584f00) at /build/base/poco/Net/src/TCPServerDispatcher.cpp:115
2024-09-12 16:44:40         pConnection = <optimized out>
2024-09-12 16:44:40         pCNf = <optimized out>
2024-09-12 16:44:40         pNf = {_ptr = 0x7f726cb90b00}
2024-09-12 16:44:40         lock = {_mutex = @0x0}
2024-09-12 16:44:40         exc = <optimized out>
2024-09-12 16:44:40         exc = <optimized out>
2024-09-12 16:44:40         guard = {_ptr = 0x7f715d584f00}
2024-09-12 16:44:40         idleTime = <optimized out>
2024-09-12 16:44:40 #39 0x0000000016592932 in Poco::PooledThread::run (this=0x7f6fbbdded80) at /build/base/poco/Foundation/src/ThreadPool.cpp:205
2024-09-12 16:45:19         lock = {_mutex = @0x7f6fbbddefa8}
2024-09-12 16:45:19         pTarget = 0x7f715d584f00
2024-09-12 16:45:19         exc = <optimized out>
2024-09-12 16:45:19         exc = <optimized out>
2024-09-12 16:46:11         thread_status = {<boost::noncopyable_::noncopyable> = {<boost::noncopyable_::base_token> = {<No data fields>}, <No data fields>}, thread_id = 8451, os_thread_priority = 0, performance_counters = {counters = 0x7f7154f51800, counters_holder = {__ptr_ = {<std::__1::__compressed_pair_elem<std::__1::atomic<unsigned long>*, 0, false>> = {__value_ = 0x7f7154f51800}, <std::__1::__compressed_pair_elem<std::__1::default_delete<std::__1::atomic<unsigned long> []>, 1, true>> = {<std::__1::default_delete<std::__1::atomic<unsigned long> []>> = {<No data fields>}, <No data fields>}, <No data fields>}}, parent = 0x7f708e8b6a60, trace_profile_events = false, level = VariableContext::Thread, static num_counters = {t = 714}}, current_performance_counters = 0x7f6e41394958, memory_tracker = {amount = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 1288991}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, peak = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 1288991}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, soft_limit = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, hard_limit = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, profiler_limit = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, rss = {<std::__1::__atomic_base<long, true>> = {<std::__1::__atomic_base<long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<long>> = {__a_value = 27306194}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, profiler_step = 0, fault_probability = 0, sample_probability = -1, min_allocation_size_bytes = 0, max_allocation_size_bytes = 0, parent = {<std::__1::__atomic_base<MemoryTracker*, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<MemoryTracker*>> = {__a_value = 0x7f708e8b6a80}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, metric = {<std::__1::__atomic_base<StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<StrongTypedef<unsigned long, CurrentMetrics::MetricTag> >> = {__a_value = {t = 296}}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, description_ptr = {<std::__1::__atomic_base<char const*, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<char const*>> = {__a_value = 0x1a851dc "(for thread)"}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, max_wait_time = {<std::__1::__atomic_base<std::__1::chrono::duration<long long, std::__1::ratio<1l, 1000000l> >, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<std::__1::chrono::duration<long long, std::__1::ratio<1l, 1000000l> > >> = {__a_value = {__rep_ = 0}}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, overcommit_tracker = {<std::__1::__atomic_base<OvercommitTracker*, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<OvercommitTracker*>> = {__a_value = 0x0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, log_peak_memory_usage_in_destructor = true, static USAGE_EVENT_NAME = <optimized out>, static PEAK_USAGE_EVENT_NAME = <optimized out>, level = VariableContext::Thread}, untracked_memory = 52551, untracked_memory_limit = 1048576, progress_in = {read_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 1}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, read_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 1}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, total_rows_to_read = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 1}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, total_bytes_to_read = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, written_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, written_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, result_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, result_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, elapsed_ns = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, real_time_microseconds = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}}, progress_out = {read_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, read_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, total_rows_to_read = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, total_bytes_to_read = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, written_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, written_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, result_rows = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, result_bytes = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, elapsed_ns = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}, real_time_microseconds = {<std::__1::__atomic_base<unsigned long, true>> = {<std::__1::__atomic_base<unsigned long, false>> = {__a_ = {<std::__1::__cxx_atomic_base_impl<unsigned long>> = {__a_value = 0}, <No data fields>}, static is_always_lock_free = <optimized out>}, <No data fields>}, <No data fields>}}, read_resource_link = {queue = 0x0}, write_resource_link = {queue = 0x0}, thread_group = {__ptr_ = 0x7f708e8b6a18, __cntrl_ = 0x7f708e8b6a00}, global_context = {__ptr_ = 0x7f726eae8200, __cntrl_ = 0x7f726debf580}, query_context = {__ptr_ = 0x7f6fd85c5c00, __cntrl_ = 0x7f708e219260}, fatal_error_callback = {<std::__1::__function::__maybe_derive_from_unary_function<void()>> = {<No data fields>}, <std::__1::__function::__maybe_derive_from_binary_function<void()>> = {<No data fields>}, __f_ = {__buf_ = {__small = "\000%0\322o\177\000\000ed\000\001p\177\000", __large = 0x7f6fd2302500}, __invoker_ = {__call_ = 0x12d97a20 <std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::TCPHandler::runImpl()::$_0, void ()> >(std::__1::__function::__policy_storage const*)>}, __policy_ = 0x18c2e818 <std::__1::__function::__policy::__choose_policy[abi:v15007]<std::__1::__function::__default_alloc_func<DB::TCPHandler::runImpl()::$_0, void ()> >(std::__1::integral_constant<bool, true>)::__policy_>}}, local_data = {profile_queue_ptr = {__ptr_ = 0x7f6fd4aa3a58, __cntrl_ = 0x7f6fd4aa3a40}, logs_queue_ptr = {__ptr_ = 0x7f7039944218, __cntrl_ = 0x7f7039944200}, client_logs_level = DB::LogsLevel::warning, query_for_logs = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x7f726cbe2c00 "SELECT max(`__table2`.`a`) AS `MAX(test_right.a)` FROM `test_of0sadkf`.`test_left` AS `__table1` ALL INNER JOIN `test_of0sadkf`.`test_right` AS `__table2` ON `__table1`.`b` = `__table2`.`b`", __size_ = 189, __cap_ = 192, __is_long_ = 1}, __s = {__data_ = "\000,\276lr\177\000\000\275\000\000\000\000\000\000\000\300\000\000\000\000\000", __padding_ = 0x7f6e41394b57 "\200\257\212z0\3223O\201\030j\213\216p\177", __size_ = 0 '\000', __is_long_ = 1 '\001'}, __r = {__words = {140129427401728, 189, 9223372036854776000}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}, normalized_query_hash = 9317723131902331567, query_is_canceled_predicate = {<std::__1::__function::__maybe_derive_from_unary_function<bool()>> = {<No data fields>}, <std::__1::__function::__maybe_derive_from_binary_function<bool()>> = {<No data fields>}, __f_ = {__buf_ = {__small = "\030j\213\216p\177\000\000\245\245\245\245\245\245\245\245", __large = 0x7f708e8b6a18}, __invoker_ = {__call_ = 0x119215c0 <std::__1::__function::__policy_invoker<bool ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ThreadGroup::ThreadGroup(std::__1::shared_ptr<DB::Context const>, std::__1::function<void ()>)::$_0, bool ()> >(std::__1::__function::__policy_storage const*)>}, __policy_ = 0x18bf6320 <std::__1::__function::__policy::__choose_policy[abi:v15007]<std::__1::__function::__default_alloc_func<DB::ThreadGroup::ThreadGroup(std::__1::shared_ptr<DB::Context const>, std::__1::function<void ()>)::$_0, bool ()> >(std::__1::integral_constant<bool, true>)::__policy_>}}}, performance_counters_finalized = true, query_id_from_query_context = {static __endian_factor = 1, __r_ = {<std::__1::__compressed_pair_elem<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >::__rep, 0, false>> = {__value_ = {{__l = {__data_ = 0x7f726cb9c920 "17de3359-bb35-474a-866f-a1ddd5b28bd2", __size_ = 36, __cap_ = 48, __is_long_ = 1}, __s = {__data_ = " É¹lr\177\000\000$\000\000\000\000\000\000\0000\000\000\000\000\000", __padding_ = 0x7f6e41394b9f "\200+\221%%\355!\006", __size_ = 0 '\000', __is_long_ = 1 '\001'}, __r = {__words = {140129427114272, 36, 9223372036854775856}}}}}, <std::__1::__compressed_pair_elem<std::__1::allocator<char>, 1, true>> = {<std::__1::allocator<char>> = {<std::__1::__non_trivial_if<true, std::__1::allocator<char> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, static npos = 18446744073709551615}, query_start_time = {point = {__d_ = {__rep_ = 1726152274448683}}}, query_profiler_real = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::QueryProfilerReal*, 0, false>> = {__value_ = 0x7f726ca761c0}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::QueryProfilerReal>, 1, true>> = {<std::__1::default_delete<DB::QueryProfilerReal>> = {<No data fields>}, <No data fields>}, <No data fields>}}, query_profiler_cpu = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::QueryProfilerCPU*, 0, false>> = {__value_ = 0x7f7069674d40}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::QueryProfilerCPU>, 1, true>> = {<std::__1::default_delete<DB::QueryProfilerCPU>> = {<No data fields>}, <No data fields>}, <No data fields>}}, last_rusage = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::RUsageCounters*, 0, false>> = {__value_ = 0x7f7154f44f90}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::RUsageCounters>, 1, true>> = {<std::__1::default_delete<DB::RUsageCounters>> = {<No data fields>}, <No data fields>}, <No data fields>}}, taskstats = {__ptr_ = {<std::__1::__compressed_pair_elem<DB::TasksStatsCounters*, 0, false>> = {__value_ = 0x7f7000fe0800}, <std::__1::__compressed_pair_elem<std::__1::default_delete<DB::TasksStatsCounters>, 1, true>> = {<std::__1::default_delete<DB::TasksStatsCounters>> = {<No data fields>}, <No data fields>}, <No data fields>}}, stopwatch = {start_ns = 4115735518901, stop_ns = 0, clock_type = 6, is_running = true}, last_performance_counters_update_time = 58360168, internal_thread = false, deleter = {<std::__1::__function::__maybe_derive_from_unary_function<void()>> = {<No data fields>}, <std::__1::__function::__maybe_derive_from_binary_function<void()>> = {<No data fields>}, __f_ = {__buf_ = {__small = "HI9An\177\000\000\000\000\000\000\000\000\000", __large = 0x7f6e41394948}, __invoker_ = {__call_ = 0x11921660 <std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ThreadStatus::attachToGroup(std::__1::shared_ptr<DB::ThreadGroup> const&, bool)::$_0, void ()> >(std::__1::__function::__policy_storage const*)>}, __policy_ = 0x18bf6350 <std::__1::__function::__policy::__choose_policy[abi:v15007]<std::__1::__function::__default_alloc_func<DB::ThreadStatus::attachToGroup(std::__1::shared_ptr<DB::ThreadGroup> const&, bool)::$_0, void ()> >(std::__1::integral_constant<bool, true>)::__policy_>}}, log = {__ptr_ = 0x7f726eac4480, __cntrl_ = 0x0}, check_current_thread_on_destruction = true}
2024-09-12 16:46:11 #40 0x0000000016590643 in Poco::ThreadImpl::runnableEntry (pThread=<optimized out>) at /build/base/poco/Foundation/src/Thread_POSIX.cpp:335
2024-09-12 16:46:11         sset = {__val = {20484, 0 <repeats 15 times>}}
2024-09-12 16:46:11         pThreadImpl = <optimized out>
2024-09-12 16:46:11         pData = {_ptr = 0x7f701f382f40}
2024-09-12 16:46:11         exc = <optimized out>
2024-09-12 16:46:11         exc = <optimized out>
2024-09-12 16:46:11 #41 0x00007f7270249ac3 in ?? () from /lib/x86_64-linux-gnu/libc.so.6
2024-09-12 16:46:11 No symbol table info available.
2024-09-12 16:46:11 #42 0x00007f72702db850 in ?? () from /lib/x86_64-linux-gnu/libc.so.6
```

The query is from `03228_join_to_rerange_right_table.sql` but I wasn't able to reproduce the failure
