ID: 69338
Title: JSON: Heap-use-after-free in join query
Description:
**Describe the bug**
A heap-use-after-free was found while running a fuzzer. This is what I reduced so far from a larger script.  The issue only happens sometimes, hence a race condition. 

**How to reproduce**

Run
```sql
SET allow_experimental_json_type = 1,type_json_skip_duplicated_paths = 1,allow_simdjson = 1;
CREATE TABLE t0 (c0 JSON, c1 Array(Nullable(Decimal))) ENGINE = Memory();
CREATE TABLE t1 AS t0;
SET min_compress_block_size = 2654980, cross_join_min_rows_to_compress = 1, insert_null_as_default = 1, check_query_single_value_result = 1, partial_merge_join_optimizations = 1, use_uncompressed_cache = 0;
INSERT INTO t0 (c0, c1) VALUES ('{"c1":[{"c1":"Uw"}]}', [-5205545.0]), ('{"c1":{"c0":{"c2":["j^)7`{"]}}}', [-183841.0, 1232295168.0]), ('{"c2":["Dh X,r<"]}', [-518583.0, -563.0, -2442132402.0, -4991142492.0, -34823.0, -5.0, -6.0]), ('{"c2":"n 8k]wa_V"}', NULL), ('{"c2":{"c0":{"c1":-98}}}', NULL), ('{"c2":36}', [-89513.0, -9306968710.0, 6332325249.0, -48245723.0]), ('{"c2":{}}', [-10755380.0, 60433.0, 4047617.0, -98905.0, -993.0, NULL, 93055562.0, 917699.0, NULL]), ('{"c0":true,"c1":"g=n4"}', [752.0, 1.0, 96.0]), ('{"c3":false}', [NULL, 4039255.0, -88372248.0, 1256111069.0, 2383.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":["7AKy`Zh",[[-94]]],"c0":"&A:2ho","c3":[[{}],{"c2":257}]}', [-7451549.0, 633.0, 7009760932.0, NULL, NULL]), ('{"c2":65}', [-12226902.0]), ('{"c1":[{"c2":{}},"Tk26#E)"],"c3":"","c3":-608}', [-342709852.0, -6359192.0, -13.0, 403.0, 88126338.0, -31192275.0, -5.0, -4840.0, -82845285.0]);
INSERT INTO t0 (c0, c1) VALUES ('{"c0":[":+k,"]}', [-265468152.0, 96787546.0, -8980013521.0, 9164448735.0, -1447.0]), ('{"c0":[[{}]],"c0":{"c0":973,"c0":-345}}', [50.0, NULL, 805297790.0, 3038967.0, 7847438.0, 5716507241.0, 26414475.0]), ('{"c2":["7/jinz|"]}', NULL), ('{"c2":972}', [10507.0, -9616192.0, 595.0, -6102996.0, NULL, -17.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c3":{},"c2":[true,"US","a.;lxbvH1w"],"c3":{}}', [NULL, -5633149870.0, -1557199.0, -686626.0, NULL, 22726.0, 9771277778.0, -684868.0]), ('{"c3":{}}', [-502.0, 16260784.0, -584.0, 2265729.0, 1.0, 3768742.0]), ('{"c1":-570}', []), ('{"c1":[[312]],"c1":-27}', [60.0, 4.0, -3054.0, -216.0, 85786.0, -16407500.0, 1.0, -64565119.0]), ('{"c2":{"c1":"CM0tk"}}', [-3571176.0, -24519.0, 757451.0]), ('{"c1":767,"c3":421}', [-6116211.0, NULL, -77835774.0]), ('{"c0":805}', [5345543778.0, -6493852.0, 461884.0, -3158812.0, -3.0, 1.0]);
INSERT INTO t0 (c0, c1) VALUES ('{"c1":669,"c1":[{"c3":-101},{"c2":[443]}]}', [NULL, -50848.0, 9270050424.0, 439285082.0, 4991131460.0, 5324167069.0]), ('{"c1":{"c0":654}}', [18184400.0, 1165.0, -9067743190.0, 55008.0, 84573.0, 312777.0, -38.0, -180.0]), (NULL, [-51431.0, -205.0, 6391704.0, -3531393554.0, 4.0, -445378.0, 4499335205.0]), ('{"c2":-973}', [-13697135.0, -3232582571.0, 5063774471.0, -671011.0, 1882007.0, -94.0, -42828350.0, -9.0]), ('{"c0":[{}]}', []), ('{"c0":[961,"FE"],"c2":-74}', [-149626420.0]), ('{"c1":[-936,false]}', [-5436.0, -4267685.0, -9337344399.0, 90404.0, -24037337.0]), ('{"c1":[null,{}]}', [-50821332.0]), ('{"c0":"sC06!j0Y,W"}', [4834282.0, -863431.0, -535818460.0, 9592396.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":null,"c1":"bo^v6"}', [-1719.0, -16074.0, -3.0]), ('{"c0":{"c0":{}}}', [-3826.0, 2.0, 160017.0, 19500513.0, -8.0, -739458.0, NULL, 4420975388.0, -5230674.0]), ('{"c1":{"c2":326,"c3":{"c2":[-66]}}}', [-29.0, 742516.0, -6328.0, NULL, -1.0, 3.0, 877215.0]), ('{"c1":[{"c1":{}}]}', [168872177.0, 48258375.0, -6983476.0, -7633.0, 1.0]), ('{"c3":{"c0":306}}', [-64221197.0, NULL, NULL, -3753326.0, -10665.0]), ('{"c1":[";~R&R2Eb9o","|abDlI``-j"]}', [NULL, 8.0, 697608174.0, 323490017.0]), ('{"c2":[[["y(4:erKU/(",423],[null]],[false,[-137]],-282],"c0":937}', []), ('{"c0":{"c3":true}}', []);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":{}}', [-702.0]), ('{"c2":true}', [8756332921.0, 1128192142.0]), ('{"c3":"iNGbzf","c1":{}}', [-442.0, 1439.0, -58.0, -6321.0, 9803746.0, -98.0]), ('{"c2":{"c0":[true,25],"c3":-887},"c3":true}', []), ('{"c3":[{"c3":[-568,true,""],"c1":{}},[{},{}],{"c2":-755}],"c0":{"c3":{"c3":null,"c3":{}},"c0":{"c3":638}}}', [2.0, 96001085.0]), ('{"c0":{}}', [524.0, NULL, -1252951.0, 1017260.0, -81620.0]), ('{"c3":{}}', [6.0]), ('{"c2":{"c0":{},"c0":{}}}', [-578.0, -6053615.0, -927647.0, 55.0, 29276.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c1":{"c2":{},"c0":{}},"c1":{"c0":{}}}', NULL), ('{"c2":{"c2":{"c2":[true,null],"c2":{}}}}', NULL), ('{"c0":[null],"c1":{}}', [58.0, 630440989.0, -64846.0, -7344.0, -220570.0, -2.0, -1.0]), ('{"c3":{}}', [-28.0, 113441645.0]), ('{"c0":null}', [-6.0, -80605.0]), ('{"c1":null}', [NULL, 68176530.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":"O(w1RrE","c3":598,"c1":{"c2":{"c2":-476,"c1":{}}}}', []), ('{"c2":{"c1":[{},{},-517],"c1":{"c3":{},"c0":-392,"c3":"A7_a"},"c0":"Lcuchjta"},"c0":-939}', [-592.0, -21901.0, -19.0, -268264638.0, 43.0, -4676673989.0, -9055.0, -44.0, -769.0]), ('{"c2":-500}', []), ('{"c3":["Yf-{*M,Z[b"],"c3":[[[false,true],-23],{"c1":{}}]}', [-4.0, -76.0, -1834.0, 116114.0]), ('{"c1":{"c3":{"c0":{}},"c2":{"c2":{},"c1":[-766,":o;o]B@b 5"],"c2":["[ZL@tVniTðŸ˜‚"]}},"c2":"G","c3":true}', [-424454555.0, 464554127.0, -271.0, -6767008.0]), ('{"c0":719}', [621.0, -640.0]), ('{"c3":"T4Wz"}', [-511.0, -1.0, -83925131.0, 264491.0, -1.0]), ('{"c1":[["i]6yMcs|cB",true],{}]}', [-6.0, 83219.0, -6735.0, 192018793.0, 1956.0, -9573927.0, 84699.0, 54263916.0, 631.0]), ('{"c3":{"c0":74}}', [1206189.0, -7592480392.0, -93161125.0, 817865670.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c3":[-546]}', [2.0, NULL, -1326235.0]), ('{"c3":672}', []), ('{"c0":{}}', [7.0, 59133.0, -56738201.0, -49026173.0, -81121.0]), ('{"c0":442}', [-8408.0, 691.0, -7.0, -253.0]), ('{"c3":{},"c1":{}}', [4931930.0, -7377.0, 158.0, 36156.0, 803877.0, NULL, NULL, 62.0, -9846.0]), (NULL, [-1758064.0, 4290.0, 4775.0, NULL, 22.0, -439.0]), ('{"c2":["",136],"c0":"ib"}', [2645931.0, -674758808.0, 5014674.0, 76.0, -1355423029.0, -7520419854.0, -6.0, 78413978.0, -4011.0]), ('{"c1":{}}', [NULL, -544875204.0]), ('{"c3":[[170]]}', [NULL, NULL, 73890.0]), ('{"c1":{}}', [183547.0, 93516376.0, 5.0, -720.0, -749201.0, 123727322.0, -65.0]);
INSERT INTO t0 (c0, c1) VALUES ('{"c1":"","c0":274}', NULL), ('{"c0":[":0pN9k*W"]}', [60.0, 25.0, 6.0, 9520.0, 90466666.0, -3.0]);
INSERT INTO t0 (c0, c1) VALUES ('{"c0":{"c3":{"c1":[null]}},"c2":{"c0":92}}', NULL), ('{"c2":{"c2":[true]}}', [NULL, -95331.0, NULL, 1308199.0, NULL]), ('{"c1":[[{}]]}', [276463640.0, 718712799.0, -50123.0, -12043.0, NULL]);
INSERT INTO t0 (c0, c1) VALUES ('{"c3":{"c3":[false]}}', [-260.0, NULL, -1.0, -40.0]), (NULL, []), ('{"c3":{"c3":[{}]}}', [-3117135934.0, 173.0]), ('{"c1":{"c3":[[-112]],"c1":"%nI"}}', [-2510.0]), ('{"c3":{}}', [-638201656.0, NULL, 18.0, 56925070.0, -6815.0, -869.0, -36617736.0]), ('{"c2":["X"]}', NULL), ('{"c0":{},"c3":[null,"*3QZc8",true]}', [-1.0, 84.0, -819479844.0]), ('{"c2":{"c2":true}}', [-107.0, NULL]), ('{"c3":true}', [-278665.0, 116.0, 18.0, 31965.0, 5711148.0, -8234.0, NULL, -19369679.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":[-225]}', [1.0, 1510841132.0, -12.0, 1307.0, -4483.0, 55.0, 9549.0]), ('{"c1":[{"c0":-728}],"c2":{"c2":[-958,{}],"c3":[true]}}', [-4053.0, -876356.0, NULL]), ('{"c3":[[[24]]],"c0":{"c1":401,"c2":{"c3":[483,null],"c1":-83},"c1":{"c1":-203}},"c3":-680}', [NULL]), ('{"c0":{}}', []), ('{"c2":{}}', [-1707859140.0, -5.0]);
INSERT INTO t0 (c0, c1) VALUES ('{"c1":false,"c1":-360,"c3":-739}', [-3868.0, 548174539.0, 78824.0, NULL, 964751.0]), ('{"c3":{"c1":-751}}', [3225.0, -333274171.0]), ('{"c3":[{"c3":false},[{}]],"c1":{"c1":{"c0":{},"c0":{},"c3":true},"c2":{"c1":{}},"c0":16},"c3":{"c1":[{},577,{}],"c0":{"c1":false,"c2":{},"c3":{}},"c1":{"c0":{},"c1":{},"c0":"Q9}f*"}}}', [-146.0, NULL, -1984141.0, -5535507413.0]), ('{"c1":[[["CYa"]]],"c1":[[892]],"c1":{"c0":null}}', []), ('{"c1":["__C`X ;Oy4"]}', [68158746.0, -173.0, 12.0, -5.0, -8881621.0, 1822742.0, 752262442.0, -97340.0]), ('{"c3":935,"c2":[-999]}', [-212414562.0]), ('{"c1":false}', []);
INSERT INTO t0 (c0, c1) VALUES ('{"c3":"w=v%C"}', [-133239.0, 41893484.0]), ('{"c0":"?D.B#["}', [-660565014.0, -3.0, 1778026873.0, -12892.0, 37295.0, -8.0, -4049.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c0":96}', [-9486418055.0, 1.0, -19153.0, -3330.0]), ('{"c1":{"c1":""}}', [-120.0]), ('{"c3":{"c2":[false,"sT"],"c2":{}},"c2":{"c0":[null],"c2":["t0-}.Dm",119]}}', [4008130576.0, -6381371.0, 660095684.0, -892497.0, -76.0, -811584704.0, NULL, 16359874.0, -315983.0]), ('{"c3":{"c1":{"c0":{}}}}', [-1086.0]), ('{"c2":{"c3":"f"}}', [3064910.0]), (NULL, [-51357.0, 8319955.0]), ('{"c1":false}', [NULL, 12020.0, 44851173.0, 89.0]), ('{"c3":[false]}', [4.0, -361122.0]), ('{"c2":[[975]],"c1":[505]}', [-833.0]), ('{"c0":{"c3":["e~"]}}', []);
INSERT INTO t0 (c0, c1) VALUES ('{"c0":{}}', [-2664277.0, NULL]), ('{"c3":{}}', [490623582.0, 2.0, -77004.0, -1101.0, -1573.0, 5.0]), ('{"c2":"!Xs.wZ{>^B"}', [8571380046.0, -27.0, 1.0, -29.0, -45787234.0]), ('{"c3":{}}', NULL), ('{"c3":[[{}],"n<>M9w9"],"c3":[[[-565]],true]}', [-4037092.0, -27.0, NULL, 8364633.0, 120211.0, -800861.0, -3.0, 656171602.0, 1480.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c2":"O<D#Igat","c2":[{},{}]}', [1559.0, NULL, -19.0, -39806978.0, NULL, -1.0]), ('{"c1":{"c1":"2DOO+@/x","c3":-715},"c2":[414,{}]}', [8889219.0, 164896.0, 9.0]), ('{"c0":[-164,true]}', [56343624.0, -22.0, -1587835977.0, -886080615.0, -491768.0]), ('{"c2":[441,-104],"c2":[-326]}', [NULL, 58478.0, 10412256.0, -87126654.0, 4.0]), ('{"c1":[{"c2":[true]},[{}]],"c1":[{"c0":[true]}]}', [8737658.0]), ('{"c0":["&}9)zR",699]}', [-177497.0, -9588529.0, -5494693.0, -605197275.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c0":[[[false]]]}', [1093795.0, -9.0]), ('{"c0":[["Tbk{JjZbH"],[-448]],"c1":[[-173,"Ub","1smY"],[true,false],-928]}', [79264.0, -5942.0, 6489268644.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c3":[null,486]}', [6.0, -94703.0, 5934259709.0, 2787468781.0]), ('{"c3":"V@zzO0","c0":[true,[[-13]]]}', NULL), ('{"c3":948}', [NULL, 290646705.0, -9509830440.0, -8.0, 398009.0, -778839.0, NULL, NULL]);
INSERT INTO t1 (c0, c1) VALUES ('{"c3":[[[true]]]}', [13.0, -137995.0, 178221101.0, 7831579.0, -71.0, 5717989341.0]), ('{"c1":[[["Rg?sQ`"]]]}', [6385881116.0]), ('{"c3":{"c3":-855,"c1":{"c3":[-636,"dTB7cTRW"],"c0":{},"c0":[349,""]},"c1":[[-474],{},"sD_N:$,f"]},"c1":{"c3":null,"c0":{"c0":null,"c2":{},"c2":";jq;&0"}}}', [91556.0, 3.0, 98551853.0, -70963.0, -9.0, -972.0]), ('{"c2":[{"c1":{},"c3":"BESfLf"},{"c2":"E[]O"}]}', []), ('{"c2":[-214]}', [886886482.0, -147518.0]), ('{"c0":[315]}', [-16044.0]), ('{"c0":112}', [2040.0]), ('{"c3":{"c2":"n`y)6f"}}', [-8.0, -9436780.0]);
INSERT INTO t1 (c0, c1) VALUES ('{"c0":[572]}', [-88.0, 418510.0, 634661.0, -21968036.0, 4679032593.0, 24249254.0, -65293468.0, 5844420.0]), ('{"c2":[{}]}', [-45461.0, -10839002.0, NULL, 79.0, -598357.0, -962.0]), ('{"c2":{"c1":919,"c0":{}}}', [96561.0, 4925250.0, 972.0, -900104.0, -753.0, NULL, 5880.0]), ('{"c0":[-978],"c2":{}}', [-49801790.0, -4729553.0]), (NULL, [NULL, 21.0, 235044.0, -193.0, -4871144646.0, 52.0, 69832.0, -38731.0, NULL]), ('{"c0":{}}', [-37.0]), ('{"c2":"e(b^QdQA","c0":{"c2":[[false]]}}', [817.0, -915.0, -70628.0, 81.0, -339.0, 631594.0, NULL, -984.0, 818940950.0]), ('{"c0":true,"c3":{"c1":null},"c2":[767,{}]}', [8708779778.0, -130783.0]), ('{"c2":-131}', [-87997.0, -27054.0, 187.0, NULL, 807390381.0, NULL, 18.0, -163140.0]), ('{"c1":[[42]]}', [-266584.0, -893661.0, 1869508617.0, 7.0, 531402010.0, -9164798497.0, -78.0, 9727950289.0]);
SELECT 1 FROM t1 CROSS JOIN t0;
```
The SELECT query may produce a heap-use-after free.

Here is the sanitizer output:

```
=================================================================
==758716==ERROR: AddressSanitizer: heap-use-after-free on address 0x50c00020d3b0 at pc 0x555582d48909 bp 0x7ffad7df31d0 sp 0x7ffad7df31c8
READ of size 8 at 0x50c00020d3b0 thread T672 (QueryPipelineEx)
    #0 0x555582d48908 in std::__1::shared_ptr<DB::ColumnObject::Statistics const>::shared_ptr[abi:v15007](std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&) contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:593:22
    #1 0x555582d48908 in DB::ColumnObject::ColumnObject(std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, unsigned long, unsigned long, unsigned long, std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&) src/Columns/ColumnObject.cpp:47:7
    #2 0x555582d6aaef in COW<DB::IColumn>::mutable_ptr<DB::ColumnObject> COWHelper<DB::IColumnHelper<DB::ColumnObject, DB::IColumn>, DB::ColumnObject>::create<std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, unsigned long&, unsigned long&, unsigned long&, std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&>(std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>&&, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>&&, COW<DB::IColumn>::mutable_ptr<DB::IColumn>&&, unsigned long&, unsigned long&, unsigned long&, std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&) src/Common/COW.h:284:71
    #3 0x555582d4a620 in DB::ColumnObject::create(std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::mutable_ptr<DB::IColumn>>>>, COW<DB::IColumn>::mutable_ptr<DB::IColumn>, unsigned long, unsigned long, unsigned long, std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&) src/Columns/ColumnObject.cpp:118:12
    #4 0x555582d4a620 in DB::ColumnObject::create(std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>> const&, std::__1::unordered_map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::__1::hash<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::equal_to<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const, COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>> const&, COW<DB::IColumn>::immutable_ptr<DB::IColumn> const&, unsigned long, unsigned long, unsigned long, std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&) src/Columns/ColumnObject.cpp:99:12
    #5 0x555582d69b87 in DB::ColumnObject::compress() const::$_0::operator()() src/Columns/ColumnObject.cpp:1107:16
    #6 0x555582d69b87 in decltype(std::declval<DB::ColumnObject::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #7 0x555582d69b87 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #8 0x555582d69b87 in std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #9 0x555582d69b87 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #10 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #11 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #12 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #13 0x555582ac4a14 in DB::ColumnArray::compress() const::$_0::operator()() const src/Columns/ColumnArray.cpp:1018:60
    #14 0x555582ac4a14 in decltype(std::declval<DB::ColumnArray::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnArray::compress() const::$_0&>(DB::ColumnArray::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #15 0x555582ac4a14 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnArray::compress() const::$_0&>(DB::ColumnArray::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #16 0x555582ac4a14 in std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #17 0x555582ac4a14 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #18 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #19 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #20 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #21 0x555582fbeb8a in DB::ColumnVariant::compress() const::$_0::operator()() src/Columns/ColumnVariant.cpp:1397:36
    #22 0x555582fbeb8a in decltype(std::declval<DB::ColumnVariant::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnVariant::compress() const::$_0&>(DB::ColumnVariant::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #23 0x555582fbeb8a in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnVariant::compress() const::$_0&>(DB::ColumnVariant::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #24 0x555582fbeb8a in std::__1::__function::__default_alloc_func<DB::ColumnVariant::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #25 0x555582fbeb8a in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnVariant::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #26 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #27 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #28 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #29 0x555582c88092 in DB::ColumnDynamic::compress() const::$_0::operator()() src/Columns/ColumnDynamic.cpp:978:65
    #30 0x555582c88092 in decltype(std::declval<DB::ColumnDynamic::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnDynamic::compress() const::$_0&>(DB::ColumnDynamic::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #31 0x555582c88092 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnDynamic::compress() const::$_0&>(DB::ColumnDynamic::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #32 0x555582c88092 in std::__1::__function::__default_alloc_func<DB::ColumnDynamic::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #33 0x555582c88092 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnDynamic::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #34 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #35 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #36 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #37 0x555582d69940 in DB::ColumnObject::compress() const::$_0::operator()() src/Columns/ColumnObject.cpp:1104:56
    #38 0x555582d69940 in decltype(std::declval<DB::ColumnObject::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #39 0x555582d69940 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #40 0x555582d69940 in std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #41 0x555582d69940 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #42 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #43 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #44 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #45 0x55557f603e8b in DB::Block::decompress() const src/Core/Block.cpp:620:42
    #46 0x555581e7be61 in DB::HashJoin::joinBlockImplCross(DB::Block&, std::__1::shared_ptr<DB::ExtraBlock>&) const src/Interpreters/HashJoin/HashJoin.cpp:784:49
    #47 0x555581e801b5 in DB::HashJoin::joinBlock(DB::Block&, std::__1::shared_ptr<DB::ExtraBlock>&) src/Interpreters/HashJoin/HashJoin.cpp:912:9
    #48 0x5555853f75ee in DB::JoiningTransform::readExecute(DB::Chunk&) src/Processors/Transforms/JoiningTransform.cpp
    #49 0x5555853f62ad in DB::JoiningTransform::transform(DB::Chunk&) src/Processors/Transforms/JoiningTransform.cpp:191:17
    #50 0x5555853f4d0e in DB::JoiningTransform::work() src/Processors/Transforms/JoiningTransform.cpp:125:9
    #51 0x555584ddc22d in DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) src/Processors/Executors/ExecutionThreadContext.cpp:47:26
    #52 0x555584ddc22d in DB::ExecutionThreadContext::executeTask() src/Processors/Executors/ExecutionThreadContext.cpp:96:9
    #53 0x555584dc09cf in DB::PipelineExecutor::executeStepImpl(unsigned long, std::__1::atomic<bool>*) src/Processors/Executors/PipelineExecutor.cpp:283:26
    #54 0x555584dc1409 in DB::PipelineExecutor::executeSingleThread(unsigned long) src/Processors/Executors/PipelineExecutor.cpp:249:5
    #55 0x555584dc2929 in DB::PipelineExecutor::spawnThreads()::$_0::operator()() const src/Processors/Executors/PipelineExecutor.cpp:386:17
    #56 0x555584dc2929 in decltype(std::declval<DB::PipelineExecutor::spawnThreads()::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #57 0x555584dc2929 in void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #58 0x555584dc2929 in std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #59 0x555584dc2929 in void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #60 0x555573bfcf62 in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #61 0x555573bfcf62 in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #62 0x555573bfcf62 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::worker(std::__1::__list_iterator<ThreadFromGlobalPoolImpl<false, true>, void*>) src/Common/ThreadPool.cpp:530:17
    #63 0x555573c0695c in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #64 0x555573c0695c in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #65 0x555573c0695c in decltype(auto) std::__1::__apply_tuple_impl[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/tuple:1789:1
    #66 0x555573c0695c in decltype(auto) std::__1::apply[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&) contrib/llvm-project/libcxx/include/tuple:1798:1
    #67 0x555573c0695c in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() src/Common/ThreadPool.h:251:13
    #68 0x555573bf601d in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #69 0x555573bf601d in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #70 0x555573bf601d in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) src/Common/ThreadPool.cpp:540:17
    #71 0x555573c00dac in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #72 0x555573c00dac in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #73 0x555573c00dac in void std::__1::__thread_execute[abi:v15007]<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/thread:284:5
    #74 0x555573c00dac in void* std::__1::__thread_proxy[abi:v15007]<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>>(void*) contrib/llvm-project/libcxx/include/thread:295:5
    #75 0x555563b75bcc in asan_thread_start(void*) crtstuff.c
    #76 0x7ffff7c9ca93 in start_thread nptl/pthread_create.c:447:8
    #77 0x7ffff7d29c3b in clone3 misc/../sysdeps/unix/sysv/linux/x86_64/clone3.S:78

0x50c00020d3b0 is located 112 bytes inside of 128-byte region [0x50c00020d340,0x50c00020d3c0)
freed by thread T721 (QueryPipelineEx) here:
    #0 0x555563bad556 in operator delete(void*, unsigned long) (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe659556) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555582b1ee2e in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::~__policy_func[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:819:13
    #2 0x555582b1ee2e in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::~function() contrib/llvm-project/libcxx/include/__functional/function.h:1184:43
    #3 0x555582b1ee2e in DB::ColumnCompressed::~ColumnCompressed() src/Columns/ColumnCompressed.h:34:7
    #4 0x555582b1ee2e in DB::ColumnCompressed::~ColumnCompressed() src/Columns/ColumnCompressed.h:34:7
    #5 0x555582ac4fe0 in void boost::sp_adl_block::intrusive_ptr_release<DB::IColumn, boost::sp_adl_block::thread_safe_counter>(boost::sp_adl_block::intrusive_ref_counter<DB::IColumn, boost::sp_adl_block::thread_safe_counter> const*) contrib/boost/boost/smart_ptr/intrusive_ref_counter.hpp:173:9
    #6 0x555582ac4fe0 in boost::intrusive_ptr<DB::IColumn const>::~intrusive_ptr() contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:100:23
    #7 0x555582ac4fe0 in DB::ColumnArray::compress() const::$_0::~$_0() src/Columns/ColumnArray.cpp:1016:9
    #8 0x555582ac4fe0 in std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::destroy[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:249:36
    #9 0x555582ac4fe0 in std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__destroy_and_delete(std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>*) contrib/llvm-project/libcxx/include/__functional/function.h:252:10
    #10 0x555582ac4fe0 in void std::__1::__function::__policy::__large_destroy<std::__1::__function::__default_alloc_func<DB::ColumnArray::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(void*) contrib/llvm-project/libcxx/include/__functional/function.h:637:7
    #11 0x555582b1ee2e in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::~__policy_func[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:819:13
    #12 0x555582b1ee2e in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::~function() contrib/llvm-project/libcxx/include/__functional/function.h:1184:43
    #13 0x555582b1ee2e in DB::ColumnCompressed::~ColumnCompressed() src/Columns/ColumnCompressed.h:34:7
    #14 0x555582b1ee2e in DB::ColumnCompressed::~ColumnCompressed() src/Columns/ColumnCompressed.h:34:7
    #15 0x555582fbec07 in void boost::sp_adl_block::intrusive_ptr_release<DB::IColumn, boost::sp_adl_block::thread_safe_counter>(boost::sp_adl_block::intrusive_ref_counter<DB::IColumn, boost::sp_adl_block::thread_safe_counter> const*) contrib/boost/boost/smart_ptr/intrusive_ref_counter.hpp:173:9
    #16 0x555582fbec07 in boost::intrusive_ptr<DB::IColumn const>::~intrusive_ptr() contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:100:23
    #17 0x555582fbec07 in boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&) contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:124:9
    #18 0x555582fbec07 in COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&) src/Common/COW.h:136:61
    #19 0x555582fbec07 in DB::ColumnVariant::compress() const::$_0::operator()() src/Columns/ColumnVariant.cpp:1397:25
    #20 0x555582fbec07 in decltype(std::declval<DB::ColumnVariant::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnVariant::compress() const::$_0&>(DB::ColumnVariant::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #21 0x555582fbec07 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnVariant::compress() const::$_0&>(DB::ColumnVariant::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #22 0x555582fbec07 in std::__1::__function::__default_alloc_func<DB::ColumnVariant::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #23 0x555582fbec07 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnVariant::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #24 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #25 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #26 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #27 0x555582c88092 in DB::ColumnDynamic::compress() const::$_0::operator()() src/Columns/ColumnDynamic.cpp:978:65
    #28 0x555582c88092 in decltype(std::declval<DB::ColumnDynamic::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnDynamic::compress() const::$_0&>(DB::ColumnDynamic::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #29 0x555582c88092 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnDynamic::compress() const::$_0&>(DB::ColumnDynamic::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #30 0x555582c88092 in std::__1::__function::__default_alloc_func<DB::ColumnDynamic::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #31 0x555582c88092 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnDynamic::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #32 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #33 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #34 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #35 0x555582d69940 in DB::ColumnObject::compress() const::$_0::operator()() src/Columns/ColumnObject.cpp:1104:56
    #36 0x555582d69940 in decltype(std::declval<DB::ColumnObject::compress() const::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #37 0x555582d69940 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__invoke_void_return_wrapper<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, false>::__call<DB::ColumnObject::compress() const::$_0&>(DB::ColumnObject::compress() const::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:470:16
    #38 0x555582d69940 in std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #39 0x555582d69940 in COW<DB::IColumn>::immutable_ptr<DB::IColumn> std::__1::__function::__policy_invoker<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #40 0x555582b1ecc2 in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #41 0x555582b1ecc2 in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #42 0x555582b1ecc2 in DB::ColumnCompressed::decompress() const src/Columns/ColumnCompressed.h:52:16
    #43 0x55557f603e8b in DB::Block::decompress() const src/Core/Block.cpp:620:42
    #44 0x555581e7be61 in DB::HashJoin::joinBlockImplCross(DB::Block&, std::__1::shared_ptr<DB::ExtraBlock>&) const src/Interpreters/HashJoin/HashJoin.cpp:784:49
    #45 0x555581e801b5 in DB::HashJoin::joinBlock(DB::Block&, std::__1::shared_ptr<DB::ExtraBlock>&) src/Interpreters/HashJoin/HashJoin.cpp:912:9
    #46 0x5555853f75ee in DB::JoiningTransform::readExecute(DB::Chunk&) src/Processors/Transforms/JoiningTransform.cpp
    #47 0x5555853f62ad in DB::JoiningTransform::transform(DB::Chunk&) src/Processors/Transforms/JoiningTransform.cpp:191:17
    #48 0x5555853f4d0e in DB::JoiningTransform::work() src/Processors/Transforms/JoiningTransform.cpp:125:9
    #49 0x555584ddc22d in DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) src/Processors/Executors/ExecutionThreadContext.cpp:47:26
    #50 0x555584ddc22d in DB::ExecutionThreadContext::executeTask() src/Processors/Executors/ExecutionThreadContext.cpp:96:9
    #51 0x555584dc09cf in DB::PipelineExecutor::executeStepImpl(unsigned long, std::__1::atomic<bool>*) src/Processors/Executors/PipelineExecutor.cpp:283:26
    #52 0x555584dc1409 in DB::PipelineExecutor::executeSingleThread(unsigned long) src/Processors/Executors/PipelineExecutor.cpp:249:5
    #53 0x555584dc2929 in DB::PipelineExecutor::spawnThreads()::$_0::operator()() const src/Processors/Executors/PipelineExecutor.cpp:386:17
    #54 0x555584dc2929 in decltype(std::declval<DB::PipelineExecutor::spawnThreads()::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #55 0x555584dc2929 in void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #56 0x555584dc2929 in std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #57 0x555584dc2929 in void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #58 0x555573bfcf62 in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #59 0x555573bfcf62 in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #60 0x555573bfcf62 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::worker(std::__1::__list_iterator<ThreadFromGlobalPoolImpl<false, true>, void*>) src/Common/ThreadPool.cpp:530:17
    #61 0x555573c0695c in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #62 0x555573c0695c in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #63 0x555573c0695c in decltype(auto) std::__1::__apply_tuple_impl[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/tuple:1789:1
    #64 0x555573c0695c in decltype(auto) std::__1::apply[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&) contrib/llvm-project/libcxx/include/tuple:1798:1
    #65 0x555573c0695c in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() src/Common/ThreadPool.h:251:13
    #66 0x555573bf601d in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #67 0x555573bf601d in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #68 0x555573bf601d in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) src/Common/ThreadPool.cpp:540:17
    #69 0x555573c00dac in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #70 0x555573c00dac in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #71 0x555573c00dac in void std::__1::__thread_execute[abi:v15007]<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/thread:284:5
    #72 0x555573c00dac in void* std::__1::__thread_proxy[abi:v15007]<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>>(void*) contrib/llvm-project/libcxx/include/thread:295:5
    #73 0x555563b75bcc in asan_thread_start(void*) crtstuff.c

previously allocated by thread T695 (QueryPipelineEx) here:
    #0 0x555563bac8d1 in operator new(unsigned long) (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe6588d1) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555582d622da in void* std::__1::__libcpp_operator_new[abi:v15007]<unsigned long>(unsigned long) contrib/llvm-project/libcxx/include/new:246:10
    #2 0x555582d622da in std::__1::__libcpp_allocate[abi:v15007](unsigned long, unsigned long) contrib/llvm-project/libcxx/include/new:272:10
    #3 0x555582d622da in std::__1::__builtin_new_allocator::__allocate_bytes(unsigned long, unsigned long) contrib/llvm-project/libcxx/include/memory:1005:25
    #4 0x555582d622da in std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__clone[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:241:9
    #5 0x555582d622da in void* std::__1::__function::__policy::__large_clone<std::__1::__function::__default_alloc_func<DB::ColumnObject::compress() const::$_0, COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>>(void const*) contrib/llvm-project/libcxx/include/__functional/function.h:632:21
    #6 0x555582d622da in std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::__policy_func[abi:v15007](std::__1::__function::__policy_func<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()> const&) contrib/llvm-project/libcxx/include/__functional/function.h:800:30
    #7 0x555582d622da in std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>::function(std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()> const&) contrib/llvm-project/libcxx/include/__functional/function.h:1117:62
    #8 0x555582d622da in DB::ColumnCompressed::ColumnCompressed(unsigned long, unsigned long, std::__1::function<COW<DB::IColumn>::immutable_ptr<DB::IColumn> ()>) src/Columns/ColumnCompressed.h:40:39
    #9 0x555582d622da in COW<DB::IColumn>::mutable_ptr<DB::ColumnCompressed> COWHelper<DB::IColumnHelper<DB::ColumnCompressed, DB::IColumn>, DB::ColumnCompressed>::create<unsigned long, unsigned long&, DB::ColumnObject::compress() const::$_0&>(unsigned long&&, unsigned long&, DB::ColumnObject::compress() const::$_0&) src/Common/COW.h:284:71
    #10 0x555582d622da in DB::ColumnObject::compress() const src/Columns/ColumnObject.cpp:1110:12
    #11 0x555582abdf17 in DB::ColumnArray::compress() const src/Columns/ColumnArray.cpp:1010:39
    #12 0x555582fbba2a in DB::ColumnVariant::compress() const src/Columns/ColumnVariant.cpp:1388:44
    #13 0x555582c81952 in DB::ColumnDynamic::compress() const src/Columns/ColumnDynamic.cpp:973:56
    #14 0x555582d618a9 in DB::ColumnObject::compress() const src/Columns/ColumnObject.cpp:1079:42
    #15 0x55557f60392b in DB::Block::compress() const src/Core/Block.cpp:611:42
    #16 0x555581e72978 in DB::HashJoin::addBlockToJoin(DB::Block const&, bool) src/Interpreters/HashJoin/HashJoin.cpp:543:43
    #17 0x5555853fbe96 in DB::FillingRightJoinSideTransform::work() src/Processors/Transforms/JoiningTransform.cpp:308:31
    #18 0x555584ddc22d in DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) src/Processors/Executors/ExecutionThreadContext.cpp:47:26
    #19 0x555584ddc22d in DB::ExecutionThreadContext::executeTask() src/Processors/Executors/ExecutionThreadContext.cpp:96:9
    #20 0x555584dc09cf in DB::PipelineExecutor::executeStepImpl(unsigned long, std::__1::atomic<bool>*) src/Processors/Executors/PipelineExecutor.cpp:283:26
    #21 0x555584dc1409 in DB::PipelineExecutor::executeSingleThread(unsigned long) src/Processors/Executors/PipelineExecutor.cpp:249:5
    #22 0x555584dc2929 in DB::PipelineExecutor::spawnThreads()::$_0::operator()() const src/Processors/Executors/PipelineExecutor.cpp:386:17
    #23 0x555584dc2929 in decltype(std::declval<DB::PipelineExecutor::spawnThreads()::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #24 0x555584dc2929 in void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::PipelineExecutor::spawnThreads()::$_0&>(DB::PipelineExecutor::spawnThreads()::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #25 0x555584dc2929 in std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #26 0x555584dc2929 in void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::PipelineExecutor::spawnThreads()::$_0, void ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #27 0x555573bfcf62 in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #28 0x555573bfcf62 in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #29 0x555573bfcf62 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::worker(std::__1::__list_iterator<ThreadFromGlobalPoolImpl<false, true>, void*>) src/Common/ThreadPool.cpp:530:17
    #30 0x555573c0695c in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #31 0x555573c0695c in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #32 0x555573c0695c in decltype(auto) std::__1::__apply_tuple_impl[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/tuple:1789:1
    #33 0x555573c0695c in decltype(auto) std::__1::apply[abi:v15007]<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()&, std::__1::tuple<>&>(void&&, std::__1::tuple<>&) contrib/llvm-project/libcxx/include/tuple:1798:1
    #34 0x555573c0695c in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&)::'lambda'()::operator()() src/Common/ThreadPool.h:251:13
    #35 0x555573bf601d in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #36 0x555573bf601d in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #37 0x555573bf601d in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) src/Common/ThreadPool.cpp:540:17
    #38 0x555573c00dac in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #39 0x555573c00dac in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #40 0x555573c00dac in void std::__1::__thread_execute[abi:v15007]<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/thread:284:5
    #41 0x555573c00dac in void* std::__1::__thread_proxy[abi:v15007]<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>>(void*) contrib/llvm-project/libcxx/include/thread:295:5
    #42 0x555563b75bcc in asan_thread_start(void*) crtstuff.c

Thread T672 (QueryPipelineEx) created by T53 (BgSchPool) here:
    #0 0x555563b5da55 in pthread_create (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe609a55) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555573bfff83 in std::__1::__libcpp_thread_create[abi:v15007](unsigned long*, void* (*)(void*), void*) contrib/llvm-project/libcxx/include/__threading_support:376:10
    #2 0x555573bfff83 in std::__1::thread::thread<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'(), void>(void&&) contrib/llvm-project/libcxx/include/thread:311:16
    #3 0x555573bf3c67 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #4 0x555573c063eb in ThreadPoolImpl<std::__1::thread>::scheduleOrThrow(std::__1::function<void ()>, Priority, unsigned long, bool) src/Common/ThreadPool.cpp:337:5
    #5 0x555573c063eb in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) src/Common/ThreadPool.h:218:38
    #6 0x555573bf8444 in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #7 0x555573bf7ce5 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleOrThrowOnError(std::__1::function<void ()>, Priority) src/Common/ThreadPool.cpp:325:5
    #8 0x55557e9a8262 in DB::ThreadPoolCallbackRunnerLocal<void, ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>, std::__1::function<void ()>>::operator()(std::__1::function<void ()>&&, Priority) src/Common/threadPoolCallbackRunner.h:167:14
    #9 0x5555840728f5 in DB::MergeTreeData::loadOutdatedDataParts(bool) src/Storages/MergeTree/MergeTreeData.cpp:2107:9
    #10 0x55557f5eb2a8 in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #11 0x55557f5eb2a8 in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #12 0x55557f5eb2a8 in DB::BackgroundSchedulePoolTaskInfo::execute() src/Core/BackgroundSchedulePool.cpp:106:9
    #13 0x55557f5f0be9 in DB::BackgroundSchedulePool::threadFunction() src/Core/BackgroundSchedulePool.cpp:304:19
    #14 0x55557f5f1be6 in DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0::operator()() const src/Core/BackgroundSchedulePool.cpp:170:79
    #15 0x55557f5f1be6 in decltype(std::declval<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #16 0x55557f5f1be6 in decltype(auto) std::__1::__apply_tuple_impl[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/tuple:1789:1
    #17 0x55557f5f1be6 in decltype(auto) std::__1::apply[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&) contrib/llvm-project/libcxx/include/tuple:1798:1
    #18 0x55557f5f1be6 in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()::operator()() src/Common/ThreadPool.h:251:13
    #19 0x55557f5f1be6 in decltype(std::declval<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>()()) std::__1::__invoke[abi:v15007]<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #20 0x55557f5f1be6 in void std::__1::__invoke_void_return_wrapper<void, true>::__call<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&>(ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #21 0x55557f5f1be6 in std::__1::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'(), void ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #22 0x55557f5f1be6 in void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'(), void ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #23 0x555573bf601d in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #24 0x555573bf601d in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #25 0x555573bf601d in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) src/Common/ThreadPool.cpp:540:17
    #26 0x555573c00dac in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #27 0x555573c00dac in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #28 0x555573c00dac in void std::__1::__thread_execute[abi:v15007]<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/thread:284:5
    #29 0x555573c00dac in void* std::__1::__thread_proxy[abi:v15007]<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>>(void*) contrib/llvm-project/libcxx/include/thread:295:5
    #30 0x555563b75bcc in asan_thread_start(void*) crtstuff.c

Thread T53 (BgSchPool) created by T0 here:
    #0 0x555563b5da55 in pthread_create (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe609a55) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555573bfff83 in std::__1::__libcpp_thread_create[abi:v15007](unsigned long*, void* (*)(void*), void*) contrib/llvm-project/libcxx/include/__threading_support:376:10
    #2 0x555573bfff83 in std::__1::thread::thread<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'(), void>(void&&) contrib/llvm-project/libcxx/include/thread:311:16
    #3 0x555573bf3c67 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #4 0x555573bf4552 in ThreadPoolImpl<std::__1::thread>::scheduleOrThrow(std::__1::function<void ()>, Priority, unsigned long, bool) src/Common/ThreadPool.cpp:337:5
    #5 0x55557f5ecec5 in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&) src/Common/ThreadPool.h:218:38
    #6 0x55557f5ecec5 in DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*) src/Core/BackgroundSchedulePool.cpp:170:22
    #7 0x55558075453d in std::__1::__unique_if<DB::BackgroundSchedulePool>::__unique_single std::__1::make_unique[abi:v15007]<DB::BackgroundSchedulePool, DB::SettingFieldNumber<unsigned long>&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, char const (&) [10]>(DB::SettingFieldNumber<unsigned long>&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, char const (&) [10]) contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714:32
    #8 0x55558075453d in DB::Context::getSchedulePool() const::$_0::operator()() const src/Interpreters/Context.cpp:3347:33
    #9 0x55558075453d in decltype(std::declval<DB::Context::getSchedulePool() const::$_0>()()) std::__1::__invoke[abi:v15007]<DB::Context::getSchedulePool() const::$_0>(DB::Context::getSchedulePool() const::$_0&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #10 0x55558075453d in void std::__1::__call_once_param<std::__1::tuple<DB::Context::getSchedulePool() const::$_0&&>>::__execute[abi:v15007]<>(std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/mutex:627:9
    #11 0x55558075453d in std::__1::__call_once_param<std::__1::tuple<DB::Context::getSchedulePool() const::$_0&&>>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/mutex:619:9
    #12 0x55558075453d in void std::__1::__call_once_proxy[abi:v15007]<std::__1::tuple<DB::Context::getSchedulePool() const::$_0&&>>(void*) contrib/llvm-project/libcxx/include/mutex:655:5
    #13 0x555591dacc14 in std::__1::__call_once(unsigned long volatile&, void*, void (*)(void*)) contrib/llvm-project/libcxx/src/mutex.cpp:242:13
    #14 0x555580727226 in void std::__1::call_once[abi:v15007]<DB::Context::getSchedulePool() const::$_0>(std::__1::once_flag&, DB::Context::getSchedulePool() const::$_0&&) contrib/llvm-project/libcxx/include/mutex:673:9
    #15 0x555580727226 in void DB::callOnce<DB::Context::getSchedulePool() const::$_0>(std::__1::once_flag&, DB::Context::getSchedulePool() const::$_0&&) src/Common/callOnce.h:13:5
    #16 0x555580727226 in DB::Context::getSchedulePool() const src/Interpreters/Context.cpp:3346:5
    #17 0x555573de2799 in DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6::operator()(Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool) const programs/server/Server.cpp:1674:29
    #18 0x555573ddfb3e in decltype(std::declval<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&>()(std::declval<Poco::AutoPtr<Poco::Util::AbstractConfiguration>>(), std::declval<bool>())) std::__1::__invoke[abi:v15007]<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool>(DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #19 0x555573ddfb3e in void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool>(DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #20 0x555573ddfb3e in std::__1::__function::__default_alloc_func<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6, void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()[abi:v15007](Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #21 0x555573ddfb3e in void std::__1::__function::__policy_invoker<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::__call_impl<std::__1::__function::__default_alloc_func<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6, void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>>(std::__1::__function::__policy_storage const*, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #22 0x555585ed8a09 in std::__1::__function::__policy_func<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()[abi:v15007](Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #23 0x555585ed8a09 in std::__1::function<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()(Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool) const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #24 0x555585ed8a09 in DB::ConfigReloader::reloadIfNewer(bool, bool, bool, bool) src/Common/Config/ConfigReloader.cpp:164:13
    #25 0x555585ed696a in DB::ConfigReloader::ConfigReloader(std::__1::basic_string_view<char, std::__1::char_traits<char>>, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&, zkutil::ZooKeeperNodeCache&&, std::__1::shared_ptr<Poco::Event> const&, std::__1::function<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>&&) src/Common/Config/ConfigReloader.cpp:30:19
    #26 0x555573db50f8 in std::__1::__unique_if<DB::ConfigReloader>::__unique_single std::__1::make_unique[abi:v15007]<DB::ConfigReloader, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>>&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, zkutil::ZooKeeperNodeCache, std::__1::shared_ptr<Poco::Event>&, DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6>(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>>&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&&, zkutil::ZooKeeperNodeCache&&, std::__1::shared_ptr<Poco::Event>&, DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&&) contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714:32
    #27 0x555573db50f8 in DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&) programs/server/Server.cpp:1518:33
    #28 0x55558c8d4936 in Poco::Util::Application::run() base/poco/Util/src/Application.cpp:315:8
    #29 0x555573d9cce1 in DB::Server::run() programs/server/Server.cpp:398:25
    #30 0x555573d9889f in mainEntryClickHouseServer(int, char**) programs/server/Server.cpp:204:20
    #31 0x555563bb02d5 in main programs/main.cpp:248:21
    #32 0x7ffff7c2a1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #33 0x7ffff7c2a28a in __libc_start_main csu/../csu/libc-start.c:360:3
    #34 0x555563adf02d in _start (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe58b02d) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)

Thread T721 (QueryPipelineEx) created by T21 (BgSchPool) here:
    #0 0x555563b5da55 in pthread_create (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe609a55) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555573bfff83 in std::__1::__libcpp_thread_create[abi:v15007](unsigned long*, void* (*)(void*), void*) contrib/llvm-project/libcxx/include/__threading_support:376:10
    #2 0x555573bfff83 in std::__1::thread::thread<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'(), void>(void&&) contrib/llvm-project/libcxx/include/thread:311:16
    #3 0x555573bf3c67 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #4 0x555573c063eb in ThreadPoolImpl<std::__1::thread>::scheduleOrThrow(std::__1::function<void ()>, Priority, unsigned long, bool) src/Common/ThreadPool.cpp:337:5
    #5 0x555573c063eb in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) src/Common/ThreadPool.h:218:38
    #6 0x555573bf8444 in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #7 0x555573bf7ce5 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleOrThrowOnError(std::__1::function<void ()>, Priority) src/Common/ThreadPool.cpp:325:5
    #8 0x55557e9a8262 in DB::ThreadPoolCallbackRunnerLocal<void, ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>, std::__1::function<void ()>>::operator()(std::__1::function<void ()>&&, Priority) src/Common/threadPoolCallbackRunner.h:167:14
    #9 0x5555840728f5 in DB::MergeTreeData::loadOutdatedDataParts(bool) src/Storages/MergeTree/MergeTreeData.cpp:2107:9
    #10 0x55557f5eb2a8 in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #11 0x55557f5eb2a8 in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #12 0x55557f5eb2a8 in DB::BackgroundSchedulePoolTaskInfo::execute() src/Core/BackgroundSchedulePool.cpp:106:9
    #13 0x55557f5f0be9 in DB::BackgroundSchedulePool::threadFunction() src/Core/BackgroundSchedulePool.cpp:304:19
    #14 0x55557f5f1be6 in DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0::operator()() const src/Core/BackgroundSchedulePool.cpp:170:79
    #15 0x55557f5f1be6 in decltype(std::declval<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&>()()) std::__1::__invoke[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #16 0x55557f5f1be6 in decltype(auto) std::__1::__apply_tuple_impl[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/tuple:1789:1
    #17 0x55557f5f1be6 in decltype(auto) std::__1::apply[abi:v15007]<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&, std::__1::tuple<>&) contrib/llvm-project/libcxx/include/tuple:1798:1
    #18 0x55557f5f1be6 in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()::operator()() src/Common/ThreadPool.h:251:13
    #19 0x55557f5f1be6 in decltype(std::declval<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>()()) std::__1::__invoke[abi:v15007]<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #20 0x55557f5f1be6 in void std::__1::__invoke_void_return_wrapper<void, true>::__call<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&>(ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'()&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #21 0x55557f5f1be6 in std::__1::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'(), void ()>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #22 0x55557f5f1be6 in void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&)::'lambda'(), void ()>>(std::__1::__function::__policy_storage const*) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #23 0x555573bf601d in std::__1::__function::__policy_func<void ()>::operator()[abi:v15007]() const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #24 0x555573bf601d in std::__1::function<void ()>::operator()() const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #25 0x555573bf601d in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) src/Common/ThreadPool.cpp:540:17
    #26 0x555573c00dac in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const src/Common/ThreadPool.cpp:252:73
    #27 0x555573c00dac in decltype(std::declval<void>()()) std::__1::__invoke[abi:v15007]<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #28 0x555573c00dac in void std::__1::__thread_execute[abi:v15007]<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/thread:284:5
    #29 0x555573c00dac in void* std::__1::__thread_proxy[abi:v15007]<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct>>, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>>(void*) contrib/llvm-project/libcxx/include/thread:295:5
    #30 0x555563b75bcc in asan_thread_start(void*) crtstuff.c

Thread T21 (BgSchPool) created by T0 here:
2024.09.12 09:04:15.349854 [ 758941 ] {} <Information> DatabaseCatalog: Have 25 tables in drop queue (0 of them are in use), will try drop 1 tables
    #0 0x555563b5da55 in pthread_create (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe609a55) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555573bfff83 in std::__1::__libcpp_thread_create[abi:v15007](unsigned long*, void* (*)(void*), void*) contrib/llvm-project/libcxx/include/__threading_support:376:10
    #2 0x555573bfff83 in std::__1::thread::thread<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'(), void>(void&&) contrib/llvm-project/libcxx/include/thread:311:16
    #3 0x555573bf3c67 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #4 0x555573bf4552 in ThreadPoolImpl<std::__1::thread>::scheduleOrThrow(std::__1::function<void ()>, Priority, unsigned long, bool) src/Common/ThreadPool.cpp:337:5
    #5 0x55557f5ecec5 in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0>(DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*)::$_0&&) src/Common/ThreadPool.h:218:38
    #6 0x55557f5ecec5 in DB::BackgroundSchedulePool::BackgroundSchedulePool(unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, char const*) src/Core/BackgroundSchedulePool.cpp:170:22
    #7 0x55558075439d in std::__1::__unique_if<DB::BackgroundSchedulePool>::__unique_single std::__1::make_unique[abi:v15007]<DB::BackgroundSchedulePool, DB::SettingFieldNumber<unsigned long>&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, char const (&) [13]>(DB::SettingFieldNumber<unsigned long>&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, StrongTypedef<unsigned long, CurrentMetrics::MetricTag> const&, char const (&) [13]) contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714:32
    #8 0x55558075439d in DB::Context::getBufferFlushSchedulePool() const::$_0::operator()() const src/Interpreters/Context.cpp:3303:46
    #9 0x55558075439d in decltype(std::declval<DB::Context::getBufferFlushSchedulePool() const::$_0>()()) std::__1::__invoke[abi:v15007]<DB::Context::getBufferFlushSchedulePool() const::$_0>(DB::Context::getBufferFlushSchedulePool() const::$_0&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #10 0x55558075439d in void std::__1::__call_once_param<std::__1::tuple<DB::Context::getBufferFlushSchedulePool() const::$_0&&>>::__execute[abi:v15007]<>(std::__1::__tuple_indices<...>) contrib/llvm-project/libcxx/include/mutex:627:9
    #11 0x55558075439d in std::__1::__call_once_param<std::__1::tuple<DB::Context::getBufferFlushSchedulePool() const::$_0&&>>::operator()[abi:v15007]() contrib/llvm-project/libcxx/include/mutex:619:9
    #12 0x55558075439d in void std::__1::__call_once_proxy[abi:v15007]<std::__1::tuple<DB::Context::getBufferFlushSchedulePool() const::$_0&&>>(void*) contrib/llvm-project/libcxx/include/mutex:655:5
    #13 0x555591dacc14 in std::__1::__call_once(unsigned long volatile&, void*, void (*)(void*)) contrib/llvm-project/libcxx/src/mutex.cpp:242:13
    #14 0x555580725fa6 in void std::__1::call_once[abi:v15007]<DB::Context::getBufferFlushSchedulePool() const::$_0>(std::__1::once_flag&, DB::Context::getBufferFlushSchedulePool() const::$_0&&) contrib/llvm-project/libcxx/include/mutex:673:9
    #15 0x555580725fa6 in void DB::callOnce<DB::Context::getBufferFlushSchedulePool() const::$_0>(std::__1::once_flag&, DB::Context::getBufferFlushSchedulePool() const::$_0&&) src/Common/callOnce.h:13:5
    #16 0x555580725fa6 in DB::Context::getBufferFlushSchedulePool() const src/Interpreters/Context.cpp:3302:5
    #17 0x555573de276d in DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6::operator()(Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool) const programs/server/Server.cpp:1673:29
    #18 0x555573ddfb3e in decltype(std::declval<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&>()(std::declval<Poco::AutoPtr<Poco::Util::AbstractConfiguration>>(), std::declval<bool>())) std::__1::__invoke[abi:v15007]<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool>(DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:394:23
    #19 0x555573ddfb3e in void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool>(DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/invoke.h:479:9
    #20 0x555573ddfb3e in std::__1::__function::__default_alloc_func<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6, void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()[abi:v15007](Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) contrib/llvm-project/libcxx/include/__functional/function.h:235:12
    #21 0x555573ddfb3e in void std::__1::__function::__policy_invoker<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::__call_impl<std::__1::__function::__default_alloc_func<DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6, void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>>(std::__1::__function::__policy_storage const*, Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool) contrib/llvm-project/libcxx/include/__functional/function.h:716:16
    #22 0x555585ed8a09 in std::__1::__function::__policy_func<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()[abi:v15007](Poco::AutoPtr<Poco::Util::AbstractConfiguration>&&, bool&&) const contrib/llvm-project/libcxx/include/__functional/function.h:848:16
    #23 0x555585ed8a09 in std::__1::function<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>::operator()(Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool) const contrib/llvm-project/libcxx/include/__functional/function.h:1197:12
    #24 0x555585ed8a09 in DB::ConfigReloader::reloadIfNewer(bool, bool, bool, bool) src/Common/Config/ConfigReloader.cpp:164:13
    #25 0x555585ed696a in DB::ConfigReloader::ConfigReloader(std::__1::basic_string_view<char, std::__1::char_traits<char>>, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&, zkutil::ZooKeeperNodeCache&&, std::__1::shared_ptr<Poco::Event> const&, std::__1::function<void (Poco::AutoPtr<Poco::Util::AbstractConfiguration>, bool)>&&) src/Common/Config/ConfigReloader.cpp:30:19
    #26 0x555573db50f8 in std::__1::__unique_if<DB::ConfigReloader>::__unique_single std::__1::make_unique[abi:v15007]<DB::ConfigReloader, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>>&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, zkutil::ZooKeeperNodeCache, std::__1::shared_ptr<Poco::Event>&, DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6>(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>>&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&&, zkutil::ZooKeeperNodeCache&&, std::__1::shared_ptr<Poco::Event>&, DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&)::$_6&&) contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:714:32
    #27 0x555573db50f8 in DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&) programs/server/Server.cpp:1518:33
    #28 0x55558c8d4936 in Poco::Util::Application::run() base/poco/Util/src/Application.cpp:315:8
    #29 0x555573d9cce1 in DB::Server::run() programs/server/Server.cpp:398:25
    #30 0x555573d9889f in mainEntryClickHouseServer(int, char**) programs/server/Server.cpp:204:20
    #31 0x555563bb02d5 in main programs/main.cpp:248:21
    #32 0x7ffff7c2a1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #33 0x7ffff7c2a28a in __libc_start_main csu/../csu/libc-start.c:360:3
    #34 0x555563adf02d in _start (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe58b02d) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)

Thread T695 (QueryPipelineEx) created by T0 here:
    #0 0x555563b5da55 in pthread_create (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe609a55) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)
    #1 0x555573bfff83 in std::__1::__libcpp_thread_create[abi:v15007](unsigned long*, void* (*)(void*), void*) contrib/llvm-project/libcxx/include/__threading_support:376:10
    #2 0x555573bfff83 in std::__1::thread::thread<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'(), void>(void&&) contrib/llvm-project/libcxx/include/thread:311:16
    #3 0x555573bf3c67 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #4 0x555573c063eb in ThreadPoolImpl<std::__1::thread>::scheduleOrThrow(std::__1::function<void ()>, Priority, unsigned long, bool) src/Common/ThreadPool.cpp:337:5
    #5 0x555573c063eb in ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) src/Common/ThreadPool.h:218:38
    #6 0x555573bf8444 in void ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleImpl<void>(std::__1::function<void ()>, Priority, std::__1::optional<unsigned long>, bool) src/Common/ThreadPool.cpp:252:35
    #7 0x555573bf7ce5 in ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::scheduleOrThrowOnError(std::__1::function<void ()>, Priority) src/Common/ThreadPool.cpp:325:5
    #8 0x55557e9a8262 in DB::ThreadPoolCallbackRunnerLocal<void, ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>, std::__1::function<void ()>>::operator()(std::__1::function<void ()>&&, Priority) src/Common/threadPoolCallbackRunner.h:167:14
    #9 0x5555808718d1 in DB::DatabaseCatalog::loadMarkedAsDroppedTables() src/Interpreters/DatabaseCatalog.cpp:1036:9
    #10 0x555573db84c3 in DB::Server::main(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>>> const&) programs/server/Server.cpp:2081:26
    #11 0x55558c8d4936 in Poco::Util::Application::run() base/poco/Util/src/Application.cpp:315:8
    #12 0x555573d9cce1 in DB::Server::run() programs/server/Server.cpp:398:25
    #13 0x555573d9889f in mainEntryClickHouseServer(int, char**) programs/server/Server.cpp:204:20
    #14 0x555563bb02d5 in main programs/main.cpp:248:21
    #15 0x7ffff7c2a1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #16 0x7ffff7c2a28a in __libc_start_main csu/../csu/libc-start.c:360:3
    #17 0x555563adf02d in _start (/home/ubuntu/repositories/clickhouse-master/BUILD/bin/clickhouse+0xe58b02d) (BuildId: 78f13e4341c4a56af96e0db24ce3334ec0c22f04)

SUMMARY: AddressSanitizer: heap-use-after-free contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:593:22 in std::__1::shared_ptr<DB::ColumnObject::Statistics const>::shared_ptr[abi:v15007](std::__1::shared_ptr<DB::ColumnObject::Statistics const> const&)
Shadow bytes around the buggy address:
  0x50c00020d100: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x50c00020d180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x50c00020d200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x50c00020d280: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x50c00020d300: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
=>0x50c00020d380: fd fd fd fd fd fd[fd]fd fa fa fa fa fa fa fa fa
  0x50c00020d400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x50c00020d480: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x50c00020d500: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
  0x50c00020d580: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x50c00020d600: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==758716==ABORTING
```
