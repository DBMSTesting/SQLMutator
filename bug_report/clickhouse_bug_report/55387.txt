ID: 55387
Title: DWARF5 parse error leading to segfault in Clickhouse Keeper
Description:
**Describe what's wrong**

Clickhouse Keeper segfaults while parsing
DWARF5 debug info. 

**Does it reproduce on recent release?**

Yes, on 23.8.2.7

**How to reproduce**

Wasn't able to reproduce yet

**Expected behavior**

Clickhouse Keeper doesn't segfault

**Error message and/or stacktrace**

```
2023.09.26 18:59:07.369126 [ 1044486 ] {} <Fatal> BaseDaemon: 13.1. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: ~__policy_func
2023.09.26 18:59:07.369141 [ 1044486 ] {} <Fatal> BaseDaemon: 13.2. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:1174: ~function
2023.09.26 18:59:07.369145 [ 1044486 ] {} <Fatal> BaseDaemon: 13. ./build_docker/./src/Common/Dwarf.cpp:1210: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.373577 [ 1044486 ] {} <Fatal> BaseDaemon: 14.1. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>::size[abi:v15000]() const
2023.09.26 18:59:07.373590 [ 1044486 ] {} <Fatal> BaseDaemon: 14. ./build_docker/./src/Common/Dwarf.cpp:1068: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.380493 [ 1044486 ] {} <Fatal> BaseDaemon: 15. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.389961 [ 1044486 ] {} <Fatal> BaseDaemon: 16. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.404777 [ 1044486 ] {} <Fatal> BaseDaemon: 17.1. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: ~__policy_func
2023.09.26 18:59:07.404803 [ 1044486 ] {} <Fatal> BaseDaemon: 17.2. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:1174: ~function
2023.09.26 18:59:07.404808 [ 1044486 ] {} <Fatal> BaseDaemon: 17. ./build_docker/./src/Daemon/BaseDaemon.cpp:405: SignalListener::onFault(int, siginfo_t const&, ucontext_t*, StackTrace const&, std::vector<std::array<void*, 45ul>, std::allocator<std::array<void*, 45ul>>> const&, unsigned int, DB::ThreadStatus*) const @ 0x000000000c8c30a1 in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.435194 [ 1044486 ] {} <Fatal> BaseDaemon: 18.1. inlined from ./build_docker/./src/Daemon/BaseDaemon.cpp:274: operator()
2023.09.26 18:59:07.435239 [ 1044486 ] {} <Fatal> BaseDaemon: 18.2. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<SignalListener::run()::'lambda'()>()()) std::__invoke[abi:v15000]<SignalListener::run()::'lambda'()>(SignalListener::run()::'lambda'()&&)
2023.09.26 18:59:07.435251 [ 1044486 ] {} <Fatal> BaseDaemon: 18.3. inlined from ./build_docker/./contrib/llvm-project/libcxx/include/thread:284: void std::__thread_execute[abi:v15000]<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, SignalListener::run()::'lambda'()>(std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, SignalListener::run()::'lambda'()>&, std::__tuple_indices<>)
2023.09.26 18:59:07.435259 [ 1044486 ] {} <Fatal> BaseDaemon: 18. ./build_docker/./contrib/llvm-project/libcxx/include/thread:295: void* std::__thread_proxy[abi:v15000]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, SignalListener::run()::'lambda'()>>(void*) @ 0x000000000c8c0215 in /usr/lib/debug/usr/bin/clickhouse.debug
2023.09.26 18:59:07.435293 [ 1044486 ] {} <Fatal> BaseDaemon: 19. start_thread @ 0x00000000000076db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2023.09.26 18:59:07.435300 [ 1044486 ] {} <Fatal> BaseDaemon: 20. ? @ 0x000000000012161f in /lib/x86_64-linux-gnu/libc-2.27.so
2023.09.26 18:59:07.603581 [ 1044486 ] {} <Fatal> BaseDaemon: Integrity check of the executable successfully passed (checksum: A9BA33088A6E58B8A1BE882810065B9D)
2023.09.26 18:59:07.603858 [ 1044489 ] {} <Fatal> BaseDaemon: ########## Short fault info ############
2023.09.26 18:59:07.603880 [ 1044489 ] {} <Fatal> BaseDaemon: (version 23.8.2.7 (official build), build id: 8D11186275018B3F7DD7F6CCF24A69C19328DA7F, git hash: f73c8f378745d0520eec7e3519fc0ce6991639b9) (from thread 1044486) Received signal 11
2023.09.26 18:59:07.603904 [ 1044489 ] {} <Fatal> BaseDaemon: Signal description: Segmentation fault
2023.09.26 18:59:07.603911 [ 1044489 ] {} <Fatal> BaseDaemon: Address: 0x110. Access: read. Address not mapped to object.
2023.09.26 18:59:07.603918 [ 1044489 ] {} <Fatal> BaseDaemon: Stack trace: 0x000000000c8c548d 0x000000000c8c0215 0x00007f47799516db 0x00007f477967a61f
2023.09.26 18:59:07.603924 [ 1044489 ] {} <Fatal> BaseDaemon: ########################################
2023.09.26 18:59:07.603932 [ 1044489 ] {} <Fatal> BaseDaemon: (version 23.8.2.7 (official build), build id: 8D11186275018B3F7DD7F6CCF24A69C19328DA7F, git hash: f73c8f378745d0520eec7e3519fc0ce6991639b9) (from thread 1044486) (no query) Received signal Segmentation fault (11)
2023.09.26 18:59:07.603939 [ 1044489 ] {} <Fatal> BaseDaemon: Address: 0x110. Access: read. Address not mapped to object.
2023.09.26 18:59:07.603944 [ 1044489 ] {} <Fatal> BaseDaemon: Stack trace: 0x000000000c8c548d 0x000000000c8c0215 0x00007f47799516db 0x00007f477967a61f
2023.09.26 18:59:07.618904 [ 1044373 ] {} <Fatal> BaseDaemon: (version 23.8.2.7 (official build), build id: 8D11186275018B3F7DD7F6CCF24A69C19328DA7F, git hash: f73c8f378745d0520eec7e3519fc0ce6991639b9) (from thread 1044489) Terminate called for uncaught exception:
2023.09.26 18:59:07.618942 [ 1044373 ] {} <Fatal> BaseDaemon: Code: 465. DB::Exception: invalid section offset. (CANNOT_PARSE_DWARF), Stack trace (when copying this message, always include the lines below):

0. ./build_docker/./src/Common/Exception.cpp:98: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000c604bf7 in /usr/lib/debug/usr/bin/clickhouse.debug
1. ./build_docker/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [23]>(int, char const (&) [23]) @ 0x000000000c5e17c0 in /usr/lib/debug/usr/bin/clickhouse.debug
2. ./build_docker/./src/Common/Dwarf.cpp:0: DB::(anonymous namespace)::getStringFromStringSection(std::basic_string_view<char, std::char_traits<char>>, unsigned long) @ 0x000000000c5f73f5 in /usr/lib/debug/usr/bin/clickhouse.debug
3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.618983 [ 1044373 ] {} <Fatal> BaseDaemon:
0. ./build_docker/./src/Common/Exception.cpp:98: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000c604bf7 in /usr/lib/debug/usr/bin/clickhouse.debug
1. ./build_docker/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [23]>(int, char const (&) [23]) @ 0x000000000c5e17c0 in /usr/lib/debug/usr/bin/clickhouse.debug
2. ./build_docker/./src/Common/Dwarf.cpp:0: DB::(anonymous namespace)::getStringFromStringSection(std::basic_string_view<char, std::char_traits<char>>, unsigned long) @ 0x000000000c5f73f5 in /usr/lib/debug/usr/bin/clickhouse.debug
3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.619001 [ 1044373 ] {} <Fatal> BaseDaemon: 0. ./build_docker/./src/Common/Exception.cpp:98: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000c604bf7 in /usr/lib/debug/usr/bin/clickhouse.debug
1. ./build_docker/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [23]>(int, char const (&) [23]) @ 0x000000000c5e17c0 in /usr/lib/debug/usr/bin/clickhouse.debug
2. ./build_docker/./src/Common/Dwarf.cpp:0: DB::(anonymous namespace)::getStringFromStringSection(std::basic_string_view<char, std::char_traits<char>>, unsigned long) @ 0x000000000c5f73f5 in /usr/lib/debug/usr/bin/clickhouse.debug
3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.619012 [ 1044373 ] {} <Fatal> BaseDaemon: 1. ./build_docker/./contrib/llvm-project/libcxx/include/string:1499: DB::Exception::Exception<char const (&) [23]>(int, char const (&) [23]) @ 0x000000000c5e17c0 in /usr/lib/debug/usr/bin/clickhouse.debug
2. ./build_docker/./src/Common/Dwarf.cpp:0: DB::(anonymous namespace)::getStringFromStringSection(std::basic_string_view<char, std::char_traits<char>>, unsigned long) @ 0x000000000c5f73f5 in /usr/lib/debug/usr/bin/clickhouse.debug
3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.619025 [ 1044373 ] {} <Fatal> BaseDaemon: 2. ./build_docker/./src/Common/Dwarf.cpp:0: DB::(anonymous namespace)::getStringFromStringSection(std::basic_string_view<char, std::char_traits<char>>, unsigned long) @ 0x000000000c5f73f5 in /usr/lib/debug/usr/bin/clickhouse.debug
3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.619037 [ 1044373 ] {} <Fatal> BaseDaemon: 3. ./build_docker/./src/Common/Dwarf.cpp:0: DB::Dwarf::readAttribute(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::AttributeSpec, std::basic_string_view<char, std::char_traits<char>>&) const @ 0x000000000c5f68f0 in /usr/lib/debug/usr/bin/clickhouse.debug
4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
9. ./build_docker/./src/Common/Dwarf.cpp:1430: DB::Dwarf::findAddress(unsigned long, DB::Dwarf::LocationInfo&, DB::Dwarf::LocationInfoMode, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5fb726 in /usr/lib/debug/usr/bin/clickhouse.debug
10. ./build_docker/./src/Common/StackTrace.cpp:363: void toStringEveryLineImpl<std::function<void (std::basic_string_view<char, std::char_traits<char>>)>>(bool, StackTraceRefTriple const&, std::function<void (std::basic_string_view<char, std::char_traits<char>>)>&&) (.llvm.6242341780186935476) @ 0x000000000c623723 in /usr/lib/debug/usr/bin/clickhouse.debug
11. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: SignalListener::onF
2023.09.26 18:59:07.619047 [ 1044373 ] {} <Fatal> BaseDaemon: 4. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:848: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0::operator()(DB::Dwarf::Die const&) const::'lambda'(DB::Dwarf::CompilationUnit const&, unsigned long)::operator()(DB::Dwarf::CompilationUnit const&, unsigned long) const @ 0x000000000c5ffe52 in /usr/lib/debug/usr/bin/clickhouse.debug
5. ./build_docker/./src/Common/Dwarf.cpp:0: bool std::__function::__policy_invoker<bool (DB::Dwarf::Die const&)>::__call_impl<std::__function::__default_alloc_func<DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const::$_0, bool (DB::Dwarf::Die const&)>>(std::__function::__policy_storage const*, DB::Dwarf::Die const&) @ 0x000000000c5ff733 in /usr/lib/debug/usr/bin/clickhouse.debug
6. ./build_docker/./src/Common/Dwarf.cpp:516: DB::Dwarf::forEachChild(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, std::function<bool (DB::Dwarf::Die const&)>) const @ 0x000000000c5f5744 in /usr/lib/debug/usr/bin/clickhouse.debug
7. ./build_docker/./contrib/llvm-project/libcxx/include/__functional/function.h:818: DB::Dwarf::findInlinedSubroutineDieForAddress(DB::Dwarf::CompilationUnit const&, DB::Dwarf::Die const&, DB::Dwarf::LineNumberVM const&, unsigned long, std::optional<unsigned long>, std::vector<DB::Dwarf::CallLocation, std::allocator<DB::Dwarf::CallLocation>>&, unsigned long) const @ 0x000000000c5fb35d in /usr/lib/debug/usr/bin/clickhouse.debug
8. ./build_docker/./contrib/llvm-project/libcxx/include/vector:537: DB::Dwarf::findLocation(unsigned long, DB::Dwarf::LocationInfoMode, DB::Dwarf::CompilationUnit&, DB::Dwarf::LocationInfo&, std::vector<DB::Dwarf::SymbolizedFrame, std::allocator<DB::Dwarf::SymbolizedFrame>>&) const @ 0x000000000c5f9857 in /usr/lib/debug/usr/bin/clickhouse.debug
```

**Additional context**

My guess is that the issue is related to DWARF5 parsing. Looking through the code https://github.com/clickHouse/clickHouse/blob/master/src/Common/Dwarf.cpp#L566,

the algo is basically

```
readAttribute
 get_string_using_offset_table
   (  
     DW_FORM_strx[1,2,3,4] -> index = readULEB(info), readU64<1,2,3,4>(info)
   )
   getStringFromStringSection
    -> offset >= section.size()
                 str_.size()
                 DWARF.str_ (.debug_str)
       readOffset(sp) -> read 8 bytes from sp
                  str_offsets_.substr(str_offsets_base + index * 8)
                    CompilationUnit.str_offsets_base != empty
                  DWARF.str_offsets_ (.debug_str_offsets)
```

which turns into
```
index = readULEB(info) or readU64<1,2,3,4>(info)                               

read8Bytes(
    DWARF.str_offsets_ .substr(CompilationUnit.str_offsets_base + 8 * index)
) >= DWARF.str_.size()
```

(we can confirm the system is 64 bit so I omitted the 23bit branch).
`readOffset` fails which triggers another exception which in turn segfaults the binary.