ID: 16238
Title: Build Python Extension Fails with CMake Windows (using MSVC)
Description:
### What happens?

I am trying to build the Python extension on Windows using CMake to test https://github.com/duckdb/duckdb/issues/16130.

However, I am having trouble actually building it. I have submitted several PRs:

https://github.com/duckdb/duckdb/pull/16237
https://github.com/duckdb/duckdb/pull/16236
https://github.com/duckdb/duckdb/pull/16235

With those fixes I can compile the python bindings, but linking fails.

First, the bindings try to  link against pthread.lib, added here:

https://github.com/duckdb/duckdb/blob/main/scripts/package_build.py#L89

But that is unix/linux/posix, not windows. Or maybe Duckdb has its own library?

Removing pthread.lib still results in a lot of missing symbols - see below. The link command is linking all the .lib files made by CMake. But clearly i am missing something. I do see Arrow mentioned a lot in the missing symbols, do I need to pull that code in somehow?

Here is the command that is run:

`
"C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.42.34433\bin\HostX86\x64\link.exe" /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\src /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\core_functions /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\parquet /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\icu /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\tpch /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\json /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\fsst /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\fmt /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\libpg_query /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\re2 /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\miniz /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\utf8proc /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\hyperloglog /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\fastpforlib /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\skiplist /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\mbedtls /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\yyjson /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\third_party\zstd /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\json /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\tpcds /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\tpch /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\parquet /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\icu /LIBPATH:C:/Source/duckdb/out/build/x64-Debug\extension\core_functions "/LIBPATH:C:\Program Files\Python313\libs" "/LIBPATH:C:\Program Files\Python313" "/LIBPATH:C:\Program Files\Python313\PCbuild\amd64" "/LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.42.34433\ATLMFC\lib\x64" "/LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.42.34433\lib\x64" "/LIBPATH:C:\Program Files (x86)\Windows Kits\10\lib\10.0.22621.0\ucrt\x64" "/LIBPATH:C:\Program Files (x86)\Windows Kits\10\\lib\10.0.22621.0\\um\x64" "/LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.42.34433\ATLMFC\lib\x64" "/LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.42.34433\lib\x64" "/LIBPATH:C:\Program Files (x86)\Windows Kits\10\lib\10.0.22621.0\ucrt\x64" "/LIBPATH:C:\Program Files (x86)\Windows Kits\10\\lib\10.0.22621.0\\um\x64" /LIBPATH:c:\source\vcpkg\installed\x64-windows\lib /LIBPATH:c:\source\vcpkg\installed\x64-windows\debug\lib duckdb.lib core_functions.lib parquet.lib icu.lib tpch.lib json.lib ws2_32.lib rstrtmgr.lib bcrypt.lib duckdb_fsst.lib duckdb_fmt.lib duckdb_pg_query.lib duckdb_re2.lib duckdb_miniz.lib duckdb_utf8proc.lib duckdb_hyperloglog.lib duckdb_fastpforlib.lib duckdb_skiplistlib.lib duckdb_mbedtls.lib duckdb_yyjson.lib duckdb_zstd.lib json_extension.lib tpcds_extension.lib tpch_extension.lib parquet_extension.lib icu_extension.lib core_functions_extension.lib /EXPORT:PyInit_duckdb build\temp.win-amd64-cpython-313\Release\duckdb_python.obj build\temp.win-amd64-cpython-313\Release\src\arrow\arrow_array_stream.obj build\temp.win-amd64-cpython-313\Release\src\arrow\arrow_export_utils.obj build\temp.win-amd64-cpython-313\Release\src\common\exceptions.obj build\temp.win-amd64-cpython-313\Release\src\dataframe.obj build\temp.win-amd64-cpython-313\Release\src\functional\functional.obj build\temp.win-amd64-cpython-313\Release\src\importer.obj build\temp.win-amd64-cpython-313\Release\src\jupyter\jupyter_progress_bar_display.obj build\temp.win-amd64-cpython-313\Release\src\map.obj build\temp.win-amd64-cpython-313\Release\src\native\python_conversion.obj build\temp.win-amd64-cpython-313\Release\src\native\python_objects.obj build\temp.win-amd64-cpython-313\Release\src\numpy\array_wrapper.obj build\temp.win-amd64-cpython-313\Release\src\numpy\numpy_bind.obj build\temp.win-amd64-cpython-313\Release\src\numpy\numpy_result_conversion.obj build\temp.win-amd64-cpython-313\Release\src\numpy\numpy_scan.obj build\temp.win-amd64-cpython-313\Release\src\numpy\raw_array_wrapper.obj build\temp.win-amd64-cpython-313\Release\src\numpy\type.obj build\temp.win-amd64-cpython-313\Release\src\pandas\analyzer.obj build\temp.win-amd64-cpython-313\Release\src\pandas\bind.obj build\temp.win-amd64-cpython-313\Release\src\pandas\scan.obj build\temp.win-amd64-cpython-313\Release\src\path_like.obj build\temp.win-amd64-cpython-313\Release\src\pybind11\pybind_wrapper.obj build\temp.win-amd64-cpython-313\Release\src\pyconnection.obj build\temp.win-amd64-cpython-313\Release\src\pyconnection\type_creation.obj build\temp.win-amd64-cpython-313\Release\src\pyexpression.obj build\temp.win-amd64-cpython-313\Release\src\pyexpression\initialize.obj build\temp.win-amd64-cpython-313\Release\src\pyfilesystem.obj build\temp.win-amd64-cpython-313\Release\src\pyrelation.obj build\temp.win-amd64-cpython-313\Release\src\pyrelation\initialize.obj build\temp.win-amd64-cpython-313\Release\src\pyresult.obj build\temp.win-amd64-cpython-313\Release\src\pystatement.obj build\temp.win-amd64-cpython-313\Release\src\python_dependency.obj build\temp.win-amd64-cpython-313\Release\src\python_import_cache.obj build\temp.win-amd64-cpython-313\Release\src\python_replacement_scan.obj build\temp.win-amd64-cpython-313\Release\src\python_udf.obj build\temp.win-amd64-cpython-313\Release\src\typing\pytype.obj build\temp.win-amd64-cpython-313\Release\src\typing\typing.obj /OUT:build\lib.win-amd64-cpython-313\duckdb\duckdb.cp313-win_amd64.pyd /IMPLIB:build\temp.win-amd64-cpython-313\Release\duckdb.cp313-win_amd64.lib /EHsc /bigobj /wd4244 /wd4267 /wd4200 /wd26451 /wd26495 /D_CRT_SECURE_NO_WARNINGS /utf-8 /Ob0 /Od /RTC1 rstrtmgr.lib bcrypt.lib
`

And here is the output:

```
LINK : warning LNK4044: unrecognized option '/EHsc'; ignored
LINK : warning LNK4044: unrecognized option '/bigobj'; ignored
LINK : warning LNK4044: unrecognized option '/wd4244'; ignored
LINK : warning LNK4044: unrecognized option '/wd4267'; ignored
LINK : warning LNK4044: unrecognized option '/wd4200'; ignored
LINK : warning LNK4044: unrecognized option '/wd26451'; ignored
LINK : warning LNK4044: unrecognized option '/wd26495'; ignored
LINK : warning LNK4044: unrecognized option '/D_CRT_SECURE_NO_WARNINGS'; ignored
LINK : warning LNK4044: unrecognized option '/utf-8'; ignored
LINK : warning LNK4044: unrecognized option '/Ob0'; ignored
LINK : warning LNK4044: unrecognized option '/Od'; ignored
LINK : warning LNK4044: unrecognized option '/RTC1'; ignored
duckdb_utf8proc.lib(utf8proc_wrapper.cpp.obj) : error LNK2038: mismatch detected for '_ITERATOR_DEBUG_LEVEL': value '2' doesn't match value '0' in duckdb_python.obj
duckdb_utf8proc.lib(utf8proc_wrapper.cpp.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MDd_DynamicDebug' doesn't match value 'MD_DynamicRelease' in duckdb_python.obj
   Creating library build\temp.win-amd64-cpython-313\Release\duckdb.cp313-win_amd64.lib and object build\temp.win-amd64-cpython-313\Release\duckdb.cp313-win_amd64.exp
LINK : warning LNK4098: defaultlib 'MSVCRTD' conflicts with use of other libs; use /NODEFAULTLIB:library
duckdb_python.obj : error LNK2001: unresolved external symbol "class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::StatementReturnTypeToString(enum duckdb::StatementReturnType)" (?StatementReturnTypeToString@duckdb@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@W4StatementReturnType@1@@Z)
duckdb_python.obj : error LNK2001: unresolved external symbol "public: static class duckdb::vector<struct duckdb::SimplifiedToken,1> __cdecl duckdb::Parser::Tokenize(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (?Tokenize@Parser@duckdb@@SA?AV?$vector@USimplifiedToken@duckdb@@$00@2@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
duckdb_python.obj : error LNK2001: unresolved external symbol "public: static enum duckdb::RenderMode __cdecl duckdb::EnumUtil::FromString<enum duckdb::RenderMode>(char const *)" (??$FromString@W4RenderMode@duckdb@@@EnumUtil@duckdb@@SA?AW4RenderMode@1@PEBD@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: class std::unordered_map<unsigned __int64,class duckdb::shared_ptr<class duckdb::ArrowType,1>,struct std::hash<unsigned __int64>,struct std::equal_to<unsigned __int64>,class std::allocator<struct std::pair<unsigned __int64 const ,class duckdb::shared_ptr<class duckdb::ArrowType,1> > > > const & __cdecl duckdb::ArrowTableType::GetColumns(void)const " (?GetColumns@ArrowTableType@duckdb@@QEBAAEBV?$unordered_map@_KV?$shared_ptr@VArrowType@duckdb@@$00@duckdb@@U?$hash@_K@std@@U?$equal_to@_K@4@V?$allocator@U?$pair@$$CB_KV?$shared_ptr@VArrowType@duckdb@@$00@duckdb@@@std@@@4@@std@@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ArrowSchemaWrapper::~ArrowSchemaWrapper(void)" (??1ArrowSchemaWrapper@duckdb@@QEAA@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: class duckdb::ArrowType const & __cdecl duckdb::ArrowStructInfo::GetChild(unsigned __int64)const " (?GetChild@ArrowStructInfo@duckdb@@QEBAAEBVArrowType@2@_K@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: enum duckdb::ArrowDateTimeType __cdecl duckdb::ArrowDateTimeInfo::GetDateTimeType(void)const " (?GetDateTimeType@ArrowDateTimeInfo@duckdb@@QEBA?AW4ArrowDateTimeType@2@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ConjunctionOrFilter::ConjunctionOrFilter(void)" (??0ConjunctionOrFilter@duckdb@@QEAA@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ConstantFilter::ConstantFilter(enum duckdb::ExpressionType,class duckdb::Value)" (??0ConstantFilter@duckdb@@QEAA@W4ExpressionType@1@VValue@1@@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: virtual void __cdecl duckdb::TableFilter::Serialize(class duckdb::Serializer &)const " (?Serialize@TableFilter@duckdb@@UEBAXAEAVSerializer@2@@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: virtual __cdecl duckdb::ArrowArrayStreamWrapper::~ArrowArrayStreamWrapper(void)" (??1ArrowArrayStreamWrapper@duckdb@@UEAA@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: virtual class duckdb::shared_ptr<class duckdb::ArrowArrayWrapper,1> __cdecl duckdb::ArrowArrayStreamWrapper::GetNextChunk(void)" (?GetNextChunk@ArrowArrayStreamWrapper@duckdb@@UEAA?AV?$shared_ptr@VArrowArrayWrapper@duckdb@@$00@2@XZ)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: static char const * __cdecl duckdb::EnumUtil::ToChars<enum duckdb::TableFilterType>(enum duckdb::TableFilterType)" (??$ToChars@W4TableFilterType@duckdb@@@EnumUtil@duckdb@@SAPEBDW4TableFilterType@1@@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: static char const * __cdecl duckdb::EnumUtil::ToChars<enum duckdb::ExpressionType>(enum duckdb::ExpressionType)" (??$ToChars@W4ExpressionType@duckdb@@@EnumUtil@duckdb@@SAPEBDW4ExpressionType@1@@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: static char const * __cdecl duckdb::EnumUtil::ToChars<enum duckdb::ArrowTypeInfoType>(enum duckdb::ArrowTypeInfoType)" (??$ToChars@W4ArrowTypeInfoType@duckdb@@@EnumUtil@duckdb@@SAPEBDW4ArrowTypeInfoType@1@@Z)
arrow_array_stream.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::ArrowTableFunction::PopulateArrowTableType(struct duckdb::DBConfig &,struct duckdb::ArrowTableType &,class duckdb::ArrowSchemaWrapper const &,class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1> &,class duckdb::vector<struct duckdb::LogicalType,1> &)" (?PopulateArrowTableType@ArrowTableFunction@duckdb@@SAXAEAUDBConfig@2@AEAUArrowTableType@2@AEBVArrowSchemaWrapper@2@AEAV?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@2@AEAV?$vector@ULogicalType@duckdb@@$00@2@@Z)
python_objects.obj : error LNK2001: unresolved external symbol "public: static struct duckdb::interval_t __cdecl duckdb::AddOperator::Operation<struct duckdb::interval_t,struct duckdb::interval_t,struct duckdb::interval_t>(struct duckdb::interval_t,struct duckdb::interval_t)" (??$Operation@Uinterval_t@duckdb@@U12@U12@@AddOperator@duckdb@@SA?AUinterval_t@1@U21@0@Z)
python_objects.obj : error LNK2001: unresolved external symbol "public: static __int64 const * const duckdb::NumericHelper::POWERS_OF_TEN" (?POWERS_OF_TEN@NumericHelper@duckdb@@2QB_JB)
python_objects.obj : error LNK2001: unresolved external symbol "public: static struct duckdb::timestamp_t __cdecl duckdb::Interval::Add(struct duckdb::timestamp_t,struct duckdb::interval_t)" (?Add@Interval@duckdb@@SA?AUtimestamp_t@2@U32@Uinterval_t@2@@Z)
python_objects.obj : error LNK2001: unresolved external symbol "public: static struct duckdb::interval_t __cdecl duckdb::Interval::Invert(struct duckdb::interval_t)" (?Invert@Interval@duckdb@@SA?AUinterval_t@2@U32@@Z)
python_objects.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::UUID::ToString(struct duckdb::hugeint_t,char *)" (?ToString@UUID@duckdb@@SAXUhugeint_t@2@PEAD@Z)
array_wrapper.obj : error LNK2001: unresolved external symbol "public: static __int64 __cdecl duckdb::Interval::GetNanoseconds(struct duckdb::interval_t const &)" (?GetNanoseconds@Interval@duckdb@@SA_JAEBUinterval_t@2@@Z)
scan.obj : error LNK2001: unresolved external symbol "unsigned __int64 const duckdb::COLUMN_IDENTIFIER_ROW_ID" (?COLUMN_IDENTIFIER_ROW_ID@duckdb@@3_KB)
scan.obj : error LNK2001: unresolved external symbol "public: unsigned __int64 __cdecl duckdb::DatabaseInstance::NumberOfThreads(void)" (?NumberOfThreads@DatabaseInstance@duckdb@@QEAA_KXZ)
scan.obj : error LNK2001: unresolved external symbol "public: static struct duckdb::ClientConfig & __cdecl duckdb::ClientConfig::GetConfig(class duckdb::ClientContext &)" (?GetConfig@ClientConfig@duckdb@@SAAEAU12@AEAVClientContext@2@@Z)
scan.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::QueryResult::DeduplicateColumns(class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1> &)" (?DeduplicateColumns@QueryResult@duckdb@@SAXAEAV?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@2@@Z)
path_like.obj : error LNK2001: unresolved external symbol "public: static class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::StringUtil::GenerateRandomName(unsigned __int64)" (?GenerateRandomName@StringUtil@duckdb@@SA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@_K@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: void __cdecl duckdb::Relation::AddExternalDependency(class duckdb::shared_ptr<class duckdb::ExternalDependency,1>)" (?AddExternalDependency@Relation@duckdb@@QEAAXV?$shared_ptr@VExternalDependency@duckdb@@$00@2@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::ExtensionHelper::LoadExternalExtension(class duckdb::ClientContext &,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (?LoadExternalExtension@ExtensionHelper@duckdb@@SAXAEAVClientContext@2@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: class duckdb::shared_ptr<class duckdb::DuckDB,1> __cdecl duckdb::DBInstanceCache::GetOrCreateInstance(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,struct duckdb::DBConfig &,bool,class std::function<void __cdecl(class duckdb::DuckDB &)> const &)" (?GetOrCreateInstance@DBInstanceCache@duckdb@@QEAA?AV?$shared_ptr@VDuckDB@duckdb@@$00@2@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AEAUDBConfig@2@_NAEBV?$function@$$A6AXAEAVDuckDB@duckdb@@@Z@5@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: static struct duckdb::QualifiedName __cdecl duckdb::QualifiedName::Parse(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (?Parse@QualifiedName@duckdb@@SA?AU12@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ViewRelation::ViewRelation(class duckdb::shared_ptr<class duckdb::ClientContext,1> const &,class duckdb::unique_ptr<class duckdb::TableRef,struct std::default_delete<class duckdb::TableRef>,1>,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (??0ViewRelation@duckdb@@QEAA@AEBV?$shared_ptr@VClientContext@duckdb@@$00@1@V?$unique_ptr@VTableRef@duckdb@@U?$default_delete@VTableRef@duckdb@@@std@@$00@1@AEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::StrpTimeFormat::StrpTimeFormat(void)" (??0StrpTimeFormat@duckdb@@QEAA@XZ)
pyconnection.obj : error LNK2001: unresolved external symbol "public: static class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::KeywordHelper::WriteOptionallyQuoted(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,char,bool)" (?WriteOptionallyQuoted@KeywordHelper@duckdb@@SA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AEBV34@D_N@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ReadJSONRelation::ReadJSONRelation(class duckdb::shared_ptr<class duckdb::ClientContext,1> const &,class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1> &,class std::unordered_map<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class duckdb::Value,struct duckdb::CaseInsensitiveStringHashFunction,struct duckdb::CaseInsensitiveStringEquality,class std::allocator<struct std::pair<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const ,class duckdb::Value> > >,bool,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0ReadJSONRelation@duckdb@@QEAA@AEBV?$shared_ptr@VClientContext@duckdb@@$00@1@AEAV?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@1@V?$unordered_map@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@VValue@duckdb@@UCaseInsensitiveStringHashFunction@4@UCaseInsensitiveStringEquality@4@V?$allocator@U?$pair@$$CBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@VValue@duckdb@@@std@@@2@@std@@_NV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@5@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: class duckdb::unique_ptr<class duckdb::ColumnDataCollection,struct std::default_delete<class duckdb::ColumnDataCollection>,1> __cdecl duckdb::MaterializedQueryResult::TakeCollection(void)" (?TakeCollection@MaterializedQueryResult@duckdb@@QEAA?AV?$unique_ptr@VColumnDataCollection@duckdb@@U?$default_delete@VColumnDataCollection@duckdb@@@std@@$00@2@XZ)
pyconnection.obj : error LNK2001: unresolved external symbol "public: virtual void __cdecl duckdb::LoadInfo::Serialize(class duckdb::Serializer &)const " (?Serialize@LoadInfo@duckdb@@UEBAXAEAVSerializer@2@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: static char const * __cdecl duckdb::EnumUtil::ToChars<enum duckdb::ParseInfoType>(enum duckdb::ParseInfoType)" (??$ToChars@W4ParseInfoType@duckdb@@@EnumUtil@duckdb@@SAPEBDW4ParseInfoType@1@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::LoadStatement::LoadStatement(void)" (??0LoadStatement@duckdb@@QEAA@XZ)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::MaterializedRelation::MaterializedRelation(class duckdb::shared_ptr<class duckdb::ClientContext,1> const &,class duckdb::unique_ptr<class duckdb::ColumnDataCollection,struct std::default_delete<class duckdb::ColumnDataCollection>,1> &&,class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1>,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0MaterializedRelation@duckdb@@QEAA@AEBV?$shared_ptr@VClientContext@duckdb@@$00@1@$$QEAV?$unique_ptr@VColumnDataCollection@duckdb@@U?$default_delete@VColumnDataCollection@duckdb@@@std@@$00@1@V?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@1@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: virtual void __cdecl duckdb::CreateInfo::Serialize(class duckdb::Serializer &)const " (?Serialize@CreateInfo@duckdb@@UEBAXAEAVSerializer@2@@Z)
pyconnection.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::DropInfo::DropInfo(void)" (??0DropInfo@duckdb@@QEAA@XZ)
pyconnection.obj : error LNK2001: unresolved external symbol "public: void __cdecl duckdb::PendingQueryResult::WaitForTask(void)" (?WaitForTask@PendingQueryResult@duckdb@@QEAAXXZ)
pyconnection.obj : error LNK2001: unresolved external symbol "public: virtual void __cdecl duckdb::ParseInfo::Serialize(class duckdb::Serializer &)const " (?Serialize@ParseInfo@duckdb@@UEBAXAEAVSerializer@2@@Z)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::CollateExpression::CollateExpression(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class duckdb::unique_ptr<class duckdb::ParsedExpression,struct std::default_delete<class duckdb::ParsedExpression>,1>)" (??0CollateExpression@duckdb@@QEAA@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@V?$unique_ptr@VParsedExpression@duckdb@@U?$default_delete@VParsedExpression@duckdb@@@std@@$00@1@@Z)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::StarExpression::StarExpression(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0StarExpression@duckdb@@QEAA@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::DefaultExpression::DefaultExpression(void)" (??0DefaultExpression@duckdb@@QEAA@XZ)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::QualifiedColumnName::QualifiedColumnName(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0QualifiedColumnName@duckdb@@QEAA@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::LambdaExpression::LambdaExpression(class duckdb::unique_ptr<class duckdb::ParsedExpression,struct std::default_delete<class duckdb::ParsedExpression>,1>,class duckdb::unique_ptr<class duckdb::ParsedExpression,struct std::default_delete<class duckdb::ParsedExpression>,1>)" (??0LambdaExpression@duckdb@@QEAA@V?$unique_ptr@VParsedExpression@duckdb@@U?$default_delete@VParsedExpression@duckdb@@@std@@$00@1@0@Z)
pyexpression.obj : error LNK2001: unresolved external symbol "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const & __cdecl duckdb::ColumnRefExpression::GetColumnName(void)const " (?GetColumnName@ColumnRefExpression@duckdb@@QEBAAEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
pyexpression.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ColumnRefExpression::ColumnRefExpression(class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1>)" (??0ColumnRefExpression@duckdb@@QEAA@V?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@1@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: struct duckdb::LogicalType __cdecl duckdb::ColumnDefinition::GetType(void)const " (?GetType@ColumnDefinition@duckdb@@QEBA?AULogicalType@2@XZ)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::ColumnDefinition::GetName(void)const " (?GetName@ColumnDefinition@duckdb@@QEBA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class duckdb::shared_ptr<class duckdb::Relation,1> __cdecl duckdb::Relation::Join(class duckdb::shared_ptr<class duckdb::Relation,1> const &,class duckdb::vector<class duckdb::unique_ptr<class duckdb::ParsedExpression,struct std::default_delete<class duckdb::ParsedExpression>,1>,1>,enum duckdb::JoinType,enum duckdb::JoinRefType)" (?Join@Relation@duckdb@@QEAA?AV?$shared_ptr@VRelation@duckdb@@$00@2@AEBV32@V?$vector@V?$unique_ptr@VParsedExpression@duckdb@@U?$default_delete@VParsedExpression@duckdb@@@std@@$00@duckdb@@$00@2@W4JoinType@2@W4JoinRefType@2@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class duckdb::Value __cdecl duckdb::ColumnDataRow::GetValue(unsigned __int64)const " (?GetValue@ColumnDataRow@duckdb@@QEBA?AVValue@2@_K@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class duckdb::shared_ptr<class duckdb::ClientContext,1> __cdecl duckdb::ClientContextWrapper::TryGetContext(void)" (?TryGetContext@ClientContextWrapper@duckdb@@QEAA?AV?$shared_ptr@VClientContext@duckdb@@$00@2@XZ)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class duckdb::shared_ptr<class duckdb::ClientContext,1> __cdecl duckdb::ClientContextWrapper::GetContext(void)" (?GetContext@ClientContextWrapper@duckdb@@QEAA?AV?$shared_ptr@VClientContext@duckdb@@$00@2@XZ)
pyrelation.obj : error LNK2001: unresolved external symbol "public: static class duckdb::unique_ptr<class duckdb::PhysicalResultCollector,struct std::default_delete<class duckdb::PhysicalResultCollector>,1> __cdecl duckdb::PhysicalArrowCollector::Create(class duckdb::ClientContext &,class duckdb::PreparedStatementData &,unsigned __int64)" (?Create@PhysicalArrowCollector@duckdb@@SA?AV?$unique_ptr@VPhysicalResultCollector@duckdb@@U?$default_delete@VPhysicalResultCollector@duckdb@@@std@@$00@2@AEAVClientContext@2@AEAVPreparedStatementData@2@_K@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::RelationTypeToString(enum duckdb::RelationType)" (?RelationTypeToString@duckdb@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@W4RelationType@1@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: void __cdecl duckdb::Parser::ParseQuery(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (?ParseQuery@Parser@duckdb@@QEAAXAEBV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::Parser::Parser(struct duckdb::ParserOptions)" (??0Parser@duckdb@@QEAA@UParserOptions@1@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ValueRelation::ValueRelation(class duckdb::shared_ptr<class duckdb::ClientContext,1> const &,class duckdb::vector<class duckdb::vector<class duckdb::Value,1>,1> const &,class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1>,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (??0ValueRelation@duckdb@@QEAA@AEBV?$shared_ptr@VClientContext@duckdb@@$00@1@AEBV?$vector@V?$vector@VValue@duckdb@@$00@duckdb@@$00@1@V?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@1@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: class duckdb::ColumnDataCollection & __cdecl duckdb::MaterializedQueryResult::Collection(void)" (?Collection@MaterializedQueryResult@duckdb@@QEAAAEAVColumnDataCollection@2@XZ)
pyrelation.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::QueryRelation::QueryRelation(class duckdb::shared_ptr<class duckdb::ClientContext,1> const &,class duckdb::unique_ptr<class duckdb::SelectStatement,struct std::default_delete<class duckdb::SelectStatement>,1>,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (??0QueryRelation@duckdb@@QEAA@AEBV?$shared_ptr@VClientContext@duckdb@@$00@1@V?$unique_ptr@VSelectStatement@duckdb@@U?$default_delete@VSelectStatement@duckdb@@@std@@$00@1@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AEBV45@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __cdecl duckdb::PragmaShow(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (?PragmaShow@duckdb@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@AEBV23@@Z)
pyrelation.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::BoxRenderer::BoxRenderer(struct duckdb::BoxRendererConfig)" (??0BoxRenderer@duckdb@@QEAA@UBoxRendererConfig@1@@Z)
pyresult.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ArrowArrayWrapper::~ArrowArrayWrapper(void)" (??1ArrowArrayWrapper@duckdb@@QEAA@XZ)
pyresult.obj : error LNK2001: unresolved external symbol "public: virtual __cdecl duckdb::QueryResultChunkScanState::~QueryResultChunkScanState(void)" (??1QueryResultChunkScanState@duckdb@@UEAA@XZ)
pyresult.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::QueryResultChunkScanState::QueryResultChunkScanState(class duckdb::QueryResult &)" (??0QueryResultChunkScanState@duckdb@@QEAA@AEAVQueryResult@1@@Z)
pyresult.obj : error LNK2001: unresolved external symbol "public: class duckdb::vector<class duckdb::unique_ptr<class duckdb::ArrowArrayWrapper,struct std::default_delete<class duckdb::ArrowArrayWrapper>,1>,1> __cdecl duckdb::ArrowQueryResult::ConsumeArrays(void)" (?ConsumeArrays@ArrowQueryResult@duckdb@@QEAA?AV?$vector@V?$unique_ptr@VArrowArrayWrapper@duckdb@@U?$default_delete@VArrowArrayWrapper@duckdb@@@std@@$00@duckdb@@$00@2@XZ)
pyresult.obj : error LNK2001: unresolved external symbol "public: static bool __cdecl duckdb::StreamQueryResult::IsChunkReady(enum duckdb::StreamExecutionResult)" (?IsChunkReady@StreamQueryResult@duckdb@@SA_NW4StreamExecutionResult@2@@Z)
pyresult.obj : error LNK2001: unresolved external symbol "public: static class std::unordered_map<unsigned __int64,class duckdb::shared_ptr<class duckdb::ArrowTypeExtensionData,1> const ,struct std::hash<unsigned __int64>,struct std::equal_to<unsigned __int64>,class std::allocator<struct std::pair<unsigned __int64 const ,class duckdb::shared_ptr<class duckdb::ArrowTypeExtensionData,1> const > > > __cdecl duckdb::ArrowTypeExtensionData::GetExtensionTypes(class duckdb::ClientContext &,class duckdb::vector<struct duckdb::LogicalType,1> const &)" (?GetExtensionTypes@ArrowTypeExtensionData@duckdb@@SA?AV?$unordered_map@_K$$CBV?$shared_ptr@VArrowTypeExtensionData@duckdb@@$00@duckdb@@U?$hash@_K@std@@U?$equal_to@_K@4@V?$allocator@U?$pair@$$CB_K$$CBV?$shared_ptr@VArrowTypeExtensionData@duckdb@@$00@duckdb@@@std@@@4@@std@@AEAVClientContext@2@AEBV?$vector@ULogicalType@duckdb@@$00@2@@Z)
pyresult.obj : error LNK2001: unresolved external symbol "public: static unsigned __int64 __cdecl duckdb::ArrowUtil::FetchChunk(class duckdb::ChunkScanState &,struct duckdb::ClientProperties,unsigned __int64,struct ArrowArray *,class std::unordered_map<unsigned __int64,class duckdb::shared_ptr<class duckdb::ArrowTypeExtensionData,1> const ,struct std::hash<unsigned __int64>,struct std::equal_to<unsigned __int64>,class std::allocator<struct std::pair<unsigned __int64 const ,class duckdb::shared_ptr<class duckdb::ArrowTypeExtensionData,1> const > > > const &)" (?FetchChunk@ArrowUtil@duckdb@@SA_KAEAVChunkScanState@2@UClientProperties@2@_KPEAUArrowArray@@AEBV?$unordered_map@_K$$CBV?$shared_ptr@VArrowTypeExtensionData@duckdb@@$00@duckdb@@U?$hash@_K@std@@U?$equal_to@_K@4@V?$allocator@U?$pair@$$CB_K$$CBV?$shared_ptr@VArrowTypeExtensionData@duckdb@@$00@duckdb@@@std@@@4@@std@@@Z)
pyresult.obj : error LNK2001: unresolved external symbol "public: __cdecl duckdb::ResultArrowArrayStreamWrapper::ResultArrowArrayStreamWrapper(class duckdb::unique_ptr<class duckdb::QueryResult,struct std::default_delete<class duckdb::QueryResult>,1>,unsigned __int64)" (??0ResultArrowArrayStreamWrapper@duckdb@@QEAA@V?$unique_ptr@VQueryResult@duckdb@@U?$default_delete@VQueryResult@duckdb@@@std@@$00@1@_K@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: virtual void __cdecl duckdb::TableRef::Serialize(class duckdb::Serializer &)const " (?Serialize@TableRef@duckdb@@UEBAXAEAVSerializer@2@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: virtual bool __cdecl duckdb::TableRef::Equals(class duckdb::TableRef const &)const " (?Equals@TableRef@duckdb@@UEBA_NAEBV12@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static char const * __cdecl duckdb::EnumUtil::ToChars<enum duckdb::VectorType>(enum duckdb::VectorType)" (??$ToChars@W4VectorType@duckdb@@@EnumUtil@duckdb@@SAPEBDW4VectorType@1@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::ArrowTableFunction::ArrowScanFunction(class duckdb::ClientContext &,struct duckdb::TableFunctionInput &,class duckdb::DataChunk &)" (?ArrowScanFunction@ArrowTableFunction@duckdb@@SAXAEAVClientContext@2@AEAUTableFunctionInput@2@AEAVDataChunk@2@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static class duckdb::unique_ptr<struct duckdb::LocalTableFunctionState,struct std::default_delete<struct duckdb::LocalTableFunctionState>,1> __cdecl duckdb::ArrowTableFunction::ArrowScanInitLocalInternal(class duckdb::ClientContext &,struct duckdb::TableFunctionInitInput &,struct duckdb::GlobalTableFunctionState *)" (?ArrowScanInitLocalInternal@ArrowTableFunction@duckdb@@SA?AV?$unique_ptr@ULocalTableFunctionState@duckdb@@U?$default_delete@ULocalTableFunctionState@duckdb@@@std@@$00@2@AEAVClientContext@2@AEAUTableFunctionInitInput@2@PEAUGlobalTableFunctionState@2@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static class duckdb::unique_ptr<struct duckdb::GlobalTableFunctionState,struct std::default_delete<struct duckdb::GlobalTableFunctionState>,1> __cdecl duckdb::ArrowTableFunction::ArrowScanInitGlobal(class duckdb::ClientContext &,struct duckdb::TableFunctionInitInput &)" (?ArrowScanInitGlobal@ArrowTableFunction@duckdb@@SA?AV?$unique_ptr@UGlobalTableFunctionState@duckdb@@U?$default_delete@UGlobalTableFunctionState@duckdb@@@std@@$00@2@AEAVClientContext@2@AEAUTableFunctionInitInput@2@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static class duckdb::unique_ptr<struct duckdb::FunctionData,struct std::default_delete<struct duckdb::FunctionData>,1> __cdecl duckdb::ArrowTableFunction::ArrowScanBind(class duckdb::ClientContext &,struct duckdb::TableFunctionBindInput &,class duckdb::vector<struct duckdb::LogicalType,1> &,class duckdb::vector<class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,1> &)" (?ArrowScanBind@ArrowTableFunction@duckdb@@SA?AV?$unique_ptr@UFunctionData@duckdb@@U?$default_delete@UFunctionData@duckdb@@@std@@$00@2@AEAVClientContext@2@AEAUTableFunctionBindInput@2@AEAV?$vector@ULogicalType@duckdb@@$00@2@AEAV?$vector@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@$00@2@@Z)
python_udf.obj : error LNK2001: unresolved external symbol "public: static void __cdecl duckdb::VectorOperations::Copy(class duckdb::Vector const &,class duckdb::Vector &,struct duckdb::SelectionVector const &,unsigned __int64,unsigned __int64,unsigned __int64,unsigned __int64)" (?Copy@VectorOperations@duckdb@@SAXAEBVVector@2@AEAV32@AEBUSelectionVector@2@_K333@Z)
build\lib.win-amd64-cpython-313\duckdb\duckdb.cp313-win_amd64.pyd : fatal error LNK1120: 82 unresolved externals
```

### To Reproduce

Use Cmake to build from source. Make sure to set BUILD_PYTHON to true.

### OS:

Windows 11

### DuckDB Version:

Main branch

### DuckDB Client:

python 3.13

### Hardware:

Laptop Meteor Lake - not a performance issue

### Full Name:

Charlie Savage

### Affiliation:

Orbital Insight

### What is the latest build you tested with? If possible, we recommend testing with the latest nightly build.

I have tested with a source build

### Did you include all relevant data sets for reproducing the issue?

Yes

### Did you include all code required to reproduce the issue?

- [x] Yes, I have

### Did you include all relevant configuration (e.g., CPU architecture, Python version, Linux distribution) to reproduce the issue?

- [x] Yes, I have