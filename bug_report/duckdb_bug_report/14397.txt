ID: 14397
Title: avoid unnecessary file list materialization when pruning readers
Description:
File list materialization can be expensive and should be done only when necessary