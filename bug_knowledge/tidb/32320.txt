{
    "sql": "create table messages (message_hash varbinary(32) not null primary key, src_workchain tinyint not null, src_address varbinary(32) null, dst_workchain tinyint not null, dst_address varbinary(32) null, message_type enum ('Internal', 'ExternalIn', 'ExternalOut') not null, message_value bigint unsigned not null, ihr_fee bigint unsigned not null, fwd_fee bigint unsigned not null, import_fee bigint unsigned not null, created_lt bigint unsigned not null, created_at int unsigned not null, body mediumblob null, state_init mediumblob null, bounced tinyint(1) not null, bounce tinyint(1) not null); insert into messages (message_hash, src_workchain, src_address, dst_workchain, dst_address, message_type, message_value, ihr_fee, fwd_fee, import_fee, created_lt, created_at, body, state_init, bounced, bounce) select ...; select created_at, concat(src_workchain, ':', lower(hex(src_address))) as src, concat(dst_workchain, ':', lower(hex(dst_address))) as dst, message_value from messages where created_at > 0 and message_value > 0;",
    "Affected Elements": "Memory limit exceeded error during query execution",
    "Root Cause Analysis": "The query attempts to process a large dataset and exceeds the allocated memory limit for TiFlash, leading to out-of-memory errors."
}