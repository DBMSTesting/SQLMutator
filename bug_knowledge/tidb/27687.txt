{
    "sql": "CREATE TABLE `outgoing_emails` (\n  `id` bigint(20) NOT NULL,\n  `token` varchar(32) COLLATE utf8mb4_bin NOT NULL,\n  `user_id` bigint(20) DEFAULT NULL,\n  `brand_id` bigint(20) DEFAULT NULL,\n  `retailer_id` bigint(22) DEFAULT NULL,\n  `template` varchar(255) COLLATE utf8mb4_general_ci NOT NULL,\n  `subject` varchar(255) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `send_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `sent_at` timestamp NULL DEFAULT NULL,\n  `bounced_at` timestamp NULL DEFAULT NULL,\n  `delivered_at` timestamp NULL DEFAULT NULL,\n  `first_opened_at` timestamp NULL DEFAULT NULL,\n  `last_opened_at` timestamp NULL DEFAULT NULL,\n  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  `open_count` bigint(20) NOT NULL DEFAULT '0',\n  `message_id` varchar(100) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `provider` varchar(50) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `promotional` tinyint(1) NOT NULL DEFAULT '0',\n  `idempotence_token` varchar(255) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  `provider_id` bigint(20) DEFAULT NULL,\n  `brand_customer_id` bigint(20) DEFAULT NULL,\n  `brand_lead_id` bigint(20) DEFAULT NULL,\n  `retailer_customer_id` bigint(20) DEFAULT NULL,\n  `non_user_email_address` varchar(255) COLLATE utf8mb4_general_ci DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `idx_token` (`token`),\n  UNIQUE KEY `unq_idempotence_token` (`idempotence_token`),\n  KEY `idx_updated_at` (`updated_at`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci; INSERT INTO outgoing_emails (id, token, user_id, brand_id, retailer_id, template, subject, send_at, sent_at, bounced_at, delivered_at, first_opened_at, last_opened_at, created_at, updated_at, open_count, message_id, provider, promotional, idempotence_token, provider_id, brand_customer_id, brand_lead_id, retailer_customer_id, non_user_email_address) VALUES (1, 'token1', NULL, NULL, NULL, 'template1', 'subject1', NOW(), NULL, NULL, NULL, NULL, NULL, NOW(), NOW(), 0, 'message1', 'provider1', 0, 'idempotence1', NULL, NULL, NULL, NULL, 'non_user1@example.com'); ALTER TABLE outgoing_emails ADD INDEX idx_updated_at (updated_at);",
    "Affected Elements": "ALTER TABLE, ADD INDEX",
    "Root Cause Analysis": "TiDB runs out of memory due to the high number of records and the complexity of the table schema when attempting to add an index."
}