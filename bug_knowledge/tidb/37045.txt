{
    "sql": "CREATE VIEW test_normalization.temp_view AS (WITH input_data AS (SELECT * FROM _airbyte_test_normalization.`nested_stream_with_co_1g_into_long_names_stg`), scd_data AS (SELECT md5(cast(concat(coalesce(cast(id AS CHAR(1000)), '')) AS CHAR(1000))) AS _airbyte_unique_key, id, `date`, `partition`, `date` AS _airbyte_start_at, lag(`date`) OVER (PARTITION BY id ORDER BY `date` IS NULL ASC, `date` DESC, _airbyte_emitted_at DESC) AS _airbyte_end_at, CASE WHEN row_number() OVER (PARTITION BY id ORDER BY `date` IS NULL ASC, `date` DESC, _airbyte_emitted_at DESC) = 1 THEN 1 ELSE 0 END AS _airbyte_active_row, _airbyte_ab_id, _airbyte_emitted_at, _airbyte_nested_strea__nto_long_names_hashid FROM input_data), dedup_data AS (SELECT row_number() OVER (PARTITION BY _airbyte_unique_key, _airbyte_start_at, _airbyte_emitted_at ORDER BY _airbyte_active_row DESC, _airbyte_ab_id) AS _airbyte_row_num, md5(cast(concat(coalesce(cast(_airbyte_unique_key AS CHAR(1000)), ''), '-', coalesce(cast(_airbyte_start_at AS CHAR(1000)), ''), '-', coalesce(cast(_airbyte_emitted_at AS CHAR(1000)), '')) AS CHAR(1000))) AS _airbyte_unique_key_scd, scd_data.* FROM scd_data) SELECT _airbyte_unique_key, _airbyte_unique_key_scd, id, `date`, `partition`, _airbyte_start_at, _airbyte_end_at, _airbyte_active_row, _airbyte_ab_id, _airbyte_emitted_at, current_timestamp() AS _airbyte_normalized_at, _airbyte_nested_strea__nto_long_names_hashid FROM dedup_data WHERE _airbyte_row_num = 1); SHOW COLUMNS FROM test_normalization.temp_view; DESC test_normalization.temp_view;",
    "Affected Elements": "SHOW COLUMNS, DESC",
    "Root Cause Analysis": "在 v6.x 中，使用窗口函数的视图在执行 SHOW COLUMNS 和 DESC 时出现语法错误，导致无法获取列信息。"
}