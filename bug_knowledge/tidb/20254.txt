{
    "sql": "CREATE TABLE marketing_summary (biz_id varchar(128) NOT NULL, store_id varchar(16000) NOT NULL, store_name varchar(16000) DEFAULT NULL, domain varchar(16000) DEFAULT NULL, buyer_nick varchar(16000) NOT NULL, trigger_timestamp timestamp NOT NULL, dispatch_timestamp timestamp NOT NULL, assistant_nick varchar(16000) NOT NULL, task_id int(11) NOT NULL, scenario varchar(16000) NOT NULL, template_id int(11) NOT NULL, channel varchar(16000) NOT NULL, mobile varchar(16000) DEFAULT NULL, msg_count int(11) DEFAULT NULL, created_trade_ids varchar(16000) DEFAULT NULL, paid_trade_ids varchar(16000) DEFAULT NULL, created_trade_count int(11) DEFAULT NULL, created_order_count int(11) DEFAULT NULL, created_amount_cent bigint(12) DEFAULT NULL, paid_trade_count int(11) DEFAULT NULL, paid_order_count int(11) DEFAULT NULL, paid_amount_cent bigint(12) DEFAULT NULL, replied_timestamp timestamp NULL DEFAULT NULL, is_arrived tinyint(1) NOT NULL, is_replied tinyint(1) NOT NULL, is_converted tinyint(1) NOT NULL, PRIMARY KEY (biz_id, dispatch_timestamp)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin PARTITION BY RANGE (UNIX_TIMESTAMP(dispatch_timestamp)) (PARTITION dt_0 VALUES LESS THAN (0), PARTITION dt_20200924 VALUES LESS THAN (1600963200), PARTITION dt_20200925 VALUES LESS THAN (1601049600), PARTITION dt_20200926 VALUES LESS THAN (1601136000)); SELECT count(distinct CASE WHEN is_arrived = 1 THEN buyer_nick ELSE NULL END) AS buyer_nick FROM marketing_summary WHERE (store_id = 'xxxx' AND dispatch_timestamp >= '2020-09-22 00:00:00' AND dispatch_timestamp <= '2020-09-25 23:59:59');",
    "Affected Elements": "CASE WHEN, count(distinct)",
    "Root Cause Analysis": "The error indicates that the column references within the CASE statement may not be correctly resolved due to issues in the partitioned table structure or column indexing."
}