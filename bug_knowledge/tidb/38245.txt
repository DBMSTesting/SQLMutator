{
    "sql": "CREATE TABLE `t1` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT ,\n  `cust_no` varchar(100) DEFAULT NULL ,\n  `id_type` varchar(2) DEFAULT NULL ,\n  `id_no` varchar(100) DEFAULT NULL ,\n  PRIMARY KEY (`id`),\n  KEY `t1_i2` (`cust_no`),\n  KEY `id_no` (`id_no`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin AUTO_INCREMENT=123456;\n\nCREATE TABLE `t2` (\n  `id` bigint(20) NOT NULL AUTO_INCREMENT ,\n  `cust_no` varchar(30) NOT NULL ,\n  `model_lvl` varchar(3) NOT NULL DEFAULT '0' ,\n  `rela_lvl` varchar(3) DEFAULT NULL ,\n  `test_lvl` varchar(3) DEFAULT NULL ,\n  `test_lvl_end_date` date DEFAULT NULL ,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `test_I0` (`cust_no`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin AUTO_INCREMENT=22473453;\n\nCREATE ALGORITHM = UNDEFINED SQL SECURITY DEFINER VIEW `vw_t2` (\n\t`cust_no`,\n\t`rela_lvl`,\n\t`test_lvl`,\n    `model_lvl`,\n\t`test_lvl_end_date`,\n\t`outer_lvl`\n) AS SELECT\n\t`l`.`cust_no` AS `cust_no`,\n\t`rela_lvl` AS `rela_lvl`,\n\t`test_lvl` AS `test_lvl`,\n    `model_lvl` AS `model_lvl`,\n\t`test_lvl_end_date` AS `test_lvl_end_date`,\n\tCASE\nWHEN (\n\t(`test_lvl` IS NOT NULL)\n\tAND (\n\t\t`test_lvl_end_date` IS NOT NULL\n\t)\n\tAND (\n\t\t`test_lvl_end_date` >= CURDATE()\n\t)\n) THEN\n\t`test_lvl`\nELSE\n\tGREATEST(\n\t\t`model_lvl`,\n\t\tIFNULL(`rela_lvl`, '0')\n\t)\nEND AS `outer_lvl`\nFROM\n\t`t2` AS `l`;\n\nEXPLAIN SELECT\n  t1.id,\n  t1.cust_no,\n  t1.id_no,\n  t1.id_type,\n  t2.outer_lvl AS cust_level\nFROM\n  t1\n  LEFT JOIN vw_t2 t2 ON t1.cust_no = t2.cust_no\nWHERE\n  t1.id_no = '123';",
    "Affected Elements": "LEFT JOIN, VIEW, INDEX",
    "Root Cause Analysis": "TiDB does not utilize indexes for queries involving views, leading to full table scans instead of index lookups."
}