{
    "sql": "CREATE TABLE `w` ( `did` int(11) NOT NULL, `day` date NOT NULL, `hour` smallint(6) NOT NULL, `cid` bigint(20) NOT NULL, `pv` int(11) NOT NULL, `uv` int(11) NOT NULL, PRIMARY KEY (`did`,`day`,`hour`,`cid`)); CREATE TABLE `n` ( `id` int(11) NOT NULL, `name` varchar(256) DEFAULT NULL, PRIMARY KEY (`id`)); insert into w values( 13145 , '2017-11-29' , 0 , 798975615876285 ,  3 ,  3 ); insert into w values( 13145 , '2017-11-29' , 0 , 798975615876317 , 40 , 26 ); insert into w values( 13145 , '2017-11-29' , 0 , 798851061825665 ,  2 ,  2 ); insert into w values( 13145 , '2017-11-29' , 0 , 798975615878295 ,  3 ,  3 ); insert into w values( 13145 , '2017-11-29' , 0 , 798975615878552 ,  4 ,  4 ); insert into w values( 13145 , '2017-11-29' , 0 , 798975615874824 ,  2 ,  2 ); insert into w values( 13145 , '2017-11-29' , 0 , 798657788297451 ,  5 ,  5 ); insert into w values( 13145 , '2017-11-29' , 0 , 798851061822941 ,  5 ,  3 ); insert into w values( 13145 , '2017-11-29' , 0 , 798657788297428 ,  7 ,  7 ); insert into w values( 13145 , '2017-11-29' , 0 , 798975615876441 ,  3 ,  2 ); insert into n values (13145, '客户1'); insert into n values (23345, '客户2'); select sum(pv) as pv from w join n on n.id=w.did where day = '2017-11-29' and did in (13145) group by did order by pv desc; select did, day, sum(pv) as pv, sum(uv) as uv from w join n on n.id=w.did where day = '2017-11-29' and id in (13145) group by did order by pv desc;",
    "Affected Elements": "in operator, group by clause, order by clause",
    "Root Cause Analysis": "The use of 'in' for the 'did' field in conjunction with aggregation functions may cause unexpected behavior or errors in the TiDB engine due to type mismatch or incorrect handling of NULL values."
}