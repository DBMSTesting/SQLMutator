{
    "sql": "DROP TABLE IF EXISTS t1; CREATE TABLE t1 (col_time_6_not_null_key TIME(6) NOT NULL, col_time_5_key TIME(5) DEFAULT NULL, col_timestamp TIMESTAMP DEFAULT NULL, col_time_key TIME DEFAULT NULL, col_datetime_key DATETIME DEFAULT NULL, col_time_not_null TIME NOT NULL, pk TIMESTAMP(4) NOT NULL PRIMARY KEY); SET sql_mode=''; INSERT INTO t1 VALUES ('03:07:29.013169',NULL,'0000-00-00 00:00:00','18:29:54','2000-06-10 19:41:30','13:56:51','2011-09-07 23:08:20.8362'),('00:20:06.000000','08:25:11.04580','2009-06-16 04:33:32','00:20:04','2004-08-23 21:05:10','00:20:06','2011-09-07 23:08:22.8362'),('00:20:03.000000','00:20:07.00000','2007-05-28 13:16:25','00:26:33','0000-00-00 00:00:00','01:04:48','2011-09-07 23:08:24.8362'),('19:48:23.009935','00:20:07.00000','2009-04-09 13:29:15','00:20:01',NULL,'21:43:24','2011-09-07 23:08:26.8362'),('00:20:01.000000','22:27:30.00296','2009-03-21 23:00:46',NULL,'2003-01-23 14:57:31','00:20:09','2011-09-07 23:08:28.8362'),('23:09:37.056340','07:01:38.05720','2006-01-25 15:25:59','00:20:05',NULL,'05:10:32','2011-09-07 23:08:19.8362'),('09:44:10.025082','00:20:07.00000','2009-01-06 18:48:29','00:20:02','0000-00-00 00:00:00','00:20:00','2011-09-07 23:08:21.8362'),('23:02:50.013380','22:48:12.05831',NULL,NULL,'2003-11-18 04:32:18','00:20:06','2011-09-07 23:08:23.8362'),('00:20:01.000000','16:19:55.00007','0000-00-00 00:00:00','07:55:21','0000-00-00 00:00:00','14:48:29','2011-09-07 23:08:25.8362'),('06:00:36.034953','00:20:01.00000','2007-03-15 21:00:00','00:20:01',NULL,'23:29:59','2011-09-07 23:08:27.8362'); SET sql_mode=DEFAULT; SELECT pk, EXTRACT(YEAR_MONTH FROM '0000-00-00 00:00:00') as expr1, COALESCE (col_time_6_not_null_key, col_datetime_key) as expr2 FROM t1 WHERE col_time_not_null NOT BETWEEN EXTRACT(YEAR_MONTH FROM '0000-00-00 00:00:00') AND COALESCE (col_time_6_not_null_key, col_datetime_key); SHOW WARNINGS; SELECT pk, col_time_not_null, col_time_6_not_null_key, col_datetime_key FROM t1 WHERE col_time_not_null NOT BETWEEN NULL AND COALESCE (col_time_6_not_null_key, col_datetime_key); DROP TABLE t1;",
    "Affected Elements": "EXTRACT, NOT BETWEEN, COALESCE",
    "Root Cause Analysis": "The use of '0000-00-00 00:00:00' as a datetime value leads to incorrect results and warnings due to invalid datetime representation."
}