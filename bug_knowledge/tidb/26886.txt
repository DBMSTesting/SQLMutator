{
    "sql": "set tidb_hashagg_final_concurrency = 1; set tidb_hashagg_partial_concurrency = 1; drop table if exists sales; CREATE TABLE sales(id INT AUTO_INCREMENT PRIMARY KEY, `date` DATE, sale INT); INSERT INTO sales(`date`, sale) VALUES ('2017-03-01', 200), ('2017-04-01', 300), ('2017-05-01', 400), ('2017-06-01', 200), ('2017-07-01', 600), ('2017-08-01', 100), ('2017-03-01', 400), ('2017-04-01', 300), ('2017-05-01', 500), ('2017-06-01', 400), ('2017-07-01', 600), ('2017-08-01', 150); set sql_mode=''; SELECT MONTH(date), SUM(sale), AVG(SUM(sale)) OVER w AS sliding_avg FROM sales GROUP BY MONTH(date) WINDOW w AS (ORDER BY MONTH(date) RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) ORDER BY AVG(SUM(sale)) OVER (ORDER BY MONTH(date) RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING), MONTH(date);",
    "Affected Elements": "AVG, SUM, WINDOW, GROUP BY, ORDER BY",
    "Root Cause Analysis": "在使用非并行哈希聚合时，窗口函数的精度不一致，导致结果与预期不符。"
}