{
    "sql": "SELECT * FROM (SELECT *, RANK() OVER (PARTITION BY topsql.time_window ORDER BY topsql.cpu_time_sum DESC) AS rk FROM (SELECT instance_id, sql_digest, FLOOR(timestamp / 60) AS time_window, SUM(cpu_time_ms) AS cpu_time_sum FROM cpu_time WHERE timestamp < 3600 AND instance_id = 3 GROUP BY time_window, sql_digest) topsql) sql_ranked WHERE sql_ranked.rk <= 10; SELECT * FROM (SELECT *, RANK() OVER (PARTITION BY topsql.time_window ORDER BY topsql.cpu_time_sum DESC) AS rk FROM (SELECT instance_id, sql_digest, FLOOR(timestamp / 60) AS time_window, SUM(cpu_time_ms) AS cpu_time_sum FROM cpu_time WHERE timestamp < 3600 AND instance_id = 0 GROUP BY time_window, sql_digest) topsql) sql_ranked WHERE sql_ranked.rk <= 10;",
    "Affected Elements": "RANK(), PARTITION BY, ORDER BY, GROUP BY",
    "Root Cause Analysis": "The execution plans differ due to the instance_id parameter affecting the underlying data distribution and thus leading to variance in the execution strategy."
}