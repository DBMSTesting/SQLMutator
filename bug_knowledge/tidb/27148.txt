{
    "sql": "CREATE TABLE `cxo_competition_compare_stat_weekly` ( `week_flag` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `week_date_flag` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `week_start_date` date DEFAULT NULL, `is_company` int(11) DEFAULT NULL, `is_product` int(11) DEFAULT NULL, `brand` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `city_code` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `city_name` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `city_level` int(11) DEFAULT NULL, `level_desc` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `province_code` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `province_name` varchar(20) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `region_code` varchar(128) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `region_name` varchar(128) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `stat_type` varchar(128) COLLATE utf8mb4_0900_ai_ci DEFAULT NULL, `week_insur_cnt` bigint(20) DEFAULT NULL, `baidu_index` bigint(20) DEFAULT NULL, `store_cnt` bigint(20) DEFAULT NULL, `cumu_store_cnt` bigint(20) DEFAULT NULL, `energy_cnt` bigint(20) DEFAULT NULL, `cumu_energy_cnt` bigint(20) DEFAULT NULL, `max_date` date DEFAULT NULL, KEY `week_flag` (`week_flag`), KEY `brand` (`brand`) ); ALTER TABLE cxo_competition_compare_stat_weekly SET TIFLASH REPLICA 1; INSERT INTO cxo_competition_compare_stat_weekly VALUES (11, 11, '2020-01-01', 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, '2020-01-01'); SET sql_mode=''; SELECT week_date_flag AS date_code, SUM(SUM(store_cnt)) OVER (PARTITION BY CASE WHEN 'level' = 'region' THEN IF('all' = 'all', region_name, city_name) WHEN 'level' = 'level' THEN IF('all' = 'all', level_desc, city_name) END, IF(brand IN ('理想', '理想one'), '理想', brand) ORDER BY week_date_flag) AS store_cnt FROM cxo_competition_compare_stat_weekly GROUP BY week_date_flag;",
    "Affected Elements": "SUM, OVER, PARTITION BY, CASE, IF",
    "Root Cause Analysis": "The error indicates a mismatch in expected and actual data types during MPP query execution, likely due to inconsistencies in the schema of blocks being exchanged."
}