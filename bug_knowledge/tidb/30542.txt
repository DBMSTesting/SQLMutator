{
    "sql": "CREATE TABLE t (id bigint(20) NOT NULL AUTO_INCREMENT, a varchar(20) DEFAULT NULL, b varchar(50) DEFAULT NULL, c varchar(50) DEFAULT NULL, d varchar(50) DEFAULT NULL, e varchar(200) DEFAULT NULL, f varchar(200) DEFAULT NULL, g varchar(100) DEFAULT NULL, h varchar(50) DEFAULT NULL, PRIMARY KEY (id), KEY idx_b (b)) ENGINE=InnoDB AUTO_INCREMENT=51670272 DEFAULT CHARSET=utf8; ALTER TABLE t SET TIFLASH REPLICA 1; INSERT INTO t (a, b, c, g) VALUES ('1', '9ead706a6ee03bd6c548480abc351b8d', '-100000000', 'xxxyy'), ('2', '9ead706a6ee03bd6c548480abc351b8d', '-200000000', 'zzz'); SELECT b, SUM(CASE WHEN g LIKE 'xxx%yy%' OR g LIKE 'zzz%' THEN CAST(REPLACE(c, ',', '') AS DECIMAL) ELSE 0 END) AS equity FROM t GROUP BY b; SELECT /*+ READ_FROM_STORAGE(TIKV[t]) */ b, SUM(CASE WHEN g LIKE 'xxx%yy%' OR g LIKE 'zzz%' THEN CAST(REPLACE(c, ',', '') AS DECIMAL) ELSE 0 END) AS equity FROM t GROUP BY b;",
    "Affected Elements": "SELECT, SUM, CASE, GROUP BY, TIFLASH, READ_FROM_STORAGE",
    "Root Cause Analysis": "The discrepancy in results between TiFlash and TiKV likely stems from differences in how they handle the data types or the aggregation logic when processing the SQL statement."
}