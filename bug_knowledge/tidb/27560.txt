{
    "sql": "DROP USER IF EXISTS 'joe', 'engineering', 'notgranted', 'otherrole', 'delete_stuff_privilege'; CREATE USER 'joe'; CREATE ROLE 'engineering'; CREATE ROLE 'admins'; CREATE ROLE 'notgranted'; CREATE ROLE 'otherrole'; GRANT INSERT ON test.* TO 'engineering'; GRANT DELETE ON test.* TO 'admins'; GRANT SELECT ON test.* TO 'joe'; GRANT 'engineering' TO 'joe'; GRANT 'admins' TO 'joe'; SET DEFAULT ROLE 'admins' TO 'joe'; GRANT 'otherrole' TO 'joe'; GRANT UPDATE ON role.* TO 'otherrole'; GRANT SELECT ON mysql.user TO 'otherrole'; CREATE ROLE 'delete_stuff_privilege'; GRANT DELETE ON mysql.user TO 'delete_stuff_privilege'; GRANT 'delete_stuff_privilege' TO 'otherrole'; SHOW GRANTS FOR CURRENT_USER() USING 'notgranted'; SHOW GRANTS FOR CURRENT_USER() USING 'otherrole'; SHOW GRANTS FOR 'joe' USING 'otherrole';",
    "Affected Elements": "SHOW GRANTS FOR CURRENT_USER() USING; CURRENT_USER() function; USING clause",
    "Root Cause Analysis": "The bug arises from the improper handling of CURRENT_USER() with the USING clause, leading to incorrect privilege retrieval."
}