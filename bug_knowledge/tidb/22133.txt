{
    "sql": "CREATE TABLE progress_td (date TIMESTAMP NULL, brand_id BIGINT NULL, brand_name TINYTEXT NULL, stock_group_id BIGINT NULL, stock_group_name MEDIUMTEXT NULL, progress_ytd DECIMAL(6, 4) NULL); INSERT INTO progress_td (date, brand_id, brand_name, stock_group_id, stock_group_name, progress_ytd) VALUES ('2020-12-30 00:00:00', 1, '品牌1', 1, '股份集团1', 0.6000), ('2020-12-30 00:00:00', 2, '品牌2', 1, '股份集团1', 0.5000), ('2020-12-30 00:00:00', 6, '品牌6', 3, '股份集团3', 0.0200), ('2020-12-30 00:00:00', 5, '品牌5', 3, '股份集团3', 0.0250), ('2020-12-30 00:00:00', 4, '品牌4', 2, '股份集团2', 0.0333), ('2020-12-30 00:00:00', 3, '品牌3', 2, '股份集团2', 0.1000), ('2020-12-30 00:00:00', 7, '品牌7', 3, '股份集团3', 0.0167); SELECT brand_id, brand_name, @rank_in_sg := IF(@curSG = t.stock_group_id, @rank_in_sg + 1, 1) AS progress_ytd_rank_in_sg, @curSG := stock_group_id AS stock_group_id FROM progress_td t, (SELECT @rank_in_sg := 0) x, (SELECT @curSG := '') y ORDER BY t.stock_group_id, t.progress_ytd DESC;",
    "Affected Elements": "IF statement, User-defined variables (@rank_in_sg, @curSG), ORDER BY clause",
    "Root Cause Analysis": "The incorrect ranking in the grouped results is caused by improper initialization or handling of user-defined variables during the select execution."
}