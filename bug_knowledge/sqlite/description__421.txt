{
    "sql": "CREATE TABLE t1(a INT); CREATE TABLE t2(x TEXT); INSERT INTO t1 VALUES(1); INSERT INTO t1 VALUES('abc'); INSERT INTO t2 VALUES(2); CREATE TABLE t3 AS SELECT * FROM t1 UNION SELECT * FROM t2; SELECT * FROM t3 WHERE typeof(a)='text' AND CAST(CAST(a AS int) AS text)=a; CREATE TABLE t1(a INT); CREATE TABLE t2(x TEXT); INSERT INTO t1 VALUES(1); INSERT INTO t1 VALUES('abc'); INSERT INTO t2 VALUES(2); CREATE TABLE t3 AS SELECT * FROM t1 UNION SELECT * FROM t2; SELECT 'without-index', a FROM t3 WHERE a>9; CREATE INDEX t3a ON t3(a); SELECT 'with-index', a FROM t3 WHERE a>9; CREATE TABLE t1(a TEXT); CREATE TABLE t2 AS SELECT * FROM t1 UNION ALL SELECT 123; SELECT a, typeof(a) FROM t2;",
    "Affected Elements": "CREATE TABLE, INSERT INTO, UNION, SELECT, CREATE INDEX, typeof",
    "Root Cause Analysis": "The issue arises from improper type handling in the SQL engine, causing integer values to be incorrectly inserted into TEXT columns and leading to inconsistent results when querying, especially when indexes are involved."
}