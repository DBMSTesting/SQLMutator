{
    "sql": "CREATE TABLE AAA (aaa_id INTEGER PRIMARY KEY AUTOINCREMENT); CREATE TABLE RRR (rrr_id INTEGER PRIMARY KEY AUTOINCREMENT, rrr_date INTEGER NOT NULL, rrr_aaa INTEGER); CREATE TABLE TTT (ttt_id INTEGER PRIMARY KEY AUTOINCREMENT, target_aaa INTEGER NOT NULL, source_aaa INTEGER NOT NULL); INSERT INTO AAA (aaa_id) VALUES (2); INSERT INTO TTT (ttt_id, target_aaa, source_aaa) VALUES (4469, 2, 2); INSERT INTO TTT (ttt_id, target_aaa, source_aaa) VALUES (4476, 2, 1); INSERT INTO RRR (rrr_id, rrr_date, rrr_aaa) VALUES (0, 0, NULL); INSERT INTO RRR (rrr_id, rrr_date, rrr_aaa) VALUES (2, 4312, 2); SELECT i.aaa_id, (SELECT SUM(CASE WHEN (t.source_aaa = i.aaa_id) THEN 1 ELSE 0 END) FROM TTT t) AS segfault FROM (SELECT curr.rrr_aaa AS aaa_id FROM RRR curr INNER JOIN AAA a ON (curr.rrr_aaa = a.aaa_id) LEFT JOIN RRR r ON (r.rrr_id <> 0 AND r.rrr_date < curr.rrr_date) GROUP BY curr.rrr_id HAVING r.rrr_date IS NULL) i;",
    "Affected Elements": "SELECT, SUM, INNER JOIN, LEFT JOIN, GROUP BY, HAVING",
    "Root Cause Analysis": "The query planner encounters a segmentation fault due to improper handling of joins and aggregate functions in the context of the specific SQL engine version."
}