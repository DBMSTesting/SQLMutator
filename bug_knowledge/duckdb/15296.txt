{
    "sql": "create table items (id bigint, val text); insert into items values (1, 'a'), (2, 'b'), (3, 'c'); create macro lookup_val(_id) as (select _items.val from items as _items where _items.id = _id limit 1); select lookup_val(id) as lv from items where lookup_val(id) = 'b'; select lookup_val(id) as lv from items where lv = 'b'; select lookup_val(item_id) as lv from (values (1), (2), (3)) item_ids(item_id) where lookup_val(item_id) = 'b'; select lookup_val(id) as lv from items where lookup_val(items.id) = 'b';",
    "Affected Elements": "Macro expressions, WHERE clause, SELECT list",
    "Root Cause Analysis": "The expression `id` in the SELECT list is referencing the main query's `items` table, while in the WHERE clause it references the macro's `_items` table, leading to inconsistent results."
}