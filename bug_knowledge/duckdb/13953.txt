{
    "sql": "create or replace table patients as select id, date '2000-01-01' + (random()*3000)::integer as enroll_date from range(10000) patients(id); create or replace table claims as select (random() * 1000000)::integer as id, date '2000-01-01' + (random()*3000)::integer as claim_date from range(1000000); explain analyze select patients.id, count(*) from patients left join claims on patients.id = claims.id and datediff('month',enroll_date,claim_date) between 1 and 12 group by patients.id; explain analyze with cte as(select claims.id from patients join claims on patients.id = claims.id and datediff('month',enroll_date,claim_date) between 1 and 12) select patients.id, count(*) from patients left join cte on patients.id = cte.id group by patients.id;",
    "Affected Elements": "LEFT JOIN, CTE, DATEDIFF, COUNT",
    "Root Cause Analysis": "Dynamic filter pushdowns are not being applied optimally in the LEFT JOIN operation, leading to significant performance degradation compared to pre-filtering with a CTE."
}