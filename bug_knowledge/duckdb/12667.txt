{
    "sql": "create or replace table tmp_full_org_path as select a.biz_action_type_code, a.operating_unit_sk, a.stockorg_sk as send_stockorg_sk, b.stockorg_sk as receive_stockorg_sk, 1 as send_level, case when a.scene_type in ('调拨') or (a.scene_type = '补调' and a.org_flag = 1) then 'gto.store_path_rule' when a.scene_type in ('补货', '返仓') or (a.scene_type = '补调' and a.org_flag = 2) then 'gto.warehouse_store_path_rule' end as parameter_code from tmp_skc_org_basic a inner join tmp_skc_org_basic b on a.operating_unit_sk = b.operating_unit_sk and a.biz_action_type_code = b.biz_action_type_code and a.skc_sk = b.skc_sk where (case when a.scene_type in ('调拨', '返仓') then a.org_flag = 1 when a.scene_type in ('补货') then a.org_flag = 2 when a.scene_type in ('补调') then a.org_flag in (1, 2) end) and (case when a.scene_type in ('补货', '调拨', '补调') then b.org_flag = 1 when a.scene_type in ('返仓') then b.org_flag = 2 end) and a.stockorg_sk <> b.stockorg_sk group by a.biz_action_type_code, a.operating_unit_sk, a.stockorg_sk, b.stockorg_sk, a.scene_type, a.org_flag;",
    "Affected Elements": "Out of Memory Error, Self-Join, Group By Clause",
    "Root Cause Analysis": "The query attempts to process a large dataset with complex joins and conditional logic, leading to excessive memory consumption during execution."
}