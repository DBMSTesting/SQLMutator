{
    "sql": "DROP TABLE IF EXISTS bos; CREATE TABLE bos AS ( SELECT 'North' AS Destination, 'Plant' AS Origin UNION SELECT 'Central', 'Plant' UNION SELECT 'Central', 'PlantB' UNION SELECT 'Plant', 'PlantB'); DROP TABLE IF EXISTS LocationLevel; CREATE TABLE LocationLevel AS WITH RECURSIVE cte(location, level) AS ( SELECT bos.destination AS location, 1 AS level FROM bos WHERE NOT EXISTS ( SELECT 1 FROM bos b2 WHERE bos.destination = b2.origin) UNION ALL SELECT bos.origin, 1 + level FROM cte INNER JOIN bos ON cte.location = bos.Destination WHERE COALESCE(cte.location, '') <> '' ) SELECT location, MAX(level) AS level FROM cte GROUP BY location;",
    "Affected Elements": "WITH RECURSIVE, COALESCE, MAX, UNION ALL",
    "Root Cause Analysis": "The bug is related to how DuckDB handles intermediate field names in recursive Common Table Expressions (CTEs), leading to unexpected behavior when certain field names are reused."
}