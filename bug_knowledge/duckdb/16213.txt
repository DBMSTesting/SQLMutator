{
    "sql": "create or replace table records as from 'records.parquet'; create or replace table labels as from 'labels.parquet'; with day_cat_rows as (select category, creation_day from records group by category, creation_day), recs as (select category, records.creation_dt, labels.label_dt, labels.label from records left join labels on labels.id = records.id), counts as (select day_cat_rows.creation_day, category, (select count(1) from recs where recs.creation_dt > day_cat_rows.creation_day - interval '30 days' and recs.creation_dt <= day_cat_rows.creation_day and recs.category = day_cat_rows.category and recs.label_dt <= day_cat_rows.creation_day and recs.label = 1) as num_labeled_30d from day_cat_rows) select * from counts;",
    "Affected Elements": "WITH clause, LEFT JOIN, subquery for counting, INTERVAL keyword",
    "Root Cause Analysis": "The query likely encounters performance issues due to inefficient execution plans introduced in the v1.1.0 update, causing it to run indefinitely and fill up temporary disk space."
}