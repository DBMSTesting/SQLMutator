{
    "sql": "COPY ( WITH metadata_source AS (SELECT * FROM '/foo/bar/metadata.json'), bitswap_cids AS (SELECT * FROM read_csv('/dev/stdin')), annotated_source_cids AS (SELECT l.cid_id, l.source_cid, (r.source_cid IS NOT NULL) AS bitswap_source FROM (SELECT cid_id, unnest(sources).source_cid as source_cid FROM metadata_source) l LEFT OUTER JOIN bitswap_cids r ON l.source_cid = r.normalized_cid), bitswap_annotated_cids AS (SELECT cid_id, BOOL_OR(bitswap_source) AS bitswap_source FROM annotated_source_cids GROUP BY cid_id) SELECT m.*, a.bitswap_source AS seen_via_bitswap FROM metadata_source m INNER JOIN bitswap_annotated_cids a ON m.cid_id = a.cid_id ) TO '/tmp/tmp.JD4hUZzW62/metadata_annotated.json';",
    "Affected Elements": "WITH clause, LEFT OUTER JOIN, COPY statement",
    "Root Cause Analysis": "The error arises when reading from stdin where the schema is not correctly inferred, leading to a misleading binder error about a non-existent reference."
}