{
    "sql": "ATTACH '' AS psql (TYPE postgres, READ_ONLY); CREATE OR REPLACE SECRET my_secret (TYPE S3, KEY_ID '...', SECRET '...', SCOPE 's3://bucket-name', ENDPOINT 'my-minio.fully.qualified.name', URL_STYLE 'path'); WITH sales AS ( SELECT * FROM parquet_scan('s3://bucket-name/key/**/*.parquet', hive_partitioning=true) ), products AS ( SELECT id, type FROM psql.reference.products ), c_d_map AS ( SELECT * FROM (VALUES ('A', 1), ('B', 1), ('C', -1), ('D', -1)) AS t(c_d, value) ) SELECT s.client_id, date_trunc('day', s.ts) AS day, SUM(s.qty) AS qty_sum, SUM(s.g_a) AS g_a_sum, SUM(s.i_v) AS i_v_sum, SUM(s.v_v) AS v_v_sum, SUM(s.n_v) AS n_v_sum, SUM(s.s) AS s_sum, SUM(s.rebate) AS rebate_sum, SUM(COALESCE(m.value, 0)) AS cred_deb_vsum, COUNT(DISTINCT s.card) AS count_distinct_card, SUM(s.v_e_r) AS v_e_r_sum, SUM(s.c) AS c_sum, SUM(s.c_r) AS c_r_sum FROM sales s LEFT JOIN products p ON (s.product_id = p.id) JOIN c_d_map m ON (s.c_d = m.c_d) WHERE s.year = 2022 AND p.type = 'simple' GROUP BY ALL ORDER BY 1, 2;",
    "Affected Elements": "JOIN, LEFT JOIN, CTE, GROUP BY, ORDER BY",
    "Root Cause Analysis": "The performance regression is likely due to changes in the query execution strategy or CTE materialization mechanisms introduced in DuckDB 1.1.0, which affected the efficiency of JOIN operations."
}