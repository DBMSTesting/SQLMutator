{
    "sql": "CREATE DATABASE IF NOT EXISTS mysql_8_bug DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; DROP TABLE IF EXISTS a, b; CREATE TABLE a (id BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY); CREATE TABLE b (id BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY, int_a_id BIGINT(20) UNSIGNED DEFAULT NULL, CONSTRAINT fk_a_id FOREIGN KEY (int_a_id) REFERENCES a (id)); SET @@session.FOREIGN_KEY_CHECKS = 0; TRUNCATE TABLE a; SET @@session.FOREIGN_KEY_CHECKS = 1; SET @@session.FOREIGN_KEY_CHECKS = 0; TRUNCATE TABLE b; SET @@session.FOREIGN_KEY_CHECKS = 1; INSERT INTO a (id) VALUES (1); INSERT INTO b (int_a_id) VALUES (1);",
    "Affected Elements": "TRUNCATE TABLE, FOREIGN_KEY_CHECKS, INSERT INTO",
    "Root Cause Analysis": "The bug arises from concurrent TRUNCATE operations combined with foreign key constraints, leading to inconsistent states where MySQL incorrectly enforces foreign key constraints despite valid references."
}