{
    "sql": "CREATE TABLE t1(pkey int not null auto_increment, j json, primary key (pkey)) engine=innodb row_format=dynamic; INSERT INTO t1(j) values (JSON_ARRAY(REPEAT('MySQL', 40), REPEAT('BlobPartialUpdate', 512))); SET transaction_isolation = 'REPEATABLE-READ'; START TRANSACTION; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; SELECT @var_0 := json_extract(j, '$[0]') FROM t1; START TRANSACTION; UPDATE t1 SET j = json_set(j, '$[0]', REPEAT('InnoDB', 10)) WHERE pkey = 1; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; COMMIT; START TRANSACTION; UPDATE t1 SET j = json_set(j, '$[0]', REPEAT('PolarDB', 20)) WHERE pkey = 1; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; COMMIT; START TRANSACTION; UPDATE t1 SET j = json_set(j, '$[0]', REPEAT('abcde', 14)) WHERE pkey = 1; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; COMMIT; START TRANSACTION; UPDATE t1 SET j = json_set(j, '$[0]', REPEAT('fungo', 40)) WHERE pkey = 1; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; COMMIT; START TRANSACTION; UPDATE t1 SET j = json_set(j, '$[0]', REPEAT('abcde', 18)) WHERE pkey = 1; SELECT json_extract(j, '$[0]') FROM t1 WHERE pkey = 1; COMMIT; SELECT @var_0; SELECT @var_1; DROP TABLE t1;",
    "Affected Elements": "SELECT, UPDATE, JSON functions, transactions",
    "Root Cause Analysis": "The bug is caused by the small partial update feature, where the wrong undo record is applied to the blob due to incorrect version handling."
}