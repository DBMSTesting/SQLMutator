{
    "sql": "CREATE TABLE int8_tbl(q1 INT8, q2 INT8); INSERT INTO int8_tbl VALUES(123, 456), (123, 456789456789), (456789056789, 123), (456789056789, 45678903456789), (45678956789, -456789016789), (39082035958095, NULL), (-1204982102907, NULL), (-123, NULL); ANALYZE TABLE int8_tbl; SELECT * FROM int8_tbl t1 LEFT JOIN (SELECT q1 AS x, 42 AS y FROM int8_tbl t2) ss ON t1.q2 = ss.x WHERE 1 = (SELECT 1 FROM int8_tbl t3 WHERE ss.y IS NOT NULL LIMIT 1) ORDER BY 1, 2; SET optimizer_switch='derived_merge=off'; SELECT * FROM int8_tbl t1 LEFT JOIN (SELECT q1 AS x, 42 AS y FROM int8_tbl t2) ss ON t1.q2 = ss.x WHERE 1 = (SELECT 1 FROM int8_tbl t3 WHERE ss.y IS NOT NULL LIMIT 1) ORDER BY 1, 2; SET optimizer_switch='derived_merge=on'; SELECT /*+no_merge(ss)*/ * FROM int8_tbl t1 LEFT JOIN (SELECT q1 AS x, 42 AS y FROM int8_tbl t2) ss ON t1.q2 = ss.x WHERE 1 = (SELECT 1 FROM int8_tbl t3 WHERE ss.y IS NOT NULL LIMIT 1) ORDER BY 1, 2; DROP TABLE int8_tbl;",
    "Affected Elements": "LEFT JOIN, WHERE clause, optimizer_switch, derived_merge",
    "Root Cause Analysis": "The optimizer's handling of derived tables with LEFT JOIN causes incorrect results when the derived table has NULL values, particularly when derived_merge is enabled."
}