{
    "sql": "truncate performance_schema.memory_summary_global_by_event_name; select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= '1993-11-01' and o_orderdate < date_add('1993-11-01', interval '3' month) and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20; SELECT * FROM performance_schema.memory_summary_global_by_event_name where event_name like 'memory/temptable%'; set global temptable_max_ram = 1000*1024*1024; truncate performance_schema.memory_summary_global_by_event_name; select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= '1993-11-01' and o_orderdate < date_add('1993-11-01', interval '3' month) and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20; SELECT * FROM performance_schema.memory_summary_global_by_event_name where event_name like 'memory/temptable%'; set internal_tmp_mem_storage_engine = MEMORY; set max_heap_table_size = 352*1024*1024; set tmp_table_size = @@max_heap_table_size; select @@max_heap_table_size, @@tmp_table_size; flush status; select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= '1993-11-01' and o_orderdate < date_add('1993-11-01', interval '3' month) and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20; show status WHERE Variable_name like 'Created_tmp%';",
    "Affected Elements": "SELECT statement, GROUP BY clause, ORDER BY clause, variable settings (temptable_max_ram, internal_tmp_mem_storage_engine, max_heap_table_size, tmp_table_size)",
    "Root Cause Analysis": "The TempTable engine is inefficient in memory allocation as compared to the MEMORY engine, leading to excessive memory usage."
}