{
    "sql": "DROP TABLE IF EXISTS t1, t2; CREATE TABLE t1(id INT AUTO_INCREMENT PRIMARY KEY, c1 VARCHAR(255) COLLATE utf8_general_ci, KEY(c1)) CHARSET=utf8 ENGINE=InnoDB; CREATE TABLE t2(id INT AUTO_INCREMENT PRIMARY KEY, t1_id INT, c1 VARCHAR(255) COLLATE utf8_bin) CHARSET=utf8 ENGINE=InnoDB; TRUNCATE TABLE t1; INSERT INTO t1(c1) VALUES(RPAD(RAND()*100000, 255, '0')); INSERT INTO t1(c1) VALUES(RPAD(RAND()*100000, 255, '0')); REPLACE INTO t1(c1) SELECT RPAD(RAND()*100000, 255, '0') FROM t1 t1, t1 t2, t1 t3, t1 t4, t1 t5, t1 t6, t1 t7, t1 t8, t1 t9, t1 t10, t1 t11, t1 t12, t1 t13, t1 t14, t1 t15, t1 t16, t1 t17, t1 t18, t1 t19; TRUNCATE TABLE t2; INSERT INTO t2(c1) SELECT c1 FROM t1; SELECT (SELECT COUNT(*) FROM t1 WHERE t1.c1 = t2.c1 COLLATE utf8_general_ci) cnt FROM t2 LIMIT 10; UPDATE t2 SET c1 = NULL; SELECT (SELECT COUNT(*) FROM t1 WHERE t1.c1 = t2.c1 COLLATE utf8_general_ci) cnt FROM t2 LIMIT 10; UPDATE t1 SET c1 = NULL; SELECT (SELECT COUNT(*) FROM t1 WHERE t1.c1 = t2.c1 COLLATE utf8_general_ci) cnt FROM t2 LIMIT 10; ALTER TABLE t2 CONVERT TO CHARACTER SET utf8; SELECT (SELECT COUNT(*) FROM t1 WHERE t1.c1 = t2.c1) cnt FROM t2 LIMIT 10;",
    "Affected Elements": "JOIN, COLLATE, SELECT, UPDATE",
    "Root Cause Analysis": "The performance degradation occurs when NULL values are present in the joined columns and a collation is applied, resulting in inefficient index scans."
}