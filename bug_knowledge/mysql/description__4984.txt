{
    "sql": "drop procedure if exists p1; drop table if exists t1; create table t1(a int) engine=innodb; delimiter $ create procedure p1(p_n int) begin repeat start transaction; insert into t1 values(1); delete from t1 where a=1; commit; set p_n:=p_n-1; until p_n <=1 end repeat; end $ delimiter ; set global innodb_purge_run_now=1; do sleep(10); select name,subsystem,count from information_schema.innodb_metrics where name='trx_rseg_history_len'; call p1(1000); set global innodb_purge_run_now=1; do sleep(10); select name,subsystem,count from information_schema.innodb_metrics where name='trx_rseg_history_len';",
    "Affected Elements": "drop procedure, drop table, create table, create procedure, repeat, start transaction, insert, delete, commit, set global, do sleep, select",
    "Root Cause Analysis": "The undo log which is cached on the undo list is not truncated, preventing the history list from reaching zero."
}