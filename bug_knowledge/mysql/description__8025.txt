{
    "sql": "create database if not exists test; use test; create table nums (pid int, ppid int); insert into nums values (1,0),(2,0),(3,1),(4,1),(5,2),(6,2),(7,5),(8,5),(9,6),(10,6); drop procedure if exists p1; delimiter // create procedure p1() begin declare pid, ppid, total int; declare done int default 0; declare cur cursor for (with recursive cte as (select * from nums where pid = 1 union all select nums.* from nums join cte on nums.ppid = cte.pid) select * from cte); declare continue handler for not found set done = 1; open cur; set total = 0; while done != 1 do fetch cur into pid,ppid; if done != 1 then select pid, ppid; set total = total + 1; end if; end while; close cur; select concat(total, \" records found!\"); end // delimiter ; call p1();",
    "Affected Elements": "cursor definition, with clause, recursive CTE",
    "Root Cause Analysis": "The use of a recursive CTE in the cursor definition leads to an empty result set when fetching data, indicating a limitation or bug in how cursors handle with_clause in MySQL 8.0.20."
}