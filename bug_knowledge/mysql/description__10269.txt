{
    "sql": "CREATE TABLE `t1` ( `uid` int NOT NULL, `col1` json DEFAULT NULL, `col2` varchar(10) GENERATED ALWAYS AS (json_unquote(json_extract(`col1`, _utf8mb4'$.id'))) VIRTUAL, PRIMARY KEY (`uid`), KEY `index_col2` (`col2`)); insert into t1 (uid, col1) values (1, '{\"id\":\"1\", \"name\":\"Alice\"}'); insert into t1 (uid, col1) values (2, '{\"id\":\"1\", \"name\":\"Alice\"}'); select json_extract(col1, '$.id'), count(json_extract(col1, '$.name')) from t1 where uid in (select uid from t1) group by 1; alter table t1 drop index index_col2; select json_extract(col1, '$.id'), count(json_extract(col1, '$.name')) from t1 where uid in (select uid from t1) group by 1;",
    "Affected Elements": "CREATE TABLE, INSERT INTO, SELECT, ALTER TABLE, GROUP BY",
    "Root Cause Analysis": "The optimizer's substitute_generated_columns step incorrectly handles the virtual column and leads to a duplicate key error when the index on the virtual column is present."
}