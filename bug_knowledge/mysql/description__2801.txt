{
    "sql": "create function kierowcy.odsetki(od date, do date, baza decimal(10, 0) unsigned) returns int unsigned deterministic reads sql data; begin declare kwota int unsigned default 0; select round(sum(if(round((datediff(if(wazny_do>do,do,wazny_do), if(datediff(od, wazny_od)<0, wazny_od, od))+1)*baza*wartosc_float/36500,0)>0, round((datediff(if(wazny_do>do,do,wazny_do), if(datediff(od, wazny_od)<0, wazny_od, od))+1)*baza*wartosc_float/36500,0), 0)), 0) into kwota from kierowcy.konfiguracja where klucz = 'odsetki'; return kwota; end;",
    "Affected Elements": "datediff, round, if, sum, create function",
    "Root Cause Analysis": "The stored function returns an out-of-range value due to negative results from the datediff function, which causes overflow when using an unsigned integer type."
}