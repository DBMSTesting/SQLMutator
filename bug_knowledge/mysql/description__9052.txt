{
    "sql": "CREATE TABLE `t1` (`cl` text COLLATE utf8_bin, `fa` varchar(250) COLLATE utf8_bin DEFAULT NULL, `ti` text COLLATE utf8_bin, `id` varchar(250) COLLATE utf8_bin NOT NULL, PRIMARY KEY (`id`), UNIQUE KEY `key1` (`fa`), KEY `IDX_1` (`ti`(250)) ENGINE=InnoDB; CREATE TABLE `t2` (`ID` varchar(250) COLLATE utf8_bin NOT NULL, `ide` varchar(128) COLLATE utf8_bin NOT NULL, `ctime` bigint(20) DEFAULT '0', PRIMARY KEY (`ide`), KEY `Index1` (`ctime`)) ENGINE=InnoDB; CREATE TABLE `t3` (`ID` varchar(250) COLLATE utf8_bin NOT NULL, `ide` varchar(128) COLLATE utf8_bin NOT NULL, PRIMARY KEY (`ide`)) ENGINE=InnoDB; CREATE TABLE `t4` (`ts` text COLLATE utf8_bin, `orderid` varchar(100) COLLATE utf8_bin DEFAULT NULL, UNIQUE KEY `key_1` (`orderid`)) ENGINE=InnoDB; SET GLOBAL log_bin_trust_function_creators=1; DELIMITER // CREATE FUNCTION getByteLength(inputText text) RETURNS INT BEGIN RETURN(length(inputText)); END// DELIMITER ; LOAD DATA INFILE '../t1_data.sql' INTO TABLE t1; LOAD DATA INFILE '../t2_data.sql' INTO TABLE t2; LOAD DATA INFILE '../t3_data.sql' INTO TABLE t3; LOAD DATA INFILE '../t4_data.sql' INTO TABLE t4; EXPLAIN SELECT count(1) AS count FROM ( SELECT substring(fa, getByteLength('11') + 2) AS ide, ti FROM t1 WHERE cl = 1 ) AS TEMP WHERE TEMP.ide IN ( SELECT /*+ SEMIJOIN(materialization) */ ap.Ide FROM t2 AS ap JOIN t3 AS ex ON ap.Ide = ex.Ide WHERE ap.ctime > 0 ) AND TEMP.ti IN ( SELECT orderid FROM t4 WHERE ts IN ('running', 'completed', 'cancel') );",
    "Affected Elements": "EXPLAIN, SELECT, JOIN, WHERE, IN, FUNCTION, COUNT",
    "Root Cause Analysis": "The assertion failure occurs due to a possible issue with how the optimizer handles key parts in the join condition, leading to an unexpected state where keyparts is less than or equal to zero."
}