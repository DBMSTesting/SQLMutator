{
    "sql": "SET GLOBAL innodb_stats_persistent=OFF; SET GLOBAL innodb_stats_transient_sample_pages=100; SET GLOBAL innodb_stats_persistent_sample_pages=100; SHOW VARIABLES LIKE 'innodb%stats%'; CREATE TABLE ten(a INT); INSERT INTO ten VALUES (0),(1),(2),(3),(4),(5),(6),(7),(8),(9); CREATE TABLE one_k(a INT); INSERT INTO one_k SELECT A.a + B.a * 10 + C.a * 100 FROM ten A, ten B, ten C; CREATE TABLE t1 (pk INT PRIMARY KEY, a INT, KEY(a)) ENGINE=InnoDB; INSERT INTO t1 SELECT A.a + 1000 * B.a, NULL FROM one_k A, one_k B WHERE B.a < 400; INSERT INTO t1 SELECT A.a + 1000 * B.a, A.a + 1000 * B.a FROM one_k A, one_k B WHERE B.a BETWEEN 400 AND 500; ANALYZE TABLE t1; SET GLOBAL innodb_stats_method=nulls_unequal; ANALYZE TABLE t1; DROP TABLE t1; SET GLOBAL innodb_stats_persistent=ON; SET GLOBAL innodb_stats_method=nulls_equal; CREATE TABLE t1 (pk INT PRIMARY KEY, a INT, KEY(a)) ENGINE=InnoDB; INSERT INTO t1 SELECT A.a + 1000 * B.a, NULL FROM one_k A, one_k B WHERE B.a < 400; INSERT INTO t1 SELECT A.a + 1000 * B.a, A.a + 1000 * B.a FROM one_k A, one_k B WHERE B.a BETWEEN 400 AND 500; ANALYZE TABLE t1; SET GLOBAL innodb_stats_method=nulls_unequal; ANALYZE TABLE t1;",
    "Affected Elements": "SET GLOBAL innodb_stats_method; ANALYZE TABLE; Cardinality calculations;",
    "Root Cause Analysis": "The innodb_stats_method setting is not being applied correctly when innodb_stats_persistent is ON, leading to unexpected cardinality values."
}