{
    "sql": "DROP TABLE IF EXISTS `test1`; DROP TABLE IF EXISTS `test2`; CREATE TABLE `test1` ( `id` int(10) unsigned NOT NULL auto_increment, `foo` text, `test2` varchar(255) default NULL, PRIMARY KEY  (`id`) ) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=utf8; CREATE TABLE `test2` ( `id` int(10) unsigned NOT NULL auto_increment, `name` varchar(255) default NULL, PRIMARY KEY  (`id`) ) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=utf8; CREATE FUNCTION `testfunc`(the_name VARCHAR(255)) RETURNS int(10) unsigned DETERMINISTIC BEGIN DECLARE the_id INT unsigned; SELECT `id` INTO the_id FROM test2 WHERE `name` = the_name; RETURN the_id; END; INSERT INTO test1 (foo, test2) VALUES ('Val1', 'bla'), ('Val2', 'blubb'), ('Val3', 'bla'), ('Val4', 'klong'); INSERT INTO test2 (name) VALUES ('bla'), ('blubb'), ('baz'), ('klong'); SELECT * FROM test1 LEFT JOIN test2 ON test2.id=testfunc(test1.test2);",
    "Affected Elements": "LEFT JOIN, ON clause, function call in SQL",
    "Root Cause Analysis": "The bug arises from the incorrect evaluation of the stored function in the ON clause during a JOIN operation, leading to repeated values from the last evaluated row instead of the current row."
}