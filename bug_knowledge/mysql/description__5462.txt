{
    "sql": "CREATE PROCEDURE sys.password_expiration_warning(IN expire_in_days INT) SELECT user, host, password_lifetime, password_last_changed, IF(password_lifetime = 0, NULL, IF(@@GLOBAL.default_password_lifetime <> 0, password_last_changed + INTERVAL IF(password_lifetime IS NULL, @@GLOBAL.default_password_lifetime, password_lifetime) DAY, IF(password_lifetime IS NULL, NULL, password_last_changed + INTERVAL password_lifetime DAY))) expiration_date FROM mysql.user WHERE password_lifetime <> 0 AND password_last_changed IS NOT NULL AND ((@@GLOBAL.default_password_lifetime <> 0 AND password_lifetime IS NULL) OR (password_lifetime IS NOT NULL AND password_last_changed < NOW() + INTERVAL expire_in_days DAY - INTERVAL password_lifetime DAY AND password_last_changed >= NOW() - INTERVAL password_lifetime DAY) OR (password_lifetime IS NULL AND password_last_changed < NOW() + INTERVAL expire_in_days DAY - INTERVAL @@GLOBAL.default_password_lifetime DAY AND password_last_changed >= NOW() - INTERVAL @@GLOBAL.default_password_lifetime DAY)); CALL sys.password_expiration_warning(6);",
    "Affected Elements": "CREATE PROCEDURE, SELECT, IF, INTERVAL, WHERE",
    "Root Cause Analysis": "The SYS schema lacks a view for user accounts that are expired or about to expire, which is a feature enhancement request rather than a bug."
}