{
    "sql": "CREATE TABLE test (namespace_id CHAR(64) NOT NULL, run_id CHAR(64) NOT NULL, start_time DATETIME(6) NOT NULL, close_time DATETIME(6) NULL, execution_time DATETIME(6) NOT NULL, workflow_id VARCHAR(255) NOT NULL, workflow_type_name VARCHAR(255) NOT NULL, status INT NOT NULL, data JSON NULL, key1 VARCHAR(255) GENERATED ALWAYS AS (data->>'$.key1'), key2 VARCHAR(255) GENERATED ALWAYS AS (data->>'$.key2'), PRIMARY KEY (namespace_id, run_id)); CREATE INDEX default_idx ON test (namespace_id, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_execution_time ON test (namespace_id, execution_time, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_workflow_id ON test (namespace_id, workflow_id, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_workflow_type_name ON test (namespace_id, workflow_type_name, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_status ON test (namespace_id, status, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_key1 ON test (namespace_id, key1, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CREATE INDEX by_key2 ON test (namespace_id, key2, (COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME))) DESC, start_time DESC, run_id); CALL InsertRand(1000000); EXPLAIN ANALYZE SELECT * FROM test WHERE namespace_id='ns-1' AND key1='kw-1' ORDER BY COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME)) DESC, start_time DESC, run_id; EXPLAIN ANALYZE SELECT * FROM test USE INDEX (by_key1) WHERE namespace_id='ns-1' AND key1='kw-1' ORDER BY COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME)) DESC, start_time DESC, run_id; EXPLAIN ANALYZE SELECT * FROM test WHERE namespace_id='ns-1' AND key1 IS NULL ORDER BY COALESCE(close_time, CAST('9999-12-31 23:59:59' AS DATETIME)) DESC, start_time DESC, run_id;",
    "Affected Elements": "EXPLAIN, ORDER BY, USE INDEX, COALESCE, JSON functions",
    "Root Cause Analysis": "The optimizer is not selecting the correct index or not using it optimally due to the complexity introduced by functional indexes and JSON fields."
}