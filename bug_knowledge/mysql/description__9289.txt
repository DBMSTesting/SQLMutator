{
    "sql": "CREATE DEFINER=`root`@`localhost` PROCEDURE `test_rr_sp`(IN in_account_main_id int, IN in_object_base_c smallint, IN in_SQL text, OUT out_result bool, OUT out_result_details json) READS SQL DATA BEGIN IF (@@read_only = FALSE) THEN INSERT INTO system_log_error (date_created, error_source_c, error_type_c, error_action_c, error_details) VALUES (NOW(), 1, 1, 1, JSON_OBJECT('test','test')); END IF; SET out_result = TRUE; SET out_result_details = JSON_OBJECT('message','yay!'); END; CREATE DEFINER=`root`@`localhost` FUNCTION `test_rr_func`() RETURNS int DETERMINISTIC BEGIN RETURN 1; END; CALL test_rr_sp(1,test_rr_func(),'yay',@out1,@out2);",
    "Affected Elements": "CALL, INSERT, FUNCTION",
    "Root Cause Analysis": "The system incorrectly assumes that calling a function as a parameter could potentially modify the database state, triggering the read-only error."
}