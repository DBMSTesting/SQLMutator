{
    "sql": "CREATE DATABASE IF NOT EXISTS testbug; USE testbug; DROP TABLE IF EXISTS A; CREATE TABLE A (id INT(10) UNSIGNED NOT NULL, name VARCHAR(255) NOT NULL, PRIMARY KEY (id)) ENGINE=InnoDB; DROP TABLE IF EXISTS B; CREATE TABLE B (id INT(10) UNSIGNED NOT NULL, a_id INT(10) UNSIGNED NOT NULL, parent_id INT(10) UNSIGNED NULL DEFAULT NULL, name VARCHAR(255) NOT NULL, PRIMARY KEY (id), CONSTRAINT b_a_fk FOREIGN KEY (a_id) REFERENCES A (id) ON DELETE CASCADE, CONSTRAINT b_b_fk FOREIGN KEY (parent_id) REFERENCES B (id) ON DELETE SET NULL) ENGINE=InnoDB; INSERT INTO A (id, name) VALUES (1, 'test_a'); INSERT INTO B (id, a_id, name) VALUES (1, 1, 'test_b_root'); INSERT INTO B (id, a_id, parent_id, name) VALUES (2, 1, 1, 'test_b_root'); DELETE FROM A WHERE id = 1; CHECK TABLE B;",
    "Affected Elements": "ON DELETE CASCADE, ON DELETE SET NULL, foreign key constraints",
    "Root Cause Analysis": "MySQL 5.7 cannot properly handle the combination of ON DELETE CASCADE and self-referential ON DELETE SET NULL, leading to corrupted indexes and orphaned rows."
}