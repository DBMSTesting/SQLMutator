{
    "sql": "CREATE TABLE target (id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT 'Primary key\\n ', unqkey VARCHAR(100) NOT NULL, rvalue VARCHAR(100) NOT NULL, created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP, UNIQUE(unqkey)) ENGINE=InnoDB DEFAULT CHARSET=utf8; CREATE TABLE source (id INT NOT NULL AUTO_INCREMENT PRIMARY KEY, unqkey VARCHAR(100) NOT NULL, rvalue VARCHAR(100) NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8; INSERT INTO source (unqkey, rvalue) SELECT 'UNKNOWN', SUBSTRING(MD5(RAND()) FROM 1 FOR 10); INSERT INTO target (unqkey, rvalue) SELECT unqkey, rvalue FROM source temp ON DUPLICATE KEY UPDATE unqkey = temp.unqkey, rvalue = temp.rvalue, created = NOW();",
    "Affected Elements": "INSERT INTO...SELECT... ON DUPLICATE KEY UPDATE",
    "Root Cause Analysis": "The query hangs due to performance degradation when processing a large number of duplicate keys in the source table, causing excessive locking or resource contention in the InnoDB engine."
}