{
    "sql": "DROP TABLE IF EXISTS `p9629`.`gtowey_test`; CREATE TABLE  `p9629`.`gtowey_test` ( `id` varchar(12) NOT NULL, `Birthdate_Year` int(4) default NULL, `Birthdate_Day` int(2) default NULL, `Birthdate_Month` int(2) default NULL, PRIMARY KEY  (`id`) ) ENGINE=MyISAM DEFAULT CHARSET=latin1; INSERT INTO gtowey_test VALUES ('12345678', 1960, 1, 1), ('87654321', 1985, 31, 12), ('00000000', 0, 0, 0); CREATE OR REPLACE ALGORITHM=MERGE VIEW gtowey_test_dob AS SELECT id, str_to_date(CONCAT_WS('-', Birthdate_Year, Birthdate_Month, Birthdate_Day), '%Y-%m-%d') as DOB FROM   `gtowey_test` WHERE id IS NOT NULL AND Birthdate_Year IS NOT NULL AND Birthdate_Month IS NOT NULL AND Birthdate_Day IS NOT NULL AND Birthdate_Year <> 0 AND Birthdate_Month <> 0 AND Birthdate_Day <> 0; SELECT id, Birthdate_Year, DOB FROM gtowey_test LEFT JOIN gtowey_test_dob USING (id);",
    "Affected Elements": "LEFT JOIN, MERGE VIEW, str_to_date, CONCAT_WS",
    "Root Cause Analysis": "The MERGE algorithm in MySQL is incorrectly returning '0000-00-00' instead of NULL for non-matching rows in the LEFT JOIN."
}