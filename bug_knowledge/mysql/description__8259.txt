{
    "sql": "delimiter ^; create database if not exists bug; drop procedure if exists bug.proc1; drop procedure if exists bug.proc2; drop function if exists bug.test; create procedure bug.proc1() begin declare exit handler for sqlexception begin select 'in exception handler'; end; call bug.proc2(); end; ^ create procedure bug.proc2() begin select bug.test(); end; ^ create function bug.test() returns text begin SIGNAL SQLSTATE '45000'; return 'returned from bug.test function'; end; ^ call bug.proc1(); ^",
    "Affected Elements": "SELECT statement in exception handler, SIGNAL statement in function",
    "Root Cause Analysis": "The malformed packet error occurs due to the interaction between the SELECT statement in the exception handler and the raised exception in the called function, leading to an unstable connection."
}