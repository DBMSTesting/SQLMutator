{
    "sql": "DROP TABLE IF EXISTS kafka_writer; DROP TABLE IF EXISTS kafka; DROP TABLE IF EXISTS view; CREATE TABLE kafka_writer (key String, value String) ENGINE = Kafka SETTINGS kafka_broker_list = 'localhost:19092', kafka_topic_list = 'tmp_test', kafka_group_name = 'group', kafka_format = 'ProtobufSingle', kafka_schema = 'string_key_value.proto:StringKeyValuePair', kafka_max_rows_per_message = 1; CREATE TABLE kafka (key String, value String) ENGINE = Kafka SETTINGS kafka_broker_list = 'localhost:19092', kafka_topic_list = 'tmp_test', kafka_group_name = 'reader', kafka_format = 'ProtobufSingle', kafka_schema = 'string_key_value.proto:StringKeyValuePair'; CREATE MATERIALIZED VIEW view ENGINE = MergeTree() ORDER BY key AS SELECT key, value FROM kafka; INSERT INTO kafka_writer VALUES ('a', 'b');",
    "Affected Elements": "ProtobufSingle, kafka_max_rows_per_message, allow_multiple_rows_without_delimiter",
    "Root Cause Analysis": "The 'ProtobufSingle' format does not enforce the restriction of a single message per write, leading to unexpected behavior when multiple rows are inserted."
}