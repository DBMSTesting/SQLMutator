{
    "sql": "CREATE database IF NOT EXISTS test ON cluster cluster_single_shard; CREATE TABLE test.user_local ON cluster cluster_single_shard (id Int64, name String, age Int32) ENGINE = MergeTree ORDER BY name SETTINGS index_granularity = 8192; CREATE TABLE test.user_all ON cluster cluster_single_shard AS test.user_local ENGINE = Distributed('cluster_single_shard', 'test', 'user_local', rand()); CREATE TABLE test.event ON cluster cluster_single_shard (id Int64, user_id Int64, content String, created_time DateTime) ENGINE = MergeTree ORDER BY user_id SETTINGS index_granularity = 8192; INSERT INTO test.user_local (id, name, age) VALUES (1, 'aaa', 21); INSERT INTO test.event (id, user_id, content, created_time) VALUES(1, 1, 'hello', '2022-01-05 12:00:00'); SELECT u.name user_name, 20 AS age_group FROM test.user_all u LEFT JOIN test.event e ON u.id = e.user_id WHERE (u.age >= 20 AND u.age < 30) AND e.created_time > '2022-01-01';",
    "Affected Elements": "SELECT clause with non-constant column; LEFT JOIN; WHERE clause with conditions on joined tables",
    "Root Cause Analysis": "The query attempts to select a constant value (age_group) from a distributed table while also applying conditions that require that the value be constant in the result, leading to a conversion error."
}