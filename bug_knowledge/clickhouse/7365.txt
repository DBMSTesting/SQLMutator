{
    "sql": "CREATE TABLE rdlog (act String, campaignId Int32, date String MATERIALIZED formatDateTime(toDateTime(timestamp / 1000), '%y%m%d%H'), eventTime DateTime MATERIALIZED toDateTime(timestamp / 1000)) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/rdlog', '{replica}') PARTITION BY toYYYYMMDD(eventTime) ORDER BY (eventTime, traceId) SAMPLE BY traceId SETTINGS index_granularity = 8192; CREATE TABLE rdlog_all (act String, campaignId Int32, date String MATERIALIZED formatDateTime(toDateTime(timestamp / 1000), '%y%m%d%H'), eventTime DateTime MATERIALIZED toDateTime(timestamp / 1000)) ENGINE = Distributed(rd2_cluster, 'default', 'rdlog', rand());",
    "Affected Elements": "MATERIALIZED columns, CREATE TABLE syntax, formatDateTime function",
    "Root Cause Analysis": "The issue arises from a possible incompatibility or bug in the handling of materialized columns in the version 19.15.3.6 of the database engine, which prevents the proper recognition of the materialized 'date' column during data ingestion."
}