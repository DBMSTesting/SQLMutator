{
    "sql": "CREATE TABLE from_table (id UInt32, gid UInt32, version UInt32, value UInt32) ENGINE = Kafka('localhost:9092', 'from_table', 'groupId', 'JSONEachRow'); CREATE TABLE to_table (id UInt32, gid UInt32, value AggregateFunction(argMax, UInt32, UInt32)) ENGINE = AggregatingMergeTree PARTITION BY tuple() ORDER BY id; CREATE MATERIALIZED VIEW to_table_mv TO to_table AS SELECT id, any(gid) as gid, argMaxState(value, version) as value FROM from_table GROUP BY id; CREATE TABLE sum_table (gid UInt32, value AggregateFunction(sum, UInt32)) ENGINE = AggregatingMergeTree PARTITION BY tuple() ORDER BY gid; CREATE MATERIALIZED VIEW sum_table_mv TO sum_table AS SELECT gid, sumState(value) as value FROM (SELECT gid, argMaxMerge(value) as value FROM to_table GROUP BY gid) GROUP BY gid;",
    "Affected Elements": "CREATE MATERIALIZED VIEW, subquery in SELECT statement",
    "Root Cause Analysis": "The error occurs due to the interaction between the use of a subquery in the materialized view and the Kafka engine, which may not support certain query structures correctly."
}