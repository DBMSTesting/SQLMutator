{
    "sql": "CREATE TABLE test1 (id UInt64, date Date) ENGINE = MergeTree(date, (id, date), 8192); CREATE TABLE test2 (id UInt64, date Date) ENGINE = MergeTree(date, (id, date), 8192); CREATE VIEW test_stats AS SELECT _name, rows_total, rows_inserted, minus(rows_total, rows_inserted) AS _delta FROM (SELECT * FROM (SELECT 'test1' AS _name, 1234 AS rows_total, count() AS rows_inserted FROM default.test1 UNION ALL SELECT 'test2' AS _name, 4568 AS rows_total, count() AS rows_inserted FROM default.test2)); INSERT INTO test1 VALUES (1, '2016-09-10'); INSERT INTO test1 (id, date) VALUES (1, '2016-09-10'); CREATE VIEW test_stats AS SELECT cnt FROM (SELECT cnt FROM (SELECT count() AS cnt FROM default.test1 UNION ALL SELECT count() AS cnt FROM default.test2)); INSERT INTO test1 (id, date) VALUES (2, '2016-09-10');",
    "Affected Elements": "CREATE VIEW, UNION ALL, INSERT INTO",
    "Root Cause Analysis": "The view definition includes renamed columns that cause conflicts when inserting into the base table, leading to exceptions about missing columns."
}