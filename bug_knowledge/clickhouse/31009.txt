{
    "sql": "CREATE TABLE left (key UInt32, value String) ENGINE = MergeTree ORDER BY key; CREATE TABLE right (key UInt32, value String) ENGINE = MergeTree ORDER BY tuple(); INSERT INTO left SELECT number, toString(number) FROM numbers(25367182); INSERT INTO right SELECT number, toString(number) FROM numbers(23124707); SET join_algorithm='partial_merge_join'; SELECT key, count(1) AS cnt FROM (SELECT data.key FROM (SELECT key FROM left AS s) AS data LEFT JOIN (SELECT key FROM right GROUP BY key) AS promo ON promo.key = data.key) GROUP BY key HAVING count(1) > 1 ORDER BY key ASC LIMIT 10;",
    "Affected Elements": "LEFT JOIN, GROUP BY, HAVING",
    "Root Cause Analysis": "The use of the 'partial_merge_join' algorithm may lead to incorrect join behavior resulting in duplicated rows in the output."
}