{
    "sql": "CREATE TABLE test (timestamp DateTime, col1 Nullable(Float64), col2 Nullable(Float64)) ENGINE = MergeTree() ORDER BY timestamp; CREATE MATERIALIZED VIEW test_view (timestamp DateTime, col1 AggregateFunction(avg, Float64), col2 AggregateFunction(max, Float64)) ENGINE = AggregatingMergeTree() ORDER BY timestamp AS SELECT toStartOfMinute(timestamp) AS timestamp, avgState(col1) AS col1, maxState(col2) AS col2 FROM test GROUP BY timestamp ORDER BY timestamp; INSERT INTO test (timestamp, col1, col2) VALUES ('2019-08-22 15:01:00', null, null); SELECT timestamp, avgMerge(col1), maxMerge(col2) FROM test_view GROUP BY timestamp;",
    "Affected Elements": "AggregateFunction, Nullable, maxState, avgState",
    "Root Cause Analysis": "The AggregatingMergeTree implementation does not handle NULL values correctly in aggregation functions, leading to unexpected results."
}