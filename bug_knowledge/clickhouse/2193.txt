{
    "sql": "CREATE TABLE IF NOT EXISTS video_seconds_views (entityIri String, courseId UInt64, learnerId UInt64, testColumn String, secondsViews Nested(viewId String, startedAt DateTime, endedAt DateTime, secondsViewed Array(UInt8), secondsCounts Array(UInt32)), version DateTime) ENGINE = ReplacingMergeTree(version) PARTITION BY entityIri ORDER BY (learnerId, entityIri) SETTINGS index_granularity = 8192; CREATE TABLE IF NOT EXISTS video_seconds_views_buffer AS video_seconds_views ENGINE = Buffer(chbd_ay, video_seconds_views, 1, 30, 60, 500, 5000, 10000000000, 100000000000);",
    "Affected Elements": "Nested Columns, Array Types, Buffer Engine, ReplacingMergeTree",
    "Root Cause Analysis": "The issue arises when data is inserted into a Buffer table and then flushed into a ReplacingMergeTree, likely due to the incompatibility or incorrect handling of nested array structures."
}