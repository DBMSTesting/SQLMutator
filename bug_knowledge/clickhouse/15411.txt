{
    "sql": "CREATE DATABASE IF NOT EXISTS test; CREATE TABLE IF NOT EXISTS test.tc engine = MergeTree PARTITION BY (inn, toYYYYMM(received)) ORDER BY (inn, sessionId) AS SELECT now() AS received, '123456789' AS inn, '42' AS sessionId; CREATE TABLE IF NOT EXISTS test.tj engine = MergeTree PARTITION BY (inn, toYYYYMM(received)) ORDER BY (inn, sessionId) AS SELECT now() AS received, '123456789' AS inn, '42' AS sessionId, '111' AS serial, '222' AS reg; SELECT rq.inn, arrayFirst(t -> isNotNull(t), regInfo.1), arrayFirst(t -> isNotNull(t), regInfo.2) FROM test.tc AS rq INNER JOIN (SELECT rs.inn, rs.sessionId, groupArray((serial, reg)) AS regInfo FROM test.tj AS rs GROUP BY inn, sessionId) AS resp ON (rq.inn = resp.inn) AND (rq.sessionId = resp.sessionId) WHERE if('123456789' IS NOT NULL, rq.inn = '123456789', 1);",
    "Affected Elements": "tupleElement function, inner join clause, if statement",
    "Root Cause Analysis": "The second argument of the tupleElement function is not a constant UInt or String, causing the query to fail."
}