{
    "sql": "SELECT formatDateTime(TS_T_1_.dt, '%Y%m%d') AS T_0_2_, sum(room_act_duration) AS T_1_3_, countDistinct(room_id) AS T_2_4_, countDistinct(if(room_is_exposed = 1, room_id, NULL)) AS T_3_5_ FROM ( SELECT dt, room_id, multiIf(room_property = 'business', '商业房', room_property = 'fleet', '家族房', '个人房') AS room_property, room_channel, room_is_exposed, arraySum(groupArray(duration)) + arraySum(arrayFilter(x -> (x < 0), arrayDifference(arrayFlatten(arraySort(x -> (x[1]), groupArray([start_time, end_time])))))) AS room_act_duration FROM dws_oversea.ads_anu_onmic_user_room_di_dis WHERE (channel_name IN ('af_Social_facebook', 'af_asm_440644258')) AND (multiIf(gender = 1, '男', gender = 2, '女', '未知') IN ('未知', '男')) AND ('BI' = 'BI') AND ('BI' = 'BI') AND ('BI' = 'BI') GROUP BY dt, room_id, room_property, room_channel, room_is_exposed ) AS TS_T_1_ GROUP BY formatDateTime(TS_T_1_.dt, '%Y%m%d') LIMIT 1000;",
    "Affected Elements": "Set index condition, multiIf function",
    "Root Cause Analysis": "The inclusion of always-true conditions in the WHERE clause affects the expected data type for the set index condition, leading to a mismatch error."
}