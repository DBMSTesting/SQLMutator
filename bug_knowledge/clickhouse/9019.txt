{
    "sql": "select courseId, uniqExact(learnerId) from entities_attempts_distributed group by courseId order by courseId; select uniqExact(learnerId) from entities_attempts_distributed where courseId = 41; select uniqExact(learnerId) from entities_attempts_distributed where identity(courseId) = 41; CREATE TABLE cursometr.entities_attempts_replicated (learnerId UInt64, courseId UInt64, actorId UInt64, entityIri String, startedAt DateTime, attemptNumber UInt16, attemptLearningNumber UInt16, attemptRepeatingNumber UInt16, attemptBeforePassedNumber UInt16, attemptAfterPassedNumber UInt16, endedAt DateTime, passed UInt8, success UInt8, learning UInt8, repeating UInt8, beforePassed UInt8, afterPassed UInt8, result Float32, durationTotal UInt32, durationLearning UInt32, durationRepeating UInt32, durationBeforePassed UInt32, durationAfterPassed UInt32, reject UInt8, version DateTime, hash UInt64, queryId UInt64) ENGINE = ReplicatedMergeTree('/clickhouse/tables/cursometr/{shard}/entities_attempts', '{replica}') PARTITION BY toStartOfDay(version) ORDER BY (courseId, learnerId, hash, entityIri) SETTINGS index_granularity = 8192; alter table entities_attempts_replicated attach partition 'my_partition' from 'my_temp_table'; alter table entities_attempts_replicated delete where hash not in (select hash from 'my_temporary_hashes_table')",
    "Affected Elements": "uniqExact, identity, group by, order by, delete",
    "Root Cause Analysis": "The issue likely stems from corruption in the indexing of the ReplicatedMergeTree table after the Clickhouse version update, resulting in inconsistencies in query results."
}