{
    "sql": "CREATE TEMPORARY TABLE IF NOT EXISTS tmp_a (k1 Int32, k2 Int32, d1 Int32, d2 Int32) ENGINE = Memory; INSERT INTO tmp_a VALUES (1,2,3,4); INSERT INTO tmp_a VALUES (5,6,7,8); CREATE TEMPORARY TABLE IF NOT EXISTS tmp_b (k1 Int32, k2 Int32, d0 Float64) ENGINE = Memory; INSERT INTO tmp_b VALUES (1,2,0.3); INSERT INTO tmp_b VALUES (5,6,0.4); SELECT tb1.*, tb2.* FROM ( WITH tmp01 AS (SELECT k1, k2, d1 FROM tmp_a), tmp_s AS (SELECT k1, k2, d0 FROM tmp_b), tmp1 AS (SELECT tmp01.*, tmp_s.d0 FROM tmp01 LEFT JOIN tmp_s ON tmp01.k1 = tmp_s.k1 AND tmp01.k2 = tmp_s.k2) SELECT * FROM tmp1 ) AS tb1 LEFT JOIN ( WITH tmp0 AS (SELECT k1, k2, d2 FROM tmp_a), tmp_s AS (SELECT k1, k2, d0 FROM tmp_b), tmp1 AS (SELECT tmp0.*, tmp_s.d0 FROM tmp0 LEFT JOIN tmp_s ON tmp0.k1 = tmp_s.k1 AND tmp0.k2 = tmp_s.k2) SELECT * FROM tmp1 ) AS tb2 ON tb1.k1 = tb2.k1 AND tb1.k2 = tb2.k2;",
    "Affected Elements": "WITH clause, LEFT JOIN, SELECT statements",
    "Root Cause Analysis": "The error arises from the CTE 'tmp0' in the second subquery not having access to the column 'd1' from 'tmp_a', leading to a missing column error when executing the query."
}