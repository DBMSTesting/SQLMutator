{
    "sql": "CREATE TABLE subscriptions_replacing (subscription_id UInt64, account_id UInt64, _is_deleted UInt8, _version UInt64) ENGINE = ReplicatedReplacingMergeTree('/clickhouse/{cluster}/tables/{database}/{table}', '{replica}', _version, _is_deleted) PRIMARY KEY (account_id, subscription_id) ORDER BY (account_id, subscription_id) SETTINGS min_age_to_force_merge_seconds = 300, min_age_to_force_merge_on_partition_only = 1, index_granularity = 8192; select count() from subscriptions_replacing final SETTINGS do_not_merge_across_partitions_select_final = 1; select count() from subscriptions_replacing final where _is_deleted=0 SETTINGS do_not_merge_across_partitions_select_final = 1;",
    "Affected Elements": "FINAL keyword, SETTINGS clause, ReplacingMergeTree table engine",
    "Root Cause Analysis": "The setting do_not_merge_across_partitions_select_final is not filtering deleted rows correctly due to an unexpected interaction with the ReplacingMergeTree logic."
}