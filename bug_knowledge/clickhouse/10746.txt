{
    "sql": "SELECT sales_employee_type AS salesEmployeeType, sum(toInt16OrZero(sku_qty)) AS qty FROM (SELECT art_sku_sale_history.id AS id, art_sku_sale_history.rksj AS rksj, art_sku_sale_history.enabled AS enabled, art_sku_sale_history.sku_qty AS sku_qty, scd_shop_principal.employee_type AS sales_employee_type FROM shared_ods.art_sku_sale_history ASOF LEFT JOIN shared_dwd.scd_shop_principal ON art_sku_sale_history.tenant_code = scd_shop_principal.tenant_code AND art_sku_sale_history.sale_date > scd_shop_principal.principal_datetime) WHERE enabled = '1' AND (id, rksj) IN (SELECT id, max(rksj) FROM shared_ods.art_sku_sale_history GROUP BY id) GROUP BY salesEmployeeType;",
    "Affected Elements": "ASOF LEFT JOIN, GROUP BY, SUM",
    "Root Cause Analysis": "The inconsistency in the results likely arises from data discrepancies between the two tables involved in the join, particularly since one table (scd_shop_principal) only has data on a different ClickHouse instance."
}