{
    "sql": "CREATE TABLE db.local_t_coupon_xxx (id UInt64, created_at Nullable(String), created_by Nullable(String), updated_at Nullable(String), day_id UInt32, etl_time UInt64) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/local_t_coupon_xxx', '{replica}') PARTITION BY day_id ORDER BY (etl_time, day_id) SETTINGS index_granularity = 8192; CREATE TABLE db.all_t_coupon_xxx (id UInt64, created_at Nullable(String), created_by Nullable(String), updated_at Nullable(String), day_id UInt32, etl_time UInt64) ENGINE = Distributed(ha_cluster, 'db', 'local_t_coupon_xxx', id); SELECT count() FROM all_t_coupon_xxx WHERE day_id=20190513 AND etl_time=20190513223000; ALTER TABLE local_t_coupon_xxx DELETE WHERE day_id=20190513 AND etl_time=20190513223000;",
    "Affected Elements": "CREATE TABLE, ENGINE = ReplicatedMergeTree, ENGINE = Distributed, SELECT, ALTER TABLE",
    "Root Cause Analysis": "The issue may stem from replication inconsistencies or errors in the distributed query execution due to the improper handling of deleted and reinserted data in the ReplicatedMergeTree."
}