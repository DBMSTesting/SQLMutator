{
    "sql": "CREATE TABLE test1 (id bigint, code text) engine = MergeTree ORDER BY id; CREATE TABLE test2 (id bigint, code text, test1_id bigint, test3_id bigint) engine = MergeTree ORDER BY id; CREATE TABLE test3 (id bigint, code text) engine = MergeTree ORDER BY id; insert into test1 (id, code) select top 100000 number, toString(number) FROM system.numbers; insert into test2 (id, code, test1_id, test3_id) select top 100000 number, toString(number), number, number FROM system.numbers; insert into test3 (id, code) select top 100000 number, toString(number) FROM system.numbers; select count(test2.id) from test1, test2, test3 where test1.code in ('1', '2', '3') and test2.test1_id = test1.id and test2.test3_id = test3.id;",
    "Affected Elements": "COMMA JOIN, IN operator",
    "Root Cause Analysis": "The use of COMMA JOIN with the IN operator leads to excessive memory usage due to the way the query is executed and how joins are processed."
}