{
    "sql": "CREATE TABLE test_base (date Date, hits UInt32) ENGINE = MergeTree() PARTITION BY toYYYYMM(date) ORDER BY date; CREATE MATERIALIZED VIEW test_aggr (date Date, hits_state AggregateFunction(sum, UInt32)) ENGINE = AggregatingMergeTree() PARTITION BY toYYYYMM(date) ORDER BY date AS SELECT date, sumState(hits) AS hits_state FROM test_base GROUP BY date; CREATE VIEW test_view (date Date, hits UInt32) AS SELECT date, sumMerge(hits_state) AS hits FROM test_aggr GROUP BY date; INSERT INTO test_base FORMAT JSONEachRow {\"date\":\"2018-09-26\",\"hits\":1} {\"date\":\"2018-09-26\",\"hits\":2} {\"date\":\"2018-09-27\",\"hits\":4} {\"date\":\"2018-09-28\",\"hits\":8}; SELECT count(), sum(hits), groupArray(hits) FROM test_view;",
    "Affected Elements": "sum(hits), groupArray(hits)",
    "Root Cause Analysis": "The materialized view may not be correctly aggregating the last inserted row due to timing or data processing delays, resulting in an unexpected zero in the group array."
}