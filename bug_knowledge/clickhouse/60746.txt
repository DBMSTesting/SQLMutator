{
    "sql": "CREATE TABLE landing (timestamp DateTime64(3), status String, id String) ENGINE = MergeTree() ORDER BY timestamp; SYSTEM STOP MERGES landing; INSERT INTO landing (status, id, timestamp) SELECT * FROM generateRandom() LIMIT 1; INSERT INTO landing (status, id, timestamp) SELECT * FROM generateRandom() LIMIT 1; INSERT INTO landing (status, id, timestamp) SELECT * FROM generateRandom() LIMIT 1; SELECT count() FROM system.parts WHERE active AND (table = 'landing'); CREATE TABLE ds (timestamp DateTime64(3), status String, id String) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{layer}-{shard}/ds', '{replica}') ORDER BY timestamp; INSERT INTO ds SELECT * FROM landing SETTINGS insert_deduplicate=1, insert_deduplication_token='token1', max_insert_threads=5; SELECT count() FROM ds; SELECT event_time, database, table, name, error FROM system.part_log WHERE table = 'ds';",
    "Affected Elements": "INSERT INTO, SELECT, SETTINGS",
    "Root Cause Analysis": "The issue arises from parallel processing during the insert operation, resulting in multiple parts being created, which leads to unexpected deduplication behavior when the insert_deduplication_token is used."
}