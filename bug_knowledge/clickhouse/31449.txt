{
    "sql": "CREATE DATABASE IF NOT EXISTS ot; CREATE TABLE IF NOT EXISTS ot.ml_w2v_log (category String, word String, norm Float64, vector Array(Float64)) ENGINE = Log; CREATE TABLE IF NOT EXISTS ot.ml_w2v ENGINE = MergeTree() ORDER BY (word) PRIMARY KEY (word) AS SELECT category, word, norm, vector FROM (SELECT category, word, norm, vector FROM ot.ml_w2v_log); WITH (SELECT sumForEach(vector) FROM ot.ml_w2v PREWHERE word IN ('CHEMBL1737')) AS vv, sqrt(arraySum(x -> x * x, vv)) AS vvnorm, IF((vvnorm != 0.) AND (norm != 0.), arraySum(x -> x.1 * x.2, arrayZip(vv, vector)) / (norm * vvnorm), 0.) AS similarity SELECT category, word, similarity FROM ot.ml_w2v PREWHERE category IN ('disease') WHERE similarity >= 0.1 ORDER BY similarity DESC LIMIT 10 OFFSET 0;",
    "Affected Elements": "WITH clause, PREWHERE clause, IF function, arraySum function, arrayZip function",
    "Root Cause Analysis": "The change in the ClickHouse version may have altered how the similarity calculation is performed, resulting in incorrect output where words from categories outside of 'disease' are returned."
}