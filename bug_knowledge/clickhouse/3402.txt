{
    "sql": "CREATE TABLE test (ts DATETIME,id VARCHAR,str Nullable(VARCHAR),num Nullable(DOUBLE)) ENGINE=MergeTree PARTITION BY toStartOfDay(ts) ORDER BY tuple(); INSERT INTO test VALUES(now(),'1',null,null); SELECT ts,id,any(str),any(num) FROM test GROUP BY ts,id; CREATE TABLE test2_src (ts DATETIME,id VARCHAR,str Nullable(VARCHAR),num Nullable(DOUBLE)) ENGINE=Null; CREATE MATERIALIZED VIEW test2_mv ENGINE=AggregatingMergeTree PARTITION BY toStartOfDay(ts) ORDER BY tuple() AS SELECT ts,id,anyState(str) str,anyState(num) num FROM test2_src GROUP BY ts,id; INSERT INTO test2_src VALUES(now(),'1',null,null); SELECT ts,id,anyMerge(str),anyMerge(num) FROM test2_mv GROUP BY ts,id;",
    "Affected Elements": "anyState(str), anyState(num), anyMerge(str), anyMerge(num)",
    "Root Cause Analysis": "The AggregatingMergeTree engine may not be handling Nullable types correctly, leading to improper storage or representation of Null values in the aggregated results."
}