{
    "sql": "SELECT sum(ws_net_paid) as total_sum, i_category, i_class, grouping(i_category) + grouping(i_class) as lochierarchy, rank() OVER (PARTITION BY grouping(i_category) + grouping(i_class), case when grouping(i_class) = 0 then i_category end ORDER BY sum(ws_net_paid) DESC) as rank_within_parent FROM web_sales, date_dim d1, item WHERE d1.d_month_seq BETWEEN 1212 AND 1212 + 11 AND d1.d_date_sk = ws_sold_date_sk AND i_item_sk = ws_item_sk GROUP BY ROLLUP(i_category, i_class) ORDER BY lochierarchy DESC, case when lochierarchy = 0 then i_category end, rank_within_parent LIMIT 100;",
    "Affected Elements": "Unknown column, if, equals, plus, grouping",
    "Root Cause Analysis": "The error arises from referencing a calculated column 'lochierarchy' in the ORDER BY clause of the same SELECT statement, which is not recognized as it is not defined until the SELECT execution phase."
}