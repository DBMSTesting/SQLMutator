{
    "sql": "CREATE TABLE test.quants (TS DateTime, Region LowCardinality(String), Metric LowCardinality(String), QuantAvg Float64, Updated DateTime) ENGINE = ReplacingMergeTree(Updated) PARTITION BY (Region, toYYYYMM(TS)) PRIMARY KEY (Region, TS) ORDER BY (Region, TS, Metric); CREATE TABLE test.trends (TS DateTime, Region LowCardinality(String), Metric LowCardinality(String), TrendAvg Float64, Updated DateTime) ENGINE = ReplacingMergeTree(Updated) PARTITION BY (Region, toYYYYMM(TS)) PRIMARY KEY (Region, TS) ORDER BY (Region, TS, Metric); SELECT TS, Region, Metric, QuantAvg, TrendAvg FROM (SELECT TS, Region, Metric, QuantAvg FROM test.quants WHERE Region = 'asia') ALL LEFT JOIN (SELECT TS, Region, Metric, TrendAvg FROM test.trends WHERE Region = 'asia') USING (TS, Region, Metric);",
    "Affected Elements": "LowCardinality(String) data type, JOIN clause with USING",
    "Root Cause Analysis": "The issue arises from the hashed values of LowCardinality(String) being inconsistent across different tables, leading to unexpected empty results in JOIN operations."
}