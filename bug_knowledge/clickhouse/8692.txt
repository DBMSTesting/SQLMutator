{
    "sql": "CREATE DATABASE IF NOT EXISTS temp; CREATE TABLE temp.test ( `id` Nullable(String), `status` Nullable(Enum8('NEW' = 0, 'CANCEL' = 1)), `nested.nestedType` Array(Nullable(String)), `partition` Date ) ENGINE = MergeTree() PARTITION BY partition ORDER BY partition SETTINGS index_granularity = 8192; INSERT INTO temp.test VALUES ('1', 'NEW', array('a', 'b'), now()); SELECT status, count() AS all FROM temp.test ARRAY JOIN nested.nestedType as nestedJoined WHERE (status IN (SELECT status FROM temp.test ARRAY JOIN nested.nestedType as nestedJoined GROUP BY status ORDER BY count() DESC LIMIT 10)) AND (id IN ('1', '2')) GROUP BY CUBE(status) LIMIT 100;",
    "Affected Elements": "ARRAY JOIN, ENUM type, subquery with GROUP BY",
    "Root Cause Analysis": "The exception indicates a mismatch between the sizes of the Enum offsets and the corresponding column data, likely due to the handling of the ARRAY JOIN operation on the Enum/Int column."
}