{
    "sql": "CREATE TABLE address (email_address String, domain LowCardinality(String), first_name String, last_name String, country LowCardinality(String), esp UInt8, list_import_sid LowCardinality(String)) ENGINE = MergeTree PRIMARY KEY (list_import_sid, country, esp, domain, email_address) ORDER BY (list_import_sid, country, esp, domain, email_address) SETTINGS index_granularity = 8192; CREATE TABLE fact_click (sid String, campaign_sid LowCardinality(String), campaign_batch_sid LowCardinality(String)) ENGINE = ReplacingMergeTree ORDER BY (campaign_sid, campaign_batch_sid, sid) SETTINGS index_granularity = 8192; WITH records AS (SELECT address.email_address FROM address GROUP BY address.email_address), stats AS (SELECT (SELECT COUNT(*) FROM fact_click INNER JOIN records ON records.email_address = fact_click.email_address) AS num_clicks, (SELECT COUNT(*) FROM records) AS num_records) SELECT * FROM stats;",
    "Affected Elements": "INNER JOIN, ON clause",
    "Root Cause Analysis": "The upgrade to version 24.10.1 introduced stricter validation for join keys, causing the query to fail when it cannot determine the join keys correctly."
}