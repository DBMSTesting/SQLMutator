{
    "sql": "DROP TABLE IF EXISTS l; DROP TABLE IF EXISTS r; DROP TABLE IF EXISTS nl; DROP TABLE IF EXISTS nr; DROP TABLE IF EXISTS l_lc; DROP TABLE IF EXISTS r_lc; CREATE TABLE l (x UInt32, lc String) ENGINE = Memory; CREATE TABLE r (x UInt32, lc String) ENGINE = Memory; CREATE TABLE nl (x Nullable(UInt32), lc Nullable(String)) ENGINE = Memory; CREATE TABLE nr (x Nullable(UInt32), lc Nullable(String)) ENGINE = Memory; CREATE TABLE l_lc (x UInt32, lc LowCardinality(String)) ENGINE = Memory; CREATE TABLE r_lc (x UInt32, lc LowCardinality(String)) ENGINE = Memory; INSERT INTO r VALUES (0, 'str'), (1, 'str_r'); INSERT INTO nr VALUES (0, 'str'), (1, 'str_r'); INSERT INTO r_lc VALUES (0, 'str'), (1, 'str_r'); INSERT INTO l VALUES (0, 'str'), (2, 'str_l'); INSERT INTO nl VALUES (0, 'str'), (2, 'str_l'); INSERT INTO l_lc VALUES (0, 'str'), (2, 'str_l'); SET join_algorithm = 'partial_merge', join_use_nulls = 1; SELECT toTypeName(r.lc), toTypeName(materialize(r.lc)), [NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '', '', NULL, NULL, NULL, NULL, NULL, NULL], r.lc, materialize(r.lc), toTypeName(l.lc), toTypeName(materialize(l.lc)), l.lc FROM l_lc AS l FULL OUTER JOIN r_lc AS r USING (x) ORDER BY r.lc ASC, x ASC NULLS LAST;",
    "Affected Elements": "FULL OUTER JOIN, materialize(), LowCardinality(String), Nullable(String)",
    "Root Cause Analysis": "The error indicates a type mismatch when attempting to cast a Nullable type to a String type during the join operation, likely due to NULL values not being handled properly."
}