{
    "sql": "DROP DATABASE IF EXISTS demo ON CLUSTER cluster_1shards_2replicas; CREATE DATABASE IF NOT EXISTS demo ON CLUSTER cluster_1shards_2replicas; DROP TABLE IF EXISTS demo.rmt_local ON CLUSTER cluster_1shards_2replicas; CREATE TABLE IF NOT EXISTS demo.rmt_local ON CLUSTER cluster_1shards_2replicas (id UInt32, name String, amount Decimal32(2), created_at Date) ENGINE = ReplicatedReplacingMergeTree('/clickhouse/tables/{layer}-{shard}/{database}/{table}','{replica}') PARTITION BY toYYYYMM(created_at) ORDER BY (id); INSERT INTO demo.rmt_local(id, name, amount, created_at) VALUES (1, 'a', 10, '2020-10-01'), (1, 'b', 20, '2020-10-01'), (2, 'c', 30, '2020-10-01'), (3, 'd', 40, '2020-10-02'), (4, 'e', 50.9, '2020-10-01'), (5, 'f', 60.1, '2020-10-02'); SELECT * FROM demo.rmt_local;",
    "Affected Elements": "ReplicatedReplacingMergeTree, ZooKeeper path management",
    "Root Cause Analysis": "The issue appears to be related to ZooKeeper's inability to allocate a block number for the table, possibly due to node loss or transaction failure."
}