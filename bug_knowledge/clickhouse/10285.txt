{
    "sql": "CREATE MATERIALIZED VIEW table_slow_query_local ENGINE = MergeTree() PARTITION BY toDate(startTime) ORDER BY (query_id) TTL startTime + INTERVAL 90 DAY POPULATE AS SELECT eventDate, startTime, status, useSeconds, readRows, resultRows, writeRows, writtenMB, memoryUsageMB, clusterName, serverName, serverIp, initial_query_id, query_id, queryFromHost FROM ( SELECT event_date AS eventDate, query_start_time AS startTime, multiIf(type = 1, 'start', type = 2, 'success', type = 3, 'errorBeforeStart', type = 4, 'errorProcessing', 'other') AS status, query_duration_ms / 1000 AS useSeconds, read_rows AS readRows, result_rows AS resultRows, written_rows AS writeRows, written_bytes / 1024 / 1024 AS writtenMB, memory_usage / (1024 * 1024) AS memoryUsageMB, initial_query_id, query_id, substring(IPv6NumToString(address), 8, 15) AS queryFromHost, '1' AS joinkey FROM system.query_log ) a JOIN ( SELECT cluster AS clusterName, host_name AS serverName, host_address AS serverIp, '1' AS joinkey FROM system.clusters WHERE is_local LIMIT 1 ) b ON a.joinkey = b.joinkey;",
    "Affected Elements": "CREATE MATERIALIZED VIEW, JOIN, SELECT, TTL, POPULATE",
    "Root Cause Analysis": "The issue arises from the materialized view causing a failure in log flushing due to improper handling of the query log elements."
}