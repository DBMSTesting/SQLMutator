{
    "sql": "DROP TABLE cdp_tags; CREATE TABLE cdp_tags (tag_id String, mid_seqs AggregateFunction(groupBitmap, UInt32), cardinality UInt32) engine=ReplacingMergeTree() ORDER BY (tag_id) SETTINGS index_granularity=1; INSERT INTO cdp_tags SELECT concat('is_member_', toString(is_member)) AS tag_id, groupBitmapState(mid_seq) AS mid_seqs, bitmapCardinality(mid_seqs) AS cardinality FROM dist_cdp_cust_tag GROUP BY is_member; INSERT INTO cdp_tags SELECT concat('member_origin_channel_', toString(member_origin_channel)) AS tag_id, groupBitmapState(mid_seq) AS mid_seqs, bitmapCardinality(mid_seqs) AS cardinality FROM dist_cdp_cust_tag GROUP BY member_origin_channel; SELECT tag_id, bitmapCardinality(mid_seqs), cardinality FROM cdp_tags WHERE like(tag_id, 'is_member_%') ORDER BY cardinality DESC; SELECT tag_id, bitmapCardinality(mid_seqs), cardinality FROM cdp_tags WHERE like(tag_id, 'member_origin_channel_%') ORDER BY cardinality DESC; INSERT INTO cdp_tags SELECT concat('member_origin_channel_', toString(member_origin_channel)) AS tag_id, bitmapBuild(cast([3,19,47] as Array(UInt32))) AS mid_seqs, bitmapCardinality(mid_seqs) AS cardinality FROM dist_cdp_cust_tag GROUP BY member_origin_channel; SELECT tag_id, bitmapCardinality(mid_seqs), cardinality FROM cdp_tags WHERE like(tag_id, 'member_origin_channel_%') ORDER BY cardinality DESC;",
    "Affected Elements": "INSERT INTO, SELECT, GROUP BY, bitmapCardinality, groupBitmapState, like",
    "Root Cause Analysis": "The issue seems to be related to how bitmap data is being handled during the insert operations, potentially due to changes in the ClickHouse server version affecting bitmap aggregation or state handling."
}