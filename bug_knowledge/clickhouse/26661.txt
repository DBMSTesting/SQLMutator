{
    "sql": "SELECT 100000000 AS area_code, 32 AS area_category_id, 'Nation' AS area_name, 100000000 AS class_code, 32 AS class_category_id, 'allClass' AS class_name, sum(IF(class_line_id > 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = 20210719 AND c_t <= 1626684005 AND order_status > 0 AND promotion_type NOT IN (1, 2, 99) AND IF(sale_type IS NULL, 3, sale_type) = 1 AND city_flag = 2) oi JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id LEFT JOIN (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = 33) cus ON sku.class2_id = cus.class_l2_id UNION ALL SELECT sa.big_area_id AS area_code, 7 AS area_category_id, sa.big_area_name AS area_name, 100000000 AS class_code, 32 AS class_category_id, 'allClass' AS class_name, sum(IF(class_line_id > 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = 20210719 AND c_t <= 1626684005 AND order_status > 0 AND promotion_type NOT IN (1, 2, 99) AND IF(sale_type IS NULL, 3, sale_type) = 1 AND city_flag = 2) oi JOIN (SELECT sale_area_id, big_area_id, big_area_name FROM etl_membi_dim_city_manage_type final) sa ON sa.sale_area_id = oi.sale_area_id JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id LEFT JOIN (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = 33) cus ON sku.class2_id = cus.class_l2_id GROUP BY area_code, area_name UNION ALL SELECT sa.zhucheng_id AS area_code, 34 AS area_category_id, sa.zhucheng_name AS area_name, 100000000 AS class_code, 32 AS class_category_id, 'allClass' AS class_name, sum(IF(class_line_id > 0, order_money, 0)) / sum(order_money) AS protein_ratio FROM (SELECT order_datekey, sku_id, company_id, sale_area_id, order_status, order_money, sale_type FROM etl_dwd_ord_order_detail_rt final WHERE order_datekey = 20210719 AND c_t <= 1626684005 AND order_status > 0 AND promotion_type NOT IN (1, 2, 99) AND IF(sale_type IS NULL, 3, sale_type) = 1 AND city_flag = 2) oi JOIN (SELECT sale_area_id, zhucheng_id, zhucheng_name FROM etl_membi_dim_city_manage_type final) sa ON sa.sale_area_id = oi.sale_area_id JOIN (SELECT sku_id, class2_id, class2_name FROM etl_membi_product_pms_class_sku_map_realtime final) sku ON oi.sku_id = sku.sku_id LEFT JOIN (SELECT class_l2_id, class_line_id FROM etl_dim_custom_class WHERE class_line_id = 33) cus ON sku.class2_id = cus.class_l2_id GROUP BY area_code, area_name FORMAT TabSeparatedWithNamesAndTypes;",
    "Affected Elements": "UNION ALL, GROUP BY, JOIN",
    "Root Cause Analysis": "The crash is likely due to memory issues triggered by executing complex UNION ALL queries, possibly exacerbated by parallel execution."
}