{
    "sql": "CREATE TABLE IF NOT EXISTS vmr_global_variables(uts DateTime DEFAULT now(), id UInt64, nvalue Float64, value_isnull UInt8) ENGINE = ReplacingMergeTree(uts) ORDER BY (id); SELECT max(uts) AS udate, id, if(argMax(value_isnull, uts)=1,null,argMax(nvalue, uts)) AS nvalue, argMax(value_isnull, uts) AS value_isnull FROM vmr_global_variables GROUP BY id; SELECT max(uts) AS udate, id, if(argMax(t.value_isnull, uts)=1,null,argMax(nvalue, uts)) AS nvalue, argMax(t.value_isnull, uts) AS value_isnull FROM vmr_global_variables t GROUP BY id; CREATE OR REPLACE VIEW vma_global_variables AS SELECT max(uts) AS udate, id, if(argMax(t.value_isnull, uts)=1,null,argMax(nvalue, uts)) AS nvalue, argMax(t.value_isnull, uts) AS value_isnull FROM vmr_global_variables t GROUP BY id;",
    "Affected Elements": "argMax(value_isnull, uts), argMax(t.value_isnull, uts)",
    "Root Cause Analysis": "The aggregate function argMax is incorrectly nested within another aggregate function, causing a missing column error when creating the view."
}