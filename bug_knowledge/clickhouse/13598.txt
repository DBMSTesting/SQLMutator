{
    "sql": "CREATE TABLE test (ts DATETIME, id VARCHAR, ver Int8, str Nullable(VARCHAR), num Nullable(DOUBLE)) ENGINE=MergeTree PARTITION BY toStartOfDay(ts) ORDER BY id; INSERT INTO test VALUES (now(), '1', 1, null, null); SELECT ts, id, argMax(str, ver), argMax(num, ver) FROM test GROUP BY ts, id; CREATE MATERIALIZED VIEW test_mv ENGINE=AggregatingMergeTree PARTITION BY toStartOfDay(ts) ORDER BY id POPULATE AS SELECT ts, id, argMaxOrNullState(str, ver) AS str, argMaxOrNullState(num, ver) AS num FROM test GROUP BY ts, id; SELECT ts, id, argMaxOrNullMerge(str), argMaxOrNullMerge(num) FROM test_mv GROUP BY ts, id;",
    "Affected Elements": "argMaxOrNullState, argMaxOrNullMerge",
    "Root Cause Analysis": "The functions argMaxOrNullState and argMaxOrNullMerge are not handling NULL values appropriately, leading to unexpected NULL outputs instead of the expected results."
}