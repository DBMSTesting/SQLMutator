{
    "sql": "DROP TABLE database_for_dict.table_for_dict; CREATE TABLE database_for_dict.table_for_dict ( CountryID UInt64, StartDate DateTime, EndDate DateTime, Tax Float64 ) ENGINE = MergeTree() ORDER BY CountryID; INSERT INTO database_for_dict.table_for_dict VALUES(1, toDateTime('2019-05-05 00:00:00'), toDateTime('2019-05-20 23:59:59'), 0.33); INSERT INTO database_for_dict.table_for_dict VALUES(1, toDateTime('2019-05-21 00:00:00'), toDateTime('2019-05-30 00:00:00'), 0.42); INSERT INTO database_for_dict.table_for_dict VALUES(2, toDateTime('2019-05-21 00:00:00'), toDateTime('2019-05-30 00:00:00'), 0.46); DROP DICTIONARY database_for_dict.dict1; CREATE DICTIONARY database_for_dict.dict1 ( CountryID UInt64, StartDate DateTime, EndDate DateTime, Tax Float64 ) PRIMARY KEY CountryID SOURCE(CLICKHOUSE(HOST 'localhost' PORT 9000 USER 'default' TABLE 'table_for_dict' DB 'database_for_dict')) LIFETIME(MIN 1 MAX 1000) LAYOUT(RANGE_HASHED()) RANGE(MIN StartDate MAX EndDate); SELECT dictGetFloat64('database_for_dict.dict1', 'Tax', toUInt64(1), toDateTime('2019-05-15 00:00:00')); SELECT dictGetFloat64('database_for_dict.dict1', 'Tax', toUInt64(1), toDateTime('2019-05-29 00:00:00')); SELECT dictGetFloat64('database_for_dict.dict1', 'Tax', toUInt64(2), toDateTime('2019-05-29 00:00:00')); SELECT dictGetFloat64('database_for_dict.dict1', 'Tax', toUInt64(2), toDateTime('2019-05-31 00:00:00'));",
    "Affected Elements": "RANGE_HASHED, RANGE(MIN StartDate MAX EndDate)",
    "Root Cause Analysis": "The DDL for the dictionary does not properly handle DateTime types in the RANGE_HASHED layout, leading to unexpected default results."
}