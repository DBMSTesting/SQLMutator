{
    "sql": "create table merge (url String, mergedUrls Array(String)) engine = Memory; insert into merge values ('a', ['b', 'c']); with input as ( select distinct on (d.url) d.url as cluster_name from merge d order by d.url desc limit 100 ), cluster_url_q1 as ( select distinct on (d.url) d.url as cluster_name, d.mergedUrls as url from merge d where d.url in (select cluster_name from input) order by d.url ), cluster_url_t as ( select distinct on (cluster_name, url) cluster_name, array join url as url from cluster_url_q1 ) select groupArray((cluster_name, url)) as cluster_url_a from cluster_url_t settings enable_analyzer=1;",
    "Affected Elements": "array join, distinct on",
    "Root Cause Analysis": "The array join is not functioning as intended due to the interaction with the enable_analyzer setting, causing it to not flatten the array correctly."
}