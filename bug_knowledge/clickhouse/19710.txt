{
    "sql": "CREATE TABLE table_merge_across (ts DateTime, val String) ENGINE = ReplacingMergeTree() PARTITION BY toYYYYMMDD(ts) ORDER BY (ts) SETTINGS index_granularity = 8192; INSERT INTO table_merge_across(ts) SELECT toDateTime(toDate('2021-01-27')) FROM numbers(1); INSERT INTO table_merge_across(ts) SELECT toDateTime(toDate('2021-02-27')) FROM numbers(1); OPTIMIZE TABLE table_merge_across PARTITION ID '20210127' FINAL; SELECT count() FROM table_merge_across FINAL WHERE NOT ignore(val) AND NOT ignore(ts) SETTINGS do_not_merge_across_partitions_select_final = 1;",
    "Affected Elements": "CAST function in SELECT statement; SETTINGS clause",
    "Root Cause Analysis": "The query fails to cast a String to DateTime due to the 'do_not_merge_across_partitions_select_final' setting causing issues when reading from multiple partitions."
}