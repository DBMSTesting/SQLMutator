{
    "sql": "CREATE TABLE loadstat (`date` Date, `userId` String, `_id` String, `host` String) ENGINE = ReplacingMergeTree() PARTITION BY date ORDER BY (host, userId, _id) SETTINGS index_granularity = 8192; INSERT INTO loadstat SELECT toDate(now() - (1000000 - number) * 1) AS date, toUUID(number % 1000) AS userId, toUUID(number), CONCAT('ya', toString(number % 1000), '.ru') FROM system.numbers LIMIT 1000000 SETTINGS max_partitions_per_insert_block = 100000; CREATE VIEW loadstat_view AS SELECT * FROM loadstat; SELECT toStartOfMonth(date) AS dt, count(*) FROM loadstat_view WHERE date >= '2020-01-29' GROUP BY dt ORDER BY dt ASC;",
    "Affected Elements": "VIEW, WHERE clause, GROUP BY clause",
    "Root Cause Analysis": "The issue is related to the view not pushing down the predicate correctly, leading to a full table scan instead of utilizing the index for filtering."
}