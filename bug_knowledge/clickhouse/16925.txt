{
    "sql": "SELECT max(timestamp) FROM items.requests WHERE (timestamp >= '2020-11-09 23:00:00') AND (timestamp <= '2020-11-09 23:59:59'); CREATE DATABASE shard; CREATE TABLE shard.requests (timestamp DateTime('UTC'), name String, products Array(String), INDEX timestamp_idx timestamp TYPE minmax GRANULARITY 4) ENGINE = MergeTree() ORDER BY (name, timestamp, intHash32(timestamp)) SAMPLE BY intHash32(timestamp) PARTITION BY toYYYYMMDD(timestamp) TTL timestamp + INTERVAL 60 DAY TO VOLUME 'cold_volume', timestamp + INTERVAL 180 DAY DELETE SETTINGS storage_policy='policy_hot_and_cold'; CREATE DATABASE items; CREATE TABLE items.requests (timestamp DateTime('UTC'), name String, products Array(String)) ENGINE = Distributed('items_cluster', '', requests, rand());",
    "Affected Elements": "SELECT statement, MergeTree index creation, Distributed table configuration",
    "Root Cause Analysis": "The bug likely originates from a mismatch or corruption in the marks file associated with the MergeTree index, leading to the exception when attempting to read from the index during the SELECT operation."
}