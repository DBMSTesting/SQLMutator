{
    "sql": "SELECT T4.id AS SUBJECTID, T4.C1 AS SITEID, upper(C7.C2) AS PARENT_EVENTREFNAME, C6.C3 AS PARENT_EVENTOCCURRENCE, upper(T9.C2) AS EVENTREFNAME, if(C5.C3 IS NOT NULL, C5.C3, T10.C3) AS EVENTOCCURRENCE, T7.C2 AS FORMREFNAME, T7.title AS FORM_NAME, if(C5.C3 IS NOT NULL, T10.C3, 1) AS CRFOCCURRENCE, T8.C2 AS GROUPNAME, if(T1.C4 > 0, T1.C4, NULL) AS ROWNUMBER, format('{},{},{},{},{},{},{},{}', if(PARENT_EVENTREFNAME IS NOT NULL, PARENT_EVENTREFNAME, ''), if(PARENT_EVENTOCCURRENCE IS NOT NULL, toString(PARENT_EVENTOCCURRENCE), ''), if(EVENTREFNAME IS NOT NULL, EVENTREFNAME, ''), if(EVENTOCCURRENCE IS NOT NULL, toString(EVENTOCCURRENCE), ''), if(FORMREFNAME IS NOT NULL, toString(FORMREFNAME), ''), if(CRFOCCURRENCE IS NOT NULL, toString(CRFOCCURRENCE), ''), if(GROUPNAME IS NOT NULL, toString(GROUPNAME), ''), if(ROWNUMBER IS NOT NULL, toString(ROWNUMBER), '')) AS ITEM_ID, [T1.id, T1_pair.id] AS IDS_OF_LINKED_ITEMS, xxHash64(arraySort(IDS_OF_LINKED_ITEMS)) AS COMMON_ID, format('{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}-{}-{}', toString(T1.id), toString(T2.id), toString(T3.id), toString(T4.id), toString(T5.id), toString(T6.id), toString(T7.id), if(T1_pair.id IS NOT NULL, toString(T1_pair.id), '0'), if(T8.id IS NOT NULL, toString(T8.id), '0'), if(T9.id IS NOT NULL, toString(T9.id), '0'), if(T10.id IS NOT NULL, toString(T10.id), '0'), if(C5.id IS NOT NULL, toString(C5.id), '0'), if(C6.id IS NOT NULL, toString(C6.id), '0'), if(C7.id IS NOT NULL, toString(C7.id), '0')) AS CDR_SKEY, toDateTime64('2024-08-19T07:31:41.032266', 6) AS LAST_MODIFICATION, T5.study_id AS STUDYID, T4.sub_study_identifier AS SUBSTUDY, arrayReduce('max', lastUpdateDateTableValues) AS MODIFIEDDATETIME, modifiedByTableValues[indexOf(lastUpdateDateTableValues, MODIFIEDDATETIME)] AS MODIFIEDBYUSERID, 'Current' AS AUD_SNAPSHOT, '' AS AUD_BA_SCHEMA_NAME, '' AS PARTITION_0, '' AS PARTITION_1, T6.protocol_id AS STUDYNAME, CAST(T1.id, 'String') AS ID, ['T1', 'T2', 'T5', 'T7', 'T9', 'T3', 'T10', 'C5', 'C6', 'C7', 'T4', 'T8', 'T1_pair', 'T6'] AS lastUpdateDateTables, [T1._ts_ms, T2._ts_ms, T5._ts_ms, T7._ts_ms, T9._ts_ms, T3._ts_ms, T10._ts_ms, C5._ts_ms, C6._ts_ms, C7._ts_ms, T4._ts_ms, T8._ts_ms, T1_pair._ts_ms, T6._ts_ms] AS lastUpdateDateTableValues, [0, 0, T5.updated_by_id, T7.updated_by_id, T9.updated_by_id, T3.updated_by_id, T10.updated_by_id, C5.updated_by_id, C6.updated_by_id, C7.updated_by_id, T4.updated_by_id, T8.updated_by_id, 0, T6.updated_by_id] AS modifiedByTableValues, lastUpdateDateTables[indexOf(lastUpdateDateTableValues, MODIFIEDDATETIME)] AS lastUpdateDateTableName, if((T1.deleted = true) OR (T2.deleted = true) OR (T5.deleted = true) OR (T7.deleted = true) OR (T9.deleted = true) OR (T3.deleted = true) OR (T10.deleted = true) OR (C5.deleted = true) OR (C6.deleted = true) OR (C7.deleted = true) OR (T4.deleted = true) OR (T8.deleted = true) OR (T1_pair.deleted = true) OR (T6.deleted = true), true, false) AS INTERNAL_DELETED FROM default.T1 AS T1 INNER JOIN default.T2 AS T2 ON T1.link_definitions_parts_id = T2.id INNER JOIN default.T3 AS T3 ON T3.id = T1.event_crf_id INNER JOIN default.T4 AS T4 ON T4.id = T3.subject_id INNER JOIN default.T5 AS T5 ON T2.crf_version_id = T5.id INNER JOIN default.T6 AS T6 ON T6.id = T5.study_id INNER JOIN default.T7 AS T7 ON T5.crf_id = T7.id LEFT JOIN default.T1 AS T1_pair ON T1_pair.id = T1.link_event_crf_part_id LEFT JOIN default.T8 AS T8 ON T2.item_group_id = T8.id LEFT JOIN default.T9 AS T9 ON T2.study_event_definition_id = T9.id LEFT JOIN default.T10 AS T10 ON T10.id = T3.study_event_id LEFT JOIN default.T10 AS C5 ON C5.id = T10.repeating_form_parent_id LEFT JOIN default.T10 AS C6 ON C6.id = T10.parent_group LEFT JOIN default.T9 AS C7 ON C7.id = C6.study_event_definition_id SETTINGS join_algorithm = 'auto', final = 1;",
    "Affected Elements": "SELECT, JOIN, IF, FORMAT, ARRAY, CAST, SETTINGS",
    "Root Cause Analysis": "The exception indicates that parameters provided for array manipulation are exceeding the valid range after an upgrade, likely due to changes in how ClickHouse handles data structures or specific query execution plans."
}