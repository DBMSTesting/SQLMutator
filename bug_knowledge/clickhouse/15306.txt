{
    "sql": "CREATE MATERIALIZED VIEW case.view_mv_local (event_time DateTime, tenant_id UInt32, case_id UInt8, partner_id UInt16) ENGINE = SummingMergeTree() PARTITION BY toStartOfDay(event_time) ORDER BY (event_time, tenant_id, case_id, partner_id) TTL event_time + toIntervalDay(7) SETTINGS index_granularity = 8192 AS SELECT toStartOfHour(event_time) AS event_time, tenant_id, case_id, partner_ids[num] AS partner_id FROM case.view_local ARRAY JOIN arrayEnumerate(partner_ids) AS num GROUP BY event_time, tenant_id, case_id, partner_id; INSERT INTO case.view_local (session_id, tenant_id, case_id, partner_ids, event_time) VALUES('SsO12\":{fvc', 559041, 5512, [12,13,54,40], '2020-09-25 11:00:55');",
    "Affected Elements": "ARRAY JOIN arrayEnumerate(partner_ids)",
    "Root Cause Analysis": "The update to Clickhouse version 20.9.2.20 introduced changes in how ARRAY JOIN operates, leading to errors when a referenced column is not included in the materialized view definition."
}