{
    "sql": "CREATE TABLE ntest_orders ( `10_1` UInt32, `10_2` DateTime, `10_28` Date, INDEX nsl_orders_key1 `10_2` TYPE minmax GRANULARITY 1024, INDEX nsl_orders_key2 `10_28` TYPE minmax GRANULARITY 1024 ) ENGINE = MergeTree PARTITION BY toYear(`10_2`) ORDER BY `10_1` SETTINGS index_granularity = 8192; SELECT toMonth(`10_28`) AS date_fld, COUNT() AS cnt_1 FROM ntest_orders WHERE (`10_28` >= toDateTime('2021-05-01 00:00:00')) AND (`10_28` <= toDateTime('2021-05-26 23:59:59')) GROUP BY date_fld; ALTER TABLE ntest_orders DROP INDEX nsl_orders_key2; ALTER TABLE ntest_orders ADD INDEX nsl_orders_key2 `10_28` TYPE minmax GRANULARITY 1024; OPTIMIZE TABLE ntest_orders FINAL;",
    "Affected Elements": "INDEX, SELECT, WHERE, GROUP BY, OPTIMIZE",
    "Root Cause Analysis": "The instability in the results appears to stem from the interaction between the indexing on the date column and the physical data organization within the ClickHouse MergeTree engine, particularly when the table size grows large."
}