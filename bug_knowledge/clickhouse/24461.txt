{
    "sql": "SELECT id, uniqExactState(s) FROM (SELECT number % 10 as id, uniqState(number) as s FROM (SELECT number FROM system.numbers LIMIT 1000) GROUP BY number) GROUP BY id; DROP TABLE IF EXISTS uniq_crash_table; CREATE TABLE uniq_crash_table (id Int64, hits AggregateFunction(uniq, UInt64)) ENGINE = AggregatingMergeTree PARTITION BY id ORDER BY id AS SELECT number % 10 AS id, uniqState(number) AS hits FROM (SELECT number FROM system.numbers LIMIT 1000) GROUP BY number; SELECT id, uniqExactState(hits) FROM uniq_crash_table GROUP BY id;",
    "Affected Elements": "uniqState, uniqExactState, AggregateFunction, GROUP BY, SELECT",
    "Root Cause Analysis": "The crash is likely due to excessive memory allocation when chaining different uniq*State functions, leading to memory exhaustion and server termination."
}