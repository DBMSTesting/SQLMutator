{
    "sql": "CREATE TABLE A (ts DateTime, id String, id_b String) ENGINE=MergeTree PARTITION BY toStartOfHour(ts) ORDER BY (ts, id); CREATE TABLE B (ts DateTime, id String, id_c String) ENGINE=MergeTree PARTITION BY toStartOfHour(ts) ORDER BY (ts, id); INSERT INTO A SELECT toDateTime(number), 'id' || toString(number % 1000), 'id' || toString(number % 1000) FROM system.numbers LIMIT 100000; INSERT INTO B SELECT toDateTime(0), 'id' || toString(number % 1000), 'id' || toString(number % 1000) FROM system.numbers LIMIT 1000; SET enable_debug_queries = 1; ANALYZE SELECT ts AS `--a.ts`, id AS `--a.id`, id_b AS `--a.id_b`, b.ts AS `--b.ts`, b.id AS `--b.id`, id_c AS `--b.id_c` FROM (SELECT ts, id, id_b FROM A) AS a ALL LEFT JOIN B AS b ON `--b.id` = `--a.id_b` WHERE `--a.ts` <= toDateTime('1970-01-01 03:00:00');",
    "Affected Elements": "--b.id, --a.id_b, --a.ts",
    "Root Cause Analysis": "The use of indirect aliases (e.g., `--a.ts`) prevents query optimization and push-down operations, leading to performance issues."
}