{
    "sql": "select toFloat32(a.cnt/b.cnt) as rate, 'all' as algo, toInt32(-1) as pos, a.scene as scene, '20200715' as dt from (select count(distinct recom_token) as cnt, scene from recom_stats_dws.load_clk_log_day where dt='20200715' and label = 1 and algo != 'others' group by scene) AS a INNER JOIN (select count(distinct recom_token) as cnt, scene from recom_stats_dws.load_clk_log_day where dt='20200715' and algo != 'others' group by scene) AS b on a.scene = b.scene union all select toFloat32(aa.cnt/bb.cnt), 'algo_sum', toInt32(-1), aa.scene, '20200715' from (select count(distinct recom_token) as cnt, scene from recom_stats_dws.load_clk_log_day where dt='20200715' and label = 1 and algo != 'others' and algo != 'old_rule' group by scene) AS aa INNER JOIN (select count(distinct recom_token) as cnt, scene from recom_stats_dws.load_clk_log_day where dt='20200715' and algo != 'others' and algo != 'old_rule' group by scene) AS bb on aa.scene = bb.scene;",
    "Affected Elements": "toFloat32, union all",
    "Root Cause Analysis": "The query fails due to a mismatch in the number of columns returned by the two SELECT statements in the UNION ALL operation, likely caused by incorrect handling of types or missing conversions."
}