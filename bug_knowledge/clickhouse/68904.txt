{
    "sql": "CREATE TABLE mydb.rawtable (Id UInt64 CODEC(Delta(8), ZSTD(1)), Attributes Map(LowCardinality(String), String) CODEC(ZSTD(1)), MetricName LowCardinality(String) CODEC(ZSTD(1)), TimeUnix DateTime CODEC(Delta(8), ZSTD(1))) ENGINE = MergeTree PARTITION BY toYYYYMMDD(TimeUnix) ORDER BY (MetricName, Attributes, toUnixTimestamp(TimeUnix)); CREATE MATERIALIZED VIEW mydb.raw_to_attributes_mv TO mydb.attributes (Id UInt64, MetricName LowCardinality(String), TimeUnix DateTime, AttributeKeys Array(LowCardinality(String)), AttributeValues Array(String)) AS SELECT Id, MetricName, toStartOfDay(TimeUnix) AS TimeUnix, mapKeys(Attributes) AS AttributeKeys, mapValues(Attributes) AS AttributeValues FROM mydb.rawtable; CREATE TABLE mydb.attributes (Id UInt64 CODEC(Delta(8), ZSTD(1)), MetricName LowCardinality(String) CODEC(ZSTD(1)), TimeUnix DateTime CODEC(Delta(8), ZSTD(1)), AttributeKeys Array(LowCardinality(String)) CODEC(ZSTD(1)), AttributeValues Array(String) CODEC(ZSTD(1))) ENGINE = ReplacingMergeTree PARTITION BY toYYYYMMDD(TimeUnix) ORDER BY (MetricName, Id, TimeUnix); INSERT INTO mydb.rawtable VALUES (1, {'key1': 'value1', 'key2': 'value2'}, 'm1', now());",
    "Affected Elements": "mapKeys(Attributes), mapValues(Attributes)",
    "Root Cause Analysis": "The error is triggered due to the materialized view not being able to find the computed keys from the Attributes map column during the insert operation, indicating a compatibility issue with the latest ClickHouse version."
}