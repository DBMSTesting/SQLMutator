{
    "sql": "CREATE TABLE bug_test.post_comments_data ( `time` UInt64 CODEC(DoubleDelta), `groupId` String, `id` UInt64 CODEC(DoubleDelta), `source` LowCardinality(String), `message` String DEFAULT '', INDEX id_idx id TYPE minmax GRANULARITY 1, INDEX message_idx message TYPE tokenbf_v1(512, 3, 10) GRANULARITY 1 ) ENGINE = MergeTree PARTITION BY (groupId, toYYYYMM(toDate(time / 1000000000))) ORDER BY time SETTINGS index_granularity = 8192, min_bytes_for_wide_part = 104857600; CREATE TABLE bug_test.post_comments ( `time` UInt64 CODEC(DoubleDelta), `groupId` String, `id` UInt64 CODEC(DoubleDelta), `source` LowCardinality(String), `message` String DEFAULT '' ) ENGINE = Distributed('c_replicas', 'bug_test', 'post_comments_data', rand()); SELECT count() FROM bug_test.post_comments WHERE hasToken(message, 'error'); ALTER TABLE bug_test.post_comments_data MODIFY SETTING min_bytes_for_wide_part = 0; OPTIMIZE TABLE bug_test.post_comments_data;",
    "Affected Elements": "CREATE TABLE, SELECT, ALTER TABLE, OPTIMIZE TABLE",
    "Root Cause Analysis": "Data corruption occurs during insertion due to improper handling of marks file sizes related to the tokenbf_v1 index, leading to inconsistent mark sizes that trigger exceptions upon querying."
}