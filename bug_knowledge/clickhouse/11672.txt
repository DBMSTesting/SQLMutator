{
    "sql": "CREATE TABLE foo (server_date Date, server_time Datetime, dimension_1 String) ENGINE = MergeTree() PARTITION BY toYYYYMM(server_date) ORDER BY (server_date); CREATE TABLE bar (server_date Date, dimension_1 String) ENGINE = MergeTree() PARTITION BY toYYYYMM(server_date) ORDER BY (server_date); INSERT INTO foo VALUES ('2020-01-01', '2020-01-01 12:00:00', 'test1'), ('2020-01-01', '2020-01-01 13:00:00', 'test2'); INSERT INTO bar VALUES ('2020-01-01', 'test2'), ('2020-01-01', 'test3'); SELECT count() FROM foo ANY INNER JOIN bar USING (dimension_1) WHERE (foo.server_date <= '2020-11-07') AND (toDate(foo.server_time) <= '2020-11-07');",
    "Affected Elements": "JOIN, WHERE, toDate function",
    "Root Cause Analysis": "The error arises from attempting to apply the toDate function on a Datetime type in a context where it conflicts with other data types in the JOIN condition, particularly after the upgrade which may have changed type handling."
}