{
    "sql": "CREATE TABLE events.sessions (reporting_date Date, site_id UInt16, pageviews.pageview_reporting_date Array(Date), pageviews.pageview_unique Array(UInt64), pvcount UInt16 ALIAS length(pageviews.pageview_reporting_date)) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/events/sessions', '{replica}') PARTITION BY toMonday(reporting_date) ORDER BY (reporting_date, site_id) SETTINGS index_granularity = 8192; SELECT count(), min(length(pageviews.pageview_reporting_date)) AS minExpr, min(pvcount) AS minAlias, max(length(pageviews.pageview_reporting_date)) AS maxExpr, max(pvcount) AS maxAlias, site_id FROM events.sessions WHERE site_id = 7367 GROUP BY site_id;",
    "Affected Elements": "ALIAS fields, aggregate functions, length() function",
    "Root Cause Analysis": "The ALIAS mechanism does not correctly recalculate the value of the underlying expression in the context of aggregate functions, leading to discrepancies in results."
}