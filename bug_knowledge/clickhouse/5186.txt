{
    "sql": "CREATE TABLE test ( sequenceId String, id String, dateTime DateTime('UTC'), version UInt64 ) ENGINE ReplicatedReplacingMergeTree('/shard/{shard}', '{replica}', version) PARTITION BY toYYYYMM(dateTime) ORDER BY (toDate(dateTime), cityHash64(sequenceId), id) PRIMARY KEY (toDate(dateTime), cityHash64(sequenceId)) SAMPLE BY cityHash64(sequenceId); CREATE TABLE IF NOT EXISTS test_d AS test ENGINE = Distributed('test-cluster', 'default', test, sipHash64(sequenceId)); INSERT INTO test_d (sequenceId, id, dateTime, version) VALUES ('a3892197-3ad7-37d4-a1cf-2053b33fc287', 'f0d88bf6-b258-4a37-b15e-c68a7c1ec258', toDateTime('2019-01-01 00:00:00'), 1), ('a3892197-3ad7-37d4-a1cf-2053b33fc287', 'f0d88bf6-b258-4a37-b15e-c68a7c1ec258', toDateTime('2019-01-01 00:00:00'), 2); SELECT count() FROM test_d FINAL;",
    "Affected Elements": "FINAL keyword in SELECT statement",
    "Root Cause Analysis": "The error arises from the distributed table's inability to handle the FINAL query due to the presence of duplicate column definitions caused by the parallel replicas."
}