{
    "sql": "SET do_not_merge_across_partitions_select_final=1; CREATE TABLE test_block_mismatch ( a UInt32, b DateTime ) ENGINE = ReplacingMergeTree PARTITION BY toYYYYMM(b) ORDER BY (toDate(b), a); INSERT INTO test_block_mismatch VALUES (1, toDateTime('2023-01-01 12:12:12')); INSERT INTO test_block_mismatch VALUES (1, toDateTime('2023-01-01 12:12:12')); SELECT count(*) FROM test_block_mismatch FINAL; INSERT INTO test_block_mismatch VALUES (1, toDateTime('2023-02-02 12:12:12')); INSERT INTO test_block_mismatch VALUES (1, toDateTime('2023-02-02 12:12:12')); SELECT count(*) FROM test_block_mismatch FINAL; INSERT INTO test_block_mismatch VALUES (2, toDateTime('2023-01-01 12:12:12')); INSERT INTO test_block_mismatch VALUES (2, toDateTime('2023-01-01 12:12:12')); SELECT count(*) FROM test_block_mismatch FINAL;",
    "Affected Elements": "SET, CREATE TABLE, INSERT INTO, SELECT",
    "Root Cause Analysis": "The use of derived functions in the primary key/order by clause leads to inconsistent column structures during query execution, causing a mismatch."
}