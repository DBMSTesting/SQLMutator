{
    "sql": "CREATE TABLE upp_tag_str_bitmap_1_sg_d_all ON CLUSTER cluster_mkplalgo_regss_account_udp_online (data_version UInt64, tag_id UInt64, ref_id UInt64, tag_value String, shard_id UInt32, mapping_id_bitmap AggregateFunction(groupBitmap, UInt32), create_time DateTime DEFAULT now()) ENGINE = Distributed('cluster_mkplalgo_regss_account_udp_online', 'regss_account_udp_udtag', 'upp_tag_str_bitmap_1_sg_d', cityHash64(concat(toString(tag_value), toString(ref_id), toString(shard_id)))); SELECT argMax(mapping_id_bitmap, create_time) AS mapping_id_bitmap FROM upp_tag_str_bitmap_1_sg_d_all WHERE data_version = 2023112101 AND tag_id = 19 AND ref_id = 0 AND tag_value IN ('Deleted', 'Banned', 'Frozen') AND shard_id = 36 GROUP BY (data_version, tag_id, ref_id, tag_value, shard_id) SETTINGS optimize_skip_unused_shards = 1;",
    "Affected Elements": "optimize_skip_unused_shards, IN clause with String literals",
    "Root Cause Analysis": "The `optimize_skip_unused_shards` setting does not properly handle complex sharding key expressions, leading to a TYPE_MISMATCH exception when processing string values."
}