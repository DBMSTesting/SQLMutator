{
    "sql": "DROP TABLE IF EXISTS test_partition_filtering; CREATE TABLE test_partition_filtering (timestamp DateTime, zoneId UInt64) ENGINE = MergeTree() PARTITION BY toYYYYMMDD(timestamp) ORDER BY (zoneId, timestamp); INSERT INTO test_partition_filtering SELECT toUInt64(now())-1000*number/1000 as timestamp, number/1000 as zone FROM numbers(1000000); OPTIMIZE TABLE test_partition_filtering final; SELECT count() FROM test_partition_filtering WHERE toDate(toStartOfDay(timestamp)) = today() and zoneId=42; SELECT count() FROM test_partition_filtering WHERE toDate(timestamp) = today() AND zoneId = 42;",
    "Affected Elements": "toDate(toStartOfDay(timestamp)), toDate(timestamp)",
    "Root Cause Analysis": "The partition pruning behavior differs due to the transformation applied to the timestamp in the first query, which optimizes the condition differently compared to the second query."
}