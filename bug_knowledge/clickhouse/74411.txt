{
    "sql": "DROP DATABASE IF EXISTS db; CREATE DATABASE db; USE db; CREATE TABLE db.test_table (s String) ENGINE = MergeTree ORDER BY s; INSERT INTO db.test_table VALUES ('foo'), ('bar'); DROP USER IF EXISTS user1, user2; CREATE USER user1, user2; GRANT SELECT ON db.* TO user1; CREATE VIEW db.test_view (s String) DEFINER = user1 SQL SECURITY DEFINER AS SELECT * FROM db.test_table; GRANT SELECT ON db.test_view TO user2; clickhouse-client --host= --port=9440 --send_logs_level=error --allow_experimental_analyzer=1 --enable_parallel_replicas=0 --secure --user user2 --query \"select count() from db.test_view\"; clickhouse-client --host= --port=9440 --send_logs_level=error --allow_experimental_analyzer=1 --enable_parallel_replicas=1 --secure --user user2 --query \"select count() from db.test_view\";",
    "Affected Elements": "CREATE VIEW, GRANT SELECT, SQL SECURITY DEFINED BY",
    "Root Cause Analysis": "The SQL security model is not functioning as intended under parallel replica settings, allowing unauthorized access when it should be restricted."
}