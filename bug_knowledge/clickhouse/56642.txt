{
    "sql": "CREATE TABLE landing (time DateTime, number Int64) Engine=ReplicatedReplacingMergeTree('/clickhouse/' || currentDatabase() || '/landing/{shard}/', '{replica}') PARTITION BY toYYYYMMDD(time) ORDER BY time; CREATE MATERIALIZED VIEW mv ENGINE = ReplicatedSummingMergeTree('/clickhouse/' || currentDatabase() || '/mv/{shard}/', '{replica}') PARTITION BY toYYYYMMDD(hour) ORDER BY hour AS SELECT toStartOfHour(time) AS hour, sum(number) AS sum_amount FROM landing GROUP BY hour; INSERT INTO landing VALUES ('2022-09-01 12:23:34', 42), ('2023-09-01 12:23:34', 42);",
    "Affected Elements": "INSERT statement, Materialized View definition, deduplication settings",
    "Root Cause Analysis": "The materialized view does not correctly handle deduplication due to the configuration settings related to delayed insert streams, leading to discarded data."
}